var root,factory;root=this,factory=function(){var undefined,window=this,document=window.document;if(!document)throw new Error("CrossUI requires a window with a document");var xui=window.xui=function(nodes,flag){return xui.Dom.pack(nodes,flag)};return xui.window=window,xui.Class=function(key,pkey,obj){var _Static,parent0,_this,i,t,_t,_parent=[],self=xui.Class,w=xui.window,env=self._fun,reg=self._reg,_c=self._all,_funadj=function(str){return(str+"").replace(/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,(function(a){return")"!=a.charAt(0)?"":a}))};if(obj=obj||{},!self._ignoreNSCache&&(t=xui.get(w,key.split(".")))&&"function"==typeof t&&t.$xuiclass$)return self._last=t;for((t=xui.get(w,["xui","$cache","SC"]))&&delete t[key],pkey=pkey?"string"==typeof pkey?[pkey]:pkey:[],i=0;t=pkey[i];i++)if(!(_parent[i]=xui.get(w,t.split("."))||xui.get(window,t.split("."))||xui&&xui.SC&&xui.SC(t)))throw new Error("errNoParent--"+t);if(obj.Required)for("string"==typeof obj.Required&&(obj.Required=[obj.Required]),i=0;t=obj.Required[i];i++)if(!(xui.get(w,t.split("."))||xui&&xui.SC&&xui.SC(t)))throw new Error("errNoRequiredClass--"+t);parent0=_parent[0];var $Start=obj.$Start||parent0&&parent0.$Start;for(i in xui.tryF($Start,[],obj),t={},_Static=obj.Static||{})reg[i]&&(t[i]=1);for(i in t)delete _Static[i];_Static.Before=obj.Before||parent0&&parent0.Before,_Static.After=obj.After||parent0&&parent0.After,_Static.$Start=$Start,_Static.$End=obj.$End||parent0&&parent0.$End,_Static.__gc=obj.__gc||_Static.__gc||parent0&&parent0.__gc||function(){xui.Class.__gc(this.$key)};var cf=function(){xui.Class.$instanceCreated&&xui.Class.$instanceCreated(this),"function"==typeof this.initialize&&this.initialize()};if("function"==typeof obj.Constructor)(_this=env(obj.Constructor,"Constructor",key,parent0||cf,"constructor")).Constructor=_funadj(obj.Constructor);else if(parent0){var f=cf,str=parent0.Constructor;str&&(f=new Function(str.slice(str.indexOf("(")+1,str.indexOf(")")).split(","),str.slice(str.indexOf("{")+1,str.lastIndexOf("}")))),(_this=env(f,"Constructor",key,parent0.upper,"constructor")).Constructor=_funadj(str)}else _this=cf;for(_t=xui.fun(),i=_parent.length-1;t=_parent[i--];)xui.merge(_t,t),xui.merge(_t.prototype,t.prototype);if(_this.KEY=_this.$key=_this.prototype.KEY=_this.prototype.$key=key,self._wrap(_this,_Static,0,_t,"static"),(t=obj.Instance)&&self._wrap(_this.prototype,t,1,_t.prototype,"instance"),self._inherit(_this,_t),self._inherit(_this.prototype,_t.prototype),_t=null,!1===xui.tryF(_this.Before,arguments,_this))return!1;for(i=0;t=_parent[i];i++){for(var b,j=0,k=(t=t.$children||(t.$children=[])).length;j<k;j++)if(t[k]==key){b=!0;break}b||(t[t.length]=key)}if(_this.$xui$=_this.$xuiclass$=1,_this.$children=[],_this.$parent=_parent,_this.prototype.constructor=_this,_this.prototype.$xui$=1,_this[key]=_this.prototype[key]=!0,_t=t=xui.get(w,key.split(".")),xui.set(w,key.split("."),_this),"[object Object]"==Object.prototype.toString.call(_t))for(i in _t)_this[i]=_t[i];return xui.tryF(_this.After,[],_this),xui.tryF(obj.Initialize,[],_this),xui.tryF(_this.$End,[],_this),xui.breakO([obj.Static,obj.Instance,obj],2),key in _c||(_c[key]=_c.length,_c.push(key)),self._last=_this},xui.Namespace=function(key){var a=key.split("."),w=xui.window;return xui.get(w,a)||(xui.Namespace._all[a[0]]=1)&&xui.set(w,a,{})},xui.Namespace._all={},xui.merge=function(target,source,type,force){var i,f;switch("function"==typeof type&&(f=type,type="fun"),type){case"fun":for(i in source)(force||source.hasOwnProperty(i))&&!0===f(source[i],i)&&(target[i]=source[i]);break;case"all":for(i in source)(force||source.hasOwnProperty(i))&&(target[i]=source[i]);break;case"with":for(i in source)(force||source.hasOwnProperty(i))&&target.hasOwnProperty(i)&&(target[i]=source[i]);break;default:for(i in source)!force&&!source.hasOwnProperty(i)||target.hasOwnProperty(i)||(target[i]=source[i])}return target},new function(){for(var tag,lastTime=0,vendors=["ms","moz","webkit","o"],w=window,i=0,l=vendors.length;i<l&&!w.requestAnimationFrame&&(tag=vendors[i++]);)w.requestAnimationFrame=w[tag+"RequestAnimationFrame"],w.cancelAnimationFrame=w[tag+"CancelAnimationFrame"]||w[tag+"CancelRequestAnimationFrame"];w.requestAnimationFrame=w.requestAnimationFrame||function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,1e3/60-(currTime-lastTime)),id=setTimeout((function(){callback(currTime+timeToCall)}),timeToCall);return lastTime=currTime+timeToCall,id},w.cancelAnimationFrame=w.cancelAnimationFrame||function(id){clearTimeout(id)},w.requestIdleCallback=w.requestIdleCallback||function(cb){return setTimeout((function(){var start=Date.now();cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})}),1)},w.cancelIdleCallback=w.cancelIdleCallback||function(id){clearTimeout(id)}},new function(){var _to=Object.prototype.toString;xui.merge(xui,{stamp:function(){return+new Date},rand:function(head,tail){return(head||"")+parseInt(xui.stamp()*Math.random(),10).toString(36)+(tail||"")},setTimeout:function(callback,delay){return!1===delay||(delay||0)>1e3/60?-1*setTimeout(callback,delay||0):requestAnimationFrame(callback)},clearTimeout:function(id){id>=0?cancelAnimationFrame(id):clearTimeout(Math.abs(id))},fun:function(){return function(){}},exec:function(script,id,closure){var n,d=document,h=d.getElementsByTagName("head")[0]||d.documentElement,s=d.createElement("script");return closure&&(script="!function(){"+script+"}(xui.window)"),s.type="text/javascript",id&&((n=d.getElementById(id))&&n.parentNode==h&&h.removeChild(n),s.id=id),xui.browser.ie?s.text=script:s.appendChild(d.createTextNode(script)),h.appendChild(s),s.disalbed=!0,s.disabled=!1,id||h.removeChild(s),s},_s2a:function(s){return(s+"").replace(/^\[/,"").replace(/\]$/,"").split(/\s*[\[\]\.]\s*[\[\]\.]?\s*/)},get:function(hash,path,deep){if(!path)return hash;if(!xui.isSet(hash))return undefined;if(deep&&(path=xui._s2a(path)),"string"==typeof path)return hash[path];for(var t,i=0,l=path.length;i<l;)if((t=path[i++]+"")&&(!hash||(hash=t!=(t=t.replace("()",""))?"function"==typeof hash[t]&&0!==t.indexOf("set")?hash[t]():undefined:hash[t])===undefined))return;return hash},set:function(hash,path,value,deep){if(hash){if(deep&&(path=xui._s2a(path)),"string"!=typeof path){for(var v,m,i=0,last=path.length-1;i<last;)hash=!hash[v=path[i++]]||"object"!=(m=typeof hash[v])&&"function"!=m?hash[v]={}:hash[v];path=path[last]}if(path!=(path=(path+"").replace("()",""))){if("function"==typeof hash[path])return hash[path](value),value}else{if(value!==undefined)return hash[path]=value;hash.hasOwnProperty&&hash.hasOwnProperty(path)?delete hash[path]:hash[path]=undefined}}},clonePath:function(obj,path){var i,l1,p2=[],l2=path.length;return xui.clone(obj,(function(v,k,deep,h){if(i=0,p2[deep-1]=k,p2.splice(deep),(l1=p2.length)>l2)return h[k]=v,!1;for(;i<=l1-1;){if(path[i]!==p2[i])return h[k]=v,!1;i++}}))},tryF:function(fun,args,scope,df){return fun&&"function"==typeof fun?fun.apply(scope||{},args||[]):df},asyRun:function(fun,defer,args,scope){return xui.setTimeout("string"==typeof fun?function(){xui.exec(fun)}:function(){fun.apply(scope,args||[]),fun=args=null},defer)},idleRun:function(fun,args,scope){return window.requestIdleCallback("string"==typeof fun?function(){xui.exec(fun)}:function(){fun.apply(scope,args||[]),fun=args=null})},asyHTML:function(content,callback,defer,size){var div=document.createElement("div"),fragment=document.createDocumentFragment(),f=function(){for(var i=size||10;--i&&div.firstChild;)fragment.appendChild(div.firstChild);div.firstChild?xui.setTimeout(f,defer):callback(fragment)};div.innerHTML=content,f()},isEmpty:function(hash){if(xui.isSet(hash)){if(!0===hash)return!1;if(xui.isNumb(hash))return!1;if(xui.isHash(hash)){for(var i in hash)if(Object.prototype.hasOwnProperty.call(hash,i))return!1;return!0}return!!(xui.isArr(hash)||xui.isStr(hash)||xui.isArguments(hash))&&0===hash.length}return!0},resetRun:function(key,fun,defer,args,scope){var task,me=xui.resetRun,cache=me.$cache||(me.get=me.exists=function(k){return this.$cache[k]})&&(me.run=function(k,c){(c=this.$cache[k])&&(xui.clearTimeout(c.id),c.task(),delete this.$cache[k])})&&(me.cancel=function(k){xui.resetRun(k)})&&(me.$cache={});cache[key]&&xui.clearTimeout(cache[key].id),"function"==typeof fun?(task=function(){delete cache[key],fun.apply(scope||null,args||[])},cache[key]={id:xui.setTimeout(task,defer),task:task}):delete cache[key]},observableRun:function(tasks,onEnd,threadid,busyMsg){xui.Thread.observableRun(tasks,onEnd,threadid,busyMsg)},breakO:function(target,depth,_layer){var i,n=depth||1,l=1+(_layer||0),self=xui.breakO,_t="___gc_";if(target&&("object"==typeof target||"function"==typeof target)&&target!==window&&target!==document&&1!==target.nodeType){try{if(target.hasOwnProperty(_t))return;target[_t]=null}catch(e){return}try{for(i in target)if(target.hasOwnProperty(i)&&target[i]){"object"!=typeof target[i]&&"function"!=typeof target[i]||l<n&&self(target[i],n,l);try{target[i]=null}catch(e$0){}}}catch(e$1){return}target.length&&(target.length=0),delete target[_t]}},each:function(hash,fun,scope){for(var i in scope=scope||hash,hash)if(!1===fun.call(scope,hash[i],i,hash))break;return hash},compareVar:function(x,y,MAXL,MAXS){return x===y||(xui.isObj(x)||xui.isObj(y)?xui.isDate(x)&&xui.isDate(y)||xui.isReg(x)&&xui.isReg(y)?x+""==y+"":!!(xui.isHash(x)&&xui.isHash(y)||xui.isArr(x)&&xui.isArr(y)||xui.isArguments(x)&&xui.isArguments(y))&&(x=xui.serialize(x,0,0,MAXL||5,MAXS||300),y=xui.serialize(y,0,0,MAXL||5,MAXS||300),-1==x.indexOf(xui.$_outofmilimted)&&-1==y.indexOf(xui.$_outofmilimted)&&x===y):void 0)},compareNumber:function(a,b,digits){return xui.toFixedNumber(a,digits)===xui.toFixedNumber(b,digits)},toFixedNumber:function(number,digits){xui.isSet(digits)||(digits=2);var v,t,start,end,m=Math.abs(number),s=""+Math.round(m*Math.pow(10,digits));if(/\D/.test(s))v=""+m;else{for(;s.length<1+digits;)s="0"+s;start=s.substring(0,t=s.length-digits),(end=s.substring(t))&&(end="."+end),v=start+end}return parseFloat((number<0?"-":"")+v)},toNumeric:function(value,precision,groupingSeparator,decimalSeparator){return xui.isNumb(value)||(value=parseFloat((value+"").replace(/\s*(e\+|[^0-9])/g,(function(a,b,c){return"e+"==b||"E+"==b||0==c&&"-"==b?b:b==decimalSeparator?".":""})))||0),xui.isSet(precision)&&precision>=0&&(value=xui.toFixedNumber(value,precision)),value},formatNumeric:function(value,precision,groupingSeparator,decimalSeparator,forceFillZero,trimTailZero){return xui.isSet(precision)&&(precision=parseInt(precision,10)),precision=precision||0===precision?precision:0,groupingSeparator=xui.isSet(groupingSeparator)?groupingSeparator:",",decimalSeparator=decimalSeparator||".",-1==(value=""+parseFloat(value)).indexOf("e")&&(value=(value=xui.toFixedNumber(value,precision)+"").split("."),!1!==forceFillZero&&(value[1]?value[1].length:0)<precision&&(value[1]=(value[1]||"")+xui.str.repeat("0",precision-(value[1]?value[1].length:0))),value[0]=value[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1"+groupingSeparator).split("").reverse().join(""),value=value.join(decimalSeparator)),trimTailZero&&-1!=value.indexOf(decimalSeparator)?value.replace(new RegExp("["+decimalSeparator+"]?0+$"),""):value},replace:function(str,reg,replace,ignore_case){if(!str)return"";var i,len,_t,m,n,flag,a1=[],a2=[],me=arguments.callee,reg1=me.reg1||(me.reg1=/\\./g),reg2=me.reg2||(me.reg2=/\(/g),reg3=me.reg3||(me.reg3=/\$\d/),reg4=me.reg4||(me.reg4=/^\$\d+$/),reg5=me.reg5||(me.reg5=/'/),reg6=me.reg6||(me.reg6=/\\./g),reg11=me.reg11||(me.reg11=/(['"])\1\+(.*)\+\1\1$/);return xui.isArr(reg)?ignore_case=replace:reg=[reg,replace],xui.isArr(reg[0])||(reg=[reg]),xui.arr.each(reg,(function(o){if(m="string"==typeof o[0]?o[0]:o[0].source,n=o[1]||"",len=(m.replace(reg1,"").match(reg2)||"").length,"function"!=typeof n&&reg3.test(n))if(reg4.test(n))(_t=parseInt(n.slice(1),10))<=len&&(n=_t);else{for(flag=reg5.test(n.replace(reg6,""))?'"':"'",i=len;i+1;)n=n.split("$"+i).join(flag+"+a[o+"+i--+"]+"+flag);n=new Function("a,o","return"+flag+n.replace(reg11,"$1")+flag)}a1.push(m||"^$"),a2.push([n,len,typeof n])})),str.replace(new RegExp("("+a1.join(")|(")+")",ignore_case?"gim":"gm"),(function(){var p,i=1,j=0,args=arguments;if(!args[0])return"";for(;p=a2[j++];)if(args[i])switch(p[2]){case"function":return p[0](args,i,j-1);case"number":return args[p[0]+i];default:return p[0]}else i+=p[1]+1}))},copy:function(hash,filter){return xui.clone(hash,filter,1)},clone:function(hash,filter,deep,_layer){if(_layer=_layer||0,hash&&(xui.isHash(hash)||xui.isArr(hash))){if(xui.isObj(hash)){var v,l,me=xui.clone,isArr=xui.isArr(hash),h=isArr?[]:{},i=0;if(xui.isSet(deep)){if(deep<=0)return hash}else deep=100;if(isArr)for(l=hash.length;i<l;i++)"function"==typeof filter&&!1===filter.call(hash,hash[i],i,_layer+1,h)||(h[h.length]=(v=hash[i])&&deep&&(xui.isHash(v)||xui.isArr(v))?me(v,filter,deep-1,_layer+1):v);else for(i in hash)(!0===filter?"_"!=i.charAt(0):!1===filter?"_"!=i.charAt(0)&&"$"!=i.charAt(0):"function"!=typeof filter||!1!==filter.call(hash,hash[i],i,_layer+1,h))&&(h[i]=(v=hash[i])&&deep&&(xui.isHash(v)||xui.isArr(v))?me(v,filter,deep-1,_layer+1):v);return h}return hash}return hash},filter:function(obj,filter,force){if(!force&&obj&&xui.isArr(obj)){var l,a=[];for(i=0,l=obj.length;i<l;i++)a[a.length]=obj[i];for(obj.length=0,i=0,l=a.length;i<l;i++)"function"==typeof filter&&!1===filter.call(a,a[i],i)||(obj[obj.length]=a[i])}else{var i,bak={};for(i in obj)(!0===filter?"_"==i.charAt(0):!1===filter?"_"==i.charAt(0)||"$"==i.charAt(0):"function"==typeof filter&&!1===filter.call(obj,obj[i],i))&&(bak[i]=1);for(i in bak)delete obj[i]}return obj},toArr:function(value,flag){if(!value)return[];var arr=[];if("boolean"==typeof flag)for(var i in value)arr[arr.length]=flag?i:value[i];else if(xui.isHash(value))for(var i in value)arr.push({key:i,value:value[i]});else if("string"==typeof value)arr=value.split(flag||",");else{i=0;for(var l=value.length;i<l;++i)arr[i]=value[i]}return arr},toUTF8:function(str){return str.replace(/[^\x00-\xff]/g,(function(a,b){return"\\u"+((b=a.charCodeAt())<16?"000":b<256?"00":b<4096?"0":"")+b.toString(16)}))},fromUTF8:function(str){return str.replace(/\\u([0-9a-f]{3})([0-9a-f])/g,(function(a,b,c){return String.fromCharCode(16*parseInt(b,16)+parseInt(c,16))}))},urlEncode:function(hash){var i,c,o,a=[],b=[];for(i in hash)a[c=a.length]=b[b.length]=encodeURIComponent(i),((o=hash[i])||0===o)&&(a[c]+="="+encodeURIComponent("string"==typeof o?o:xui.serialize(o)));return(a=xui.arr.stableSort(a,(function(x,y,i,j){return b[i]>b[j]?1:b[i]==b[j]?0:-1}))).join("&")},urlDecode:function(str,key){if(!str)return key?"":{};for(var arr,hash={},a=str.split("&"),i=0,l=a.length;i<l;i++){arr=a[i].split("=");try{hash[decodeURIComponent(arr[0])]=decodeURIComponent(arr[1]||"")}catch(e){hash[arr[0]]=arr[1]||""}}return key?hash[key]:hash},getUrlParams:function(url){var hash=(url||location.href).replace(/^[^#]*[#!]+|^[^#]*$/,"");return-1!=hash.indexOf("?")&&(hash=hash.split("?")[1]),-1!=hash.indexOf("=")?xui.urlDecode(hash):{}},getUrlPath:function(url){var hash=(url||location.href).replace(/^[^#]*[#!]+|^[^#]*$/,"");return hash=-1!=hash.indexOf("?")?hash.split("?")[0]:-1==hash.indexOf("=")?hash:"","/"+decodeURIComponent(hash).replace(/^\//,"").replace(/\/$/,"")},preLoadImage:function(src,onSuccess,onFail){if(xui.isArr(src)){for(var i=0,l=src.length;i<l;i++)xui.preLoadImage(src[i],onSuccess,onFail);return l}var img=document.createElement("img");return img.style.cssText="position:absolute;left:-999px;top:-999px",img.width=img.height=2,img.onload=function(){"function"==typeof onSuccess&&onSuccess.call(this),this.onload=this.onerror=null,document.body.removeChild(this)},img.onerror=function(){"function"==typeof onFail&&onFail.call(this),this.onload=this.onerror=null,document.body.removeChild(this)},document.body.appendChild(img),img.src=src,1},isDefined:function(target){return target!==undefined},isNull:function(target){return null===target},isSet:function(target){return target!==undefined&&null!==target&&target!==NaN},isObj:function(target){return!!target&&("object"==typeof target||"function"==typeof target)},isHash:function(target){return!!target&&"[object Object]"==_to.call(target)&&target.constructor&&/^\s*function\s+Object\(\s*\)/.test(target.constructor.toString())&&!Object.prototype.hasOwnProperty.call(target,"callee")},isBool:function(target){return"boolean"==typeof target},isNumb:function(target){return"number"==typeof target&&isFinite(target)},isFinite:function(target){return(target||0===target)&&isFinite(target)&&!isNaN(parseFloat(target))},isDate:function(target){return"[object Date]"===_to.call(target)&&isFinite(+target)},isFun:function(target){return"[object Function]"===_to.call(target)},isAsyncFun:function(target){return"[object AsyncFunction]"===_to.call(target)},isArr:function(target){return"[object Array]"===_to.call(target)},isReg:function(target){return"[object RegExp]"===_to.call(target)},isStr:function(target){return"[object String]"===_to.call(target)},isArguments:function(target){return target&&("[object Arguments]"===_to.call(target)||Object.prototype.hasOwnProperty.call(target,"callee"))},isEvent:function(target){return target&&(/^(\[object (Keyboard|Mouse|Focus|Wheel|Composition|Storage)Event\])|(\[object Event\])$/.test(_to.call(target))||xui.isHash(target)&&!(!target.$xuievent&&!target.$xuieventpara))},isElem:function(target){return!(!target||1!==target.nodeType)},isNaN:function(target){return"number"==typeof target&&target!=+target},str:{startWith:function(str,sStr){return 0===str.indexOf(sStr)},endWith:function(str,eStr){var l=str.length-eStr.length;return l>=0&&str.lastIndexOf(eStr)===l},repeat:function(str,times){return new Array(times+1).join(str)},initial:function(str){return str.charAt(0).toUpperCase()+str.substring(1)},trim:function(str){return str?str.replace(/^(\s|\uFEFF|\xA0)+|(\s|\uFEFF|\xA0)+$/g,""):str},ltrim:function(str){return str?str.replace(/^(\s|\uFEFF|\xA0)+/,""):str},rtrim:function(str){return str?str.replace(/(\s|\uFEFF|\xA0)+$/,""):str},toDom:function(str){var p=xui.$getGhostDiv(),r=[];p.innerHTML=str;for(var i=0,t=p.childNodes,l=t.length;i<l;i++)r[r.length]=t[i];return p=null,xui(r)}},arr:{fastSortObject:function(arr,getKey){if(!arr||arr.length<2)return arr;for(var o,s,c,t,ll=arr.length,zero=[],len=(ll+"").length,p=Object.prototype,i=0;i<len;i++)zero[i]=new Array(len-i).join("0");for(var j=0;j<ll;j++)s=j+"","object"==typeof(c=arr[j])&&(c._xui_$s$=(xui.isSet(t=getKey.call(c,j))?t:"")+zero[s.length-1]+s);try{o=p.toString,p.toString=function(){return this.hasOwnProperty("_xui_$s$")?this._xui_$s$:o.call(this)},arr.sort()}finally{for(p.toString=o,j=0;j<ll;j++)"object"==typeof arr[j]&&delete arr[j]._xui_$s$}return arr},stableSort:function(arr,sortby){if(arr&&arr.length>1){for(var i=0,l=arr.length,a=[],b=[];i<l;i++)b[i]=arr[a[i]=i];for(xui.isFun(sortby)?a.sort((function(x,y){return sortby.call(arr,arr[x],arr[y],x,y)||(x>y?1:-1)})):a.sort((function(x,y){return arr[x]>arr[y]?1:arr[x]<arr[y]?-1:x>y?1:-1})),i=0;i<l;i++)arr[i]=b[a[i]];a.length=b.length=0}return arr},subIndexOf:function(arr,key,value){if(value===undefined)return-1;for(var i=0,l=arr.length;i<l;i++)if(arr[i]&&arr[i][key]===value)return i;return-1},removeFrom:function(arr,index,length){return arr.splice(index,length||1),arr},removeValue:function(arr,value){for(var i=arr.length-1;i>=0;i--)arr[i]===value&&arr.splice(i,1);return arr},intersection:function(a,b){for(var ai=0,bi=0,result=[];ai<a.length&&bi<b.length;)a[ai]<b[bi]?ai++:(a[ai]>b[bi]||(result.push(a[ai]),ai++),bi++);return result},insertAny:function(arr,target,index,flag){var a,l=arr.length;return flag=!xui.isArr(target)||flag,0===index?flag?arr.unshift(target):arr.unshift.apply(arr,target):((!index||index<0||index>l)&&(index=l),index!=l&&(a=arr.splice(index,l-index)),flag?arr[arr.length]=target:arr.push.apply(arr,target),a&&arr.push.apply(arr,a)),index},indexOf:function(arr,value){for(var i=0,l=arr.length;i<l;i++)if(arr[i]===value)return i;return-1},each:function(arr,fun,scope,desc){var i,l,a=arr;if(!a)return a;if(!xui.isArr(a)){if(!xui.isArr(a._nodes))return a;a=a._nodes,desc===undefined&&(desc=1)}if(l=a.length,scope=scope||arr,desc)for(i=l-1;i>=0&&!1!==fun.call(scope,a[i],i,a);i--);else for(i=0;i<l&&!1!==fun.call(scope,a[i],i,a);i++);return arr},removeDuplicate:function(arr,subKey){var l=arr.length,a=arr.concat();arr.length=0;for(var i=l-1;i>=0;i--)(subKey?this.subIndexOf(a,subKey,a[i][subKey])===i:this.indexOf(a,a[i])===i)&&arr.push(a[i]);return arr.reverse()}},_scope_set:function(dataMap){window.get&&(xui._scope_bak=window.get),xui._scope_datamap=dataMap,window.get=function(key){if(key){var t,i=(key=""+key).indexOf("."),scope=-1==i?key:key.substr(0,i),name=-1==i?null:key.substr(i+1,key.length);return(t=xui._scope_datamap)&&(t=t[scope])&&(name?t[name]:t)}}},_scope_clear:function(bak){(bak=xui._scope_bak)&&(window.get=bak,delete xui._scope_bak,delete xui._scope_datamap)}})},new function(){var reg1=/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,reg2=/^\s*(\([\w,\s]*\)|\s*[\w]+\s*)\s*=>\s*([\s\S]*)\s*$/;xui.merge(xui.fun,{body:function(fun){var s=(""+fun).replace(reg1,(function(a){return")"!=a.charAt(0)?"":a})),r=reg2.exec(s);return r?"{"==r[2][0]?r[2].slice(1,-1):r[2]:s.slice(s.indexOf("{")+1,s.lastIndexOf("}"))},args:function(fun){var s=(""+fun).replace(reg1,(function(a){return")"!=a.charAt(0)?"":a})),r=reg2.exec(s);return(s=xui.str.trim(r?"("==r[1][0]?r[1].slice(1,-1):r[1]:s.slice(s.indexOf("(")+1,s.indexOf(")"))).split(/\s*,\s*/))[0]?s:[]},clone:function(fun){return new Function(xui.fun.args(fun),xui.fun.body(fun))}})},xui.merge(xui.Class,{_reg:{$key:1,$parent:1,$children:1,KEY:1,Static:1,Instance:1,Constructor:1,Initialize:1},_reg2:{nodeType:1,constructor:1,prototype:1,toString:1,valueOf:1,hasOwnProperty:1,isPrototypeOf:1,propertyIsEnumerable:1,toLocaleString:1},_all:[],_fun:function(fun,name,original,upper,type){return fun.$name$=name,fun.$original$=original,type&&(fun.$type$=type),upper&&fun!==upper&&(fun.upper=upper),fun},_other:["toString","valueOf"],_o:{},_inherit:function(target,src,instance){var i,o,r=this._reg;for(i in src)i in target||!instance&&r[i]||"$"==i.charAt(0)||(o=src[i])&&o.$xui$||(target[i]=o)},_wrap:function(target,src,instance,parent,prtt){var i,j,o,k=target.KEY,r=this._reg,r2=this._reg2,f=this._fun,oo=this._other;for(i in src)r2[i]||!instance&&r[i]||(o=src[i],target[i]="function"!=typeof o?o:f(o,i,k,"function"==typeof parent[i]&&parent[i],prtt));for(j=0;i=oo[j++];)(o=src[i])&&o==this._o[i]||(target[i]="function"!=typeof o?o:f(o,i,k,"function"==typeof parent[i]&&parent[i],prtt))},__gc:function(key){var _c=xui.Class._all;if(key){"object"==typeof key&&(key=key.KEY||"");var s,j,o,t=xui.get(window,key.split("."));if(t){if((s=xui.get(window,["xui","$cache","SC"]))&&delete s[key],t.$parent&&(t.$parent.length=0),s=t.$children){for(i=0;o=s[i];i++)(o=xui.get(window,o.split(".")))&&o.__gc&&o.__gc();s.length=0}for(i in t)if("upper"!=i&&"function"==typeof t[i])for(j in t[i])t[i].hasOwnProperty(j)&&delete t[i][j];for(i in xui.breakO(t),t=t.prototype)if("upper"!=i&&"function"==typeof t[i])for(j in t[i])t[i].hasOwnProperty(j)&&delete t[i][j];xui.breakO(t),xui.set(window,key.split("."))}_c.splice(_c[key],1),delete _c[key]}else for(var i=_c.length-1;i>0;i--)xui.Class.__gc(_c[i])},destroy:function(key){xui.Class.__gc(key)}}),xui.merge(xui,{version:2.14,$DEFAULTHREF:"javascript:;",$IEUNSELECTABLE:function(){return xui.browser.ie?' onselectstart="return false;" ':""},SERIALIZEMAXLAYER:99,SERIALIZEMAXSIZE:9999,$localeKey:"en",$localeDomId:"xlid",$dateFormat:"",$rand:"_rnd_",_rnd:function(force){return xui.debugMode||force?xui.$rand+"="+xui.rand():null},_debugPre:function(arr){return(arr=xui.toArr(arr))[0]="%c ["+arr[0]+"@xui]",xui.arr.insertAny(arr,"color:#0000ff; font-style: italic;",1),arr},_debugInfo:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.log&&console.log.apply(console,xui._debugPre(arguments))},_debugGroup:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.group?console.group.apply(console,xui._debugPre(arguments)):xui._debugInfo.apply(xui,arguments)},_debugGroupEnd:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.groupEnd?console.groupEnd():xui._debugInfo.apply(xui,arguments)},SpaceUnit:"em",$us:function(p){return xui.browser.ie6||xui.browser.ie7?p?-2:-1:"px"==(p=p?p._spaceUnit||p.properties&&p.properties.spaceUnit:"")?-2:"em"==p?2:"px"==xui.SpaceUnit?-1:"em"==xui.SpaceUnit?1:0},debugMode:!0,Locale:{},constant:{},$cache:{thread:{},SC:{},clsByURI:{},fetching:{},hookKey:{},hookKeyUp:{},snipScript:{},subscribes:{},ghostDiv:[],data:{},callback:{},functions:{},domPurgeData:{},profileMap:{},reclaimId:{},template:{},UIKeyMapEvents:{},droppable:{},unique:{}},subscribe:function(topic,subscriber,receiver,asy){if(null!==topic&&topic!==undefined&&null!==subscriber&&subscriber!==undefined&&"function"==typeof receiver){var i,c=xui.$cache.subscribes;return c[topic]=c[topic]||[],-1!=(i=xui.arr.subIndexOf(c[topic],"id",subscriber))&&xui.arr.removeFrom(c[topic],i),c[topic].push({id:subscriber,receiver:receiver,asy:!!asy})}},unsubscribe:function(topic,subscriber){var i,c=xui.$cache.subscribes;subscriber?c[topic]&&-1!=(i=xui.arr.subIndexOf(c[topic],"id",subscriber))&&xui.arr.removeFrom(c[topic],i):null===topic||topic===undefined?c={}:delete c[topic]},publish:function(topic,args,subscribers,scope){var c=xui.$cache.subscribes;if(null===topic||topic===undefined)for(var t in c)xui.arr.each(c[t],(function(o){if(!subscribers||subscribers===o.id||xui.isArr(subscribers)&&-1!=xui.arr.indexOf(subscribers,o.id)){if(!o.asy)return xui.tryF(o.receiver,args,scope,!0);xui.asyRun(o.receiver,0,args,scope)}}));else c[topic]&&xui.arr.each(c[topic],(function(o){if(!subscribers||subscribers===o.id||xui.isArr(subscribers)&&-1!=xui.arr.indexOf(subscribers,o.id)){if(!o.asy)return xui.tryF(o.receiver,args,scope,!0);xui.asyRun(o.receiver,0,args,scope)}}))},getSubscribers:function(topic){return null===topic||topic===undefined?xui.$cache.subscribes:xui.$cache.subscribes[topic]},setDateFormat:function(format){xui.$dateFormat=format},getDateFormat:function(format,t){return xui.isStr(t=format&&format.dateFormat)&&t||xui.isStr(t=format)&&t||xui.isStr(t=xui.$dateFormat)&&t||xui.isStr(t=xui.$cache.data.$DATE_FORMAT)&&t?t:"yyyy-mm-dd hh:mm:ss"},setFirstDayOfWeek:function(day){xui.$firstDayOfWeek=day},getFirstDayOfWeek:function(day,t){return xui.isNumb(t=day&&day.firstDayOfWeek)||xui.isNumb(t=day)||xui.isNumb(t=xui.$firstDayOfWeek)||xui.isNumb(t=xui.$cache.data.$DATE_WEEKFROM)?t:0},setAppLangKey:function(key){xui.$appLangKey=key},getAppLangKey:function(key){return xui.$appLangKey},getLang:function(){return xui.$localeKey},setLang:function(key,onOK,callback){var t,v,i,j,f,m,z,l,g=xui.getRes,a=[];if(xui.$localeKey=key,v=document.getElementsByTagName?document.getElementsByTagName("span"):document.all&&document.all.tags?document.all.tags("span"):null){for(i=0;t=v[i];i++)t.id==xui.$localeDomId&&(a[a.length]=t);l=a.length,f=function(){var ff=function(){for(j=a.splice(0,100),i=0;t=j[i];i++)t.className&&"string"==typeof(v=g(t.className))&&(t.innerHTML=v);a.length&&xui.setTimeout(ff,0),xui.tryF(callback,[a.length,l]),a.length||xui.tryF(onOK,[0,l])};ff()},z="xui.Locale."+key,m=function(){var k=xui.$appLangKey;k?xui.include(z+"."+k,xui.getPath("Locale."+key,".js"),f,f):f()},xui.include(z+".inline.$_$",xui.getPath(z,".js"),m,m)}},getTheme:function(a,e){try{(e=document.createElement("xui")).className="setting-uikey",document.body.appendChild(e),a=xui(e).css("font-family"),document.body.removeChild(e)}catch(e$2){}finally{return a||"default"}},setTheme:function(key,refresh,onSucess,onFail,tag){key=key||"default";var okey=xui.getTheme();if(key!=okey){var onend=function(onSucess){if("default"!=okey){for(var style;style=xui.CSS.$getCSSValue(".setting-uikey","fontFamily",okey);)style.disabled=!0,style.parentNode.removeChild(style),style=null;for(;(style=document.getElementById("theme:"+okey))&&"link"==style.tagName.toLowerCase();)style.parentNode.removeChild(style)}!1!==refresh&&xui.CSS.adjustFont(),xui.tryF(onSucess)};if("default"==key)onend(onSucess);else{var id="theme:"+key,path=xui.getPath("xui.appearance."+key,"");tag?xui.getFileAsync(path+"theme.css",(function(rsp){rsp=(rsp=xui.replace(rsp,[[/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/,"$0"],[/\{[^}]*\}/,"$0"],[/([^\/{},]+)/,function(a){return xui.str.endWith(a[0],".setting-uikey")?a[0]:a[0].replace(/([^\s>]+)/,"$1"+tag)}]])).replace(/url\(([^)]+)\)/g,"url("+path+"$1)"),xui.CSS._appendSS(xui("head"),rsp,id,!1)})):xui.CSS.includeLink(path+"theme.css",id);var count=0,fun=function(){if(count++>4){if(fun=count=null,!1!==xui.tryF(onFail))throw new Error("errLoadTheme:"+key)}else xui.getTheme()==key?(onend(onSucess),fun=count=null):xui.asyRun(fun,100*count)};fun()}}else xui.tryF(onSucess)},reLayout:function(){xui.UI&&xui.UI.getAll().reLayout(!0)},_langParamReg:/\x24(\d+)/g,_langscMark:/[$@{][\S]+/,_langReg:/((\$)([^\w\(]))|((\$)([\w][\w\.-]*[\w]+))|((\$)\(([\w][\w\.]*[^)\n\r]+))\)|((\$)([^\s]))|((@)([\w][\w\.]*[\w]+)(@?))|((@)([^\s])(@?))|((\{)([~!@#$%^&*+-\/?.|:][\w\[\]]*|[\w\[\]]+(\(\))?(\.[\w\[\]]+(\(\))?)*)(\}))/g,_escapeMap:{$:"",".":"","-":"",")":"","@":""},_unescapeMap:{"":"$","":".","":"-","":")","":"@"},getRes:function(path){var arr,conf,tmp,params=arguments;if(xui.isStr(path))"$"==(path=path.replace(/\$([$.-])/g,(function(a,b){return xui._escapeMap[b]||a}))).charAt(0)&&(path=path.slice(1)),-1!=path.indexOf("-")?(tmp=path.split("-"),path=tmp[0],params=tmp):xui.isArr(params[1])&&(params=params[1]).unshift(path),(arr=path.split("."))[arr.length-1]=arr[arr.length-1].replace(/([\x01\x02\x03\x04])/g,(function(a){return xui._unescapeMap[a]}));else{if(!xui.isArr(path))return path;arr=path}return"function"==(tmp=typeof(conf=xui.get(xui.Locale[xui.$localeKey],arr)))?conf.apply(null,params):"object"==tmp?conf:(conf="string"==tmp?conf.replace(/\$([$.-])/g,(function(a,b){return xui._escapeMap[b]||a})):arr[arr.length-1],(params.length>1?conf.replace(xui._langParamReg,(function(z,id,k){return null===(k=params[+id+1])||k===undefined?z:k})):conf).replace(/([\x01\x02\x03])/g,(function(a){return xui._unescapeMap[a]})))},wrapRes:function(id){if(!xui.isStr(id))return id;var s,r,i=id;return"$"==i.charAt(0)&&(arguments[0]=i.substr(1,i.length-1)),(s=id)==(r=xui.getRes.apply(null,arguments))&&(r=i),'<span id="'+xui.$localeDomId+'" class="'+s.replace(/([\x01\x02\x03\x04])/g,(function(a){return"$"+xui._unescapeMap[a]}))+'" '+xui.$IEUNSELECTABLE()+">"+r+"</span>"},adjustRes:function(str,wrap,onlyBraces,onlyVars,params,scope1,scope2){return xui.isStr(str)?(wrap=wrap?xui.wrapRes:xui.getRes,str=str.replace(/\$([\$\.\-\)])/g,(function(a,b){return xui._escapeMap[b]||a})),(str=xui._langscMark.test(str)?str.replace(xui._langReg,(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){return"$"==c?onlyVars?a:d:"$"==f?onlyVars?a:wrap(g,params):"$"==i?onlyVars?a:wrap(j,params):"$"==l?onlyVars?a:wrap(m,params):(onlyBraces||"@"!=o&&"@"!=s)&&"{"!=w?a:(z=xui.SC.get("@"==o?p:"@"==s?t:x,scope1,scope2))||(xui.isSet(z)?z:"")})):str).replace(/([\x01\x02\x03\x04])/g,(function(a){return xui._unescapeMap[a]}))):str},_feval:function(body,scope){try{return new Function("","with(this){return "+body+"}").apply(scope||{})}catch(e){return""}},adjustVar:function(obj,scope1,scope2){var t;return"string"==typeof obj?"{[]}"==obj?[]:"{{}}"==obj?{}:"{}"==obj?"":"{true}"==obj||"{false}"!=obj&&("{NaN}"==obj?NaN:"{null}"==obj?null:"{undefined}"==obj?undefined:"{now}"==obj?new Date:(t=/^\s*\{\s*eval\s*\((.*)\)\s*\}\s*$/.exec(obj))?this._feval(t[1],scope1||scope2):(t=/^\s*\{((-?\d\d*\.\d*)|(-?\d\d*)|(-?\.\d\d*))\}\s*$/.exec(obj))?parseFloat(t[1]):(t=/^\s*\{([\w\.]+\([^)]*\))\s*\}\s*$/.exec(obj))&&(scope1||scope2)&&xui.isHash(scope1||scope2)?new Function("try{return this."+t[1]+"}catch(e){}").call(scope1||scope2):(t=/^\s*\{([^}]+)\}\s*$/.exec(obj))?xui.SC.get(t[1],scope1,scope2):xui.adjustRes(obj,!1,!0,!0,null,scope1,scope2)):obj},_getrpc:function(uri,query,options){var t=options&&options.proxyType?options.proxyType.toLowerCase():"";return"sajax"==t||"jsonp"==t?xui.JSONP:"iajax"==t||"xdmi"==t?xui.XDMI:"ajax"==t?xui.Ajax:"object"==typeof query&&function(d){if(!xui.isHash(d))return 0;for(var i in d)if(d[i]&&1==d[i].nodeType&&"INPUT"==d[i].nodeName||d[i]&&d[i].$xuiFileCtrl)return 1}(query)?xui.XDMI:options&&options.method&&"post"==options.method.toLowerCase()?xui.absIO.isCrossDomain(uri)?xui.XDMI:xui.Ajax:xui.absIO.isCrossDomain(uri)?xui.JSONP:xui.Ajax},request:function(uri,query,onSuccess,onFail,threadid,options){return xui._getrpc(uri,query,options).apply(null,arguments).start()},ajax:function(uri,query,onSuccess,onFail,threadid,options){return xui.Ajax.apply(null,arguments).start()},jsonp:function(uri,query,onSuccess,onFail,threadid,options){return xui.JSONP.apply(null,arguments).start()},xdmi:function(uri,query,onSuccess,onFail,threadid,options){return xui.XDMI.apply(null,arguments).start()},restGet:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="get",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restPost:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="post",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restPut:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="put",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restDelete:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="delete",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},getFileSync:function(uri,onSuccess,onFail,options){return xui.Ajax(uri,xui._rnd(options&&options.force),onSuccess,onFail,null,xui.merge({asy:!1,rspType:options&&options.rspType||"text"},options,"without")).start()||null},getFileAsync:function(uri,onSuccess,onFail,threadid,options){xui.Ajax(uri,xui._rnd(options&&options.force),onSuccess,onFail,threadid,xui.merge({asy:!0,rspType:options&&options.rspType||"text"},options,"without")).start()},include:function(id,path,onSuccess,onFail,sync,options){if(id&&xui.SC.get(id))xui.tryF(onSuccess);else{options=options||{};var rnd=xui._rnd(options.force);options.rspType="script",options.keepDomNode=1,sync?(options.asy=!sync,xui.Ajax(path,rnd,(function(rsp){try{xui.exec(rsp,id)}catch(e){xui.tryF(onFail,[e])}xui.tryF(onSuccess)}),onFail,0,options).start()):(options.checkKey=id,xui.JSONP(path,rnd,onSuccess,onFail,0,options).start())}},mailTo:function(email,subject,body,cc,bcc){xui.isHash(subject)&&(bcc=subject.bcc||"",cc=subject.cc||"",body=subject.body||"",subject=subject.subject||"");var url="mailto:"+email+"?subject="+encodeURIComponent(xui.adjustRes(subject||""))+"&body= "+encodeURIComponent(xui.adjustRes(body||""))+"&cc= "+(cc||"")+"&bcc= "+(bcc||"");xui.XDMI(url).start()},fetchAlienClass:function(uri,onSuccess,onFail,onAlert,force,threadid,options){return(options=options||{}).alien=!0,this.fetchClass(uri,onSuccess,onFail,onAlert,force,threadid,options)},_getIdUri:function(item,options){var attrs,id,uri,obj;return xui.isHash(item)?(id=item.id,uri=item.uri,delete(attrs=xui.copy(item)).id,delete attrs.uri):(obj=/^\[([\w][\w\.]*[\w])\](.+)/.exec(item))?(id=obj[1],uri=obj[2]):/^[\w][\w\.]*[\w]$/.test(item)?(id=item,uri=xui.getPath(id,".js","js",options)):(uri=item,id=xui.getClassName(uri)),{id:id,uri:uri,attrs:attrs}},fetchClass:function(uri,onSuccess,onFail,onAlert,force,threadid,options){!(options=options||{}).hasOwnProperty("appPath")&&window["/"]&&(options.appPath=window["/"]);var ww,c=xui.$cache.clsByURI,onFetching=xui.$cache.fetching,clearFetching=function(){for(var i in onFetching[uri][3])xui.Thread.abort(onFetching[uri][3][i]);onFetching[uri]&&(onFetching[uri][0].length=0,onFetching[uri][1].length=0,onFetching[uri][2].length=0,onFetching[uri][3].length=0,onFetching[uri].length=0,delete onFetching[uri]),onFetching=null},rnd=xui._rnd(options.force),obj=xui._getIdUri(uri,options),cls=obj.id,attrs=obj.attrs;uri=obj.uri,!force&&xui.isSet(obj=cls&&xui.SC.get(cls)||c[uri])?xui.tryF(onSuccess,[uri,obj&&obj.KEY],obj):onFetching[uri]?(onSuccess&&onFetching[uri][0].push(onSuccess),onFail&&onFetching[uri][1].push(onFail),onAlert&&onFetching[uri][2].push(onAlert),threadid&&(onFetching[uri][3].push(threadid),xui.Thread.suspend(threadid))):(onFetching[uri]=[onSuccess=onSuccess?[onSuccess]:[],onFail=onFail?[onFail]:[],onAlert=onAlert?[onAlert]:[],[]],options.sync||options.useAjax?xui.Ajax(uri,rnd,(function(rsp){xui.Class._ignoreNSCache=1,xui.Class._last=null;var s=xui.getClassName(uri);options.alien&&(ww=xui.window,xui.window={});try{xui.exec(rsp,s)}catch(e){for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],[e]);xui.Class._last=null}if(xui.Class._last&&(obj=c[uri]=xui.Class._last),xui.Class._ignoreNSCache=xui.Class._last=null,cls){if(obj)for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);else for(i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],['"'+uri+'" is not an xui class!']);var clsName=xui.getClassName(uri);if(obj&&clsName&&obj.KEY!=clsName){var msg="[xui] > The last class name in '"+uri+"' should be '"+clsName+"', but it's '"+obj.KEY+"'!";for(i=0,l=onAlert.length;i<l;i++)xui.tryF(onAlert[i],[msg,uri,clsName,obj.KEY]);xui.log(msg)}}else for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);options.alien&&(xui.window=ww),clearFetching()}),(function(){options.alien&&(xui.window=ww),xui.Class._ignoreNSCache=xui.Class._last=null;for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],xui.toArr(arguments));clearFetching()}),threadid,{rspType:"text",asy:!options.sync}).start():(xui.Class._ignoreNSCache=1,xui.Class._last=null,options.alien&&(ww=xui.window,xui.window={}),xui.JSONP(uri,rnd,(function(){if(xui.Class._last&&(obj=c[uri]=xui.Class._last),xui.Class._ignoreNSCache=xui.Class._last=null,cls){if(obj)for(var i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);else for(i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],['"'+uri+'" is not an xui class!']);var clsName=xui.getClassName(uri);if(obj&&clsName&&obj.KEY!=clsName){var msg="[xui] > The last class name in '"+uri+"' should be '"+clsName+"', but it's '"+obj.KEY+"'!";for(i=0,l=onAlert.length;i<l;i++)xui.tryF(onAlert[i],[msg,uri,clsName,obj.KEY]);xui.log(msg)}}else for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);options.alien&&(xui.window=ww),clearFetching()}),(function(){options.alien&&(xui.window=ww),xui.Class._ignoreNSCache=xui.Class._last=null;for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],xui.toArr(arguments));clearFetching()}),threadid,{rspType:"script",keepDomNode:!options.noDomNode,attrs:attrs}).start()))},fetchClasses:function(uris,onEnd,onSuccess,onFail,onAlert,force,threadid,options){xui.arr.removeDuplicate(uris);for(var hash={},f=function(uri,i,hash){hash[i]=xui.Thread(null,[function(tid){xui.fetchClass(uri,onSuccess,onFail,onAlert,force,tid,options)}])},i=0,l=uris.length;i<l;i++)f(uris[i],i,hash);return xui.Thread.group(null,hash,null,(function(){xui.Thread.suspend(threadid)}),(function(){!1!==xui.tryF(onEnd,arguments,this)&&xui.Thread.resume(threadid)})).start()},_collectClassRequired:function(cls,required,required2,options){if(cls.$xuiclass$){var t,id,uri,obj;if(xui.isArr(t=cls.prototype.Dependencies))for(var i=0,l=t.length;i<l;i++)id=xui.isHash(t[i])&&t[i].id,uri=xui.isHash(t[i])?t[i].uri:t[i],id&&!xui.Dom.byId(id)?required2.push(t[i]):xui.querySelector('link[href="'+uri+'"]').get(0)||required2.push(t[i]);if(xui.isArr(t=cls.prototype.Required))for(i=0,l=t.length;i<l;i++)xui.isArr(t[i])?required.push(t[i]):(id=(obj=xui._getIdUri(t[i],options)).id,uri=obj.uri,id&&xui.isSet(xui.SC.get(id))||xui.$cache.clsByURI[uri]||xui.$cache.fetching[uri]||required.push(t[i]));if(cls["xui.Module"]&&xui.isFun(t=cls.prototype.iniComponents))try{(t+"").replace(/\bappend\s*\(\s*xui.create\s*\(\s*['"]([\w.]+)['"]\s*[,)]/g,(function(a,b){return xui.SC.get(b)||required.push(b),a})).replace(/\.setRenderer\s*\(\s*['"]([a-zA-Z]+([\w]+\.?)+[\w]+)['"]\s*\)/g,(function(a,b){return xui.SC.get(b)||required.push(b),a})).replace(/['"](renderer|cellRenderer)['"]\s*:\s*['"]([a-zA-Z]+([\w]+\.?)+[\w]+)['"]\s*/g,(function(a,b,c){return xui.SC.get(c)||required.push(c),a})).replace(/['"]newbies['"]\s*:\s*\{([^}]+)\}/g,(function(a,b,c){for(var i=0,l=(b=b.split(/\s*,\s*/)).length;i<l;i++)(c=b[i].split(/\s*:s*/))[1]&&(c=c[1].replace(/['"\s]/g,""),xui.SC.get(c)||required.push(c));return a}))}catch(e){}}},require:function(clsArr,onEnd,onSuccess,onFail,onAlert,force,threadid,options){xui.isStr(clsArr)&&(clsArr=[clsArr]);var results={},fun=function(paths,tid){var required=[],required2=[];xui.filter(paths,(function(path){if(xui.isArr(path))return options&&!options.stopRecursive&&Array.prototype.push.apply(required,path),!1})),xui.fetchClasses(paths,(function(){for(var obj,id,uri,attrs,i=0,l=clsArr.length;i<l;i++)id=(obj=xui._getIdUri(clsArr[i],options)).id,uri=obj.uri,results[id||uri]=id?xui.SC.get(id):null;if(options&&!options.stopRecursive){for(i=0,l=paths.length;i<l;i++)(obj=xui.SC.get(paths[i]))&&obj.$xuiclass$&&xui._collectClassRequired(obj,required,required2,options);if(required2.length){for(var j=0,m=required2.length;j<m;j++)id=attrs=null,xui.isHash(required2[j])?(id=required2[j].id||null,uri=required2[j].uri,delete(attrs=xui.copy(required2[j])).id,delete attrs.uri):uri=required2[j],id&&!xui.Dom.byId(id)?xui.CSS.includeLink(uri,id,!1,attrs):xui.querySelector('link[href="'+uri+'"]').get(0)||xui.CSS.includeLink(uri,id,!1,attrs);required2=null}}return required.length?(fun(required,tid),required=null,!1):(fun=null,!onEnd||onEnd.call(null,results))}),onSuccess,onFail,onAlert,force,tid,options)};fun(clsArr,threadid)},_m:[],main:function(fun){-1==xui.arr.indexOf(xui._m,fun)&&xui._m.push(fun),xui.isDomReady&&xui._domReadyFuns()},getPath:function(key,tag,folder,options){if(key=key.split("."),folder){for(var a=[key[0],folder],i=1,l=key.length;i<l;i++)a.push(key[i]);key.length=0,key=a}var pre,t,ini=xui.ini,ensureTag=function(s){return s&&"/"!=s.slice(-1)?s+"/":s};return"xui"==key[0]?(key.shift(),key.length==(folder?1:0)&&key.push("xui"),pre=ensureTag(options&&options.xuiPath||ini.path)):(key.length==1+(folder?1:0)&&".js"==tag&&key.push("index"),(pre=ensureTag(options&&options.appPath))?((t=options&&options.verPath)&&(pre+=ensureTag(t)),(t=options&&options.ver)&&(pre+=ensureTag(t))):(pre=ensureTag(ini.appPath))&&((t=ini.verPath)&&(pre+=ensureTag(t)),(t=ini.ver)&&(pre+=ensureTag(t)))),pre+key.join("/")+(tag||"/")},getClassName:function(uri){if(uri&&xui.isStr(uri)){var b,a=uri.split(/\/js\//g),n=a.length;if(n>=2)return a[n-2]+"/"==xui.ini.path&&(a[n-2]="xui"),((b=(b=a[n-2].split(/\//g))[b.length-1])+((a=a[n-1].replace(/\.js$/i,""))?".":"")+a.replace(/\//g,".")).replace(/^([^.]+)\.index$/,"$1")}},log:xui.fun(),echo:xui.fun(),message:xui.fun(),getErrMsg:function(e,split){return(e&&(e.stack||e.stacktrace||(console&&console.trace?console.trace():null)||e.description||e.message||e.toString())).replace(/\n/g,split||"<br />")},_pool:[],getObject:function(id){return xui._pool["$"+id]},getObjectByAlias:function(alias){var o,a=[],l=0;for(var i in xui._pool)"alias"in(o=xui._pool[i])&&o.alias===alias&&(a.push(o),l++);return 0===l?null:1===l?a[0]:a},_ghostDivId:"xui.ghost::",$getGhostDiv:function(){var p,pool=xui.$cache.ghostDiv,i=0,l=pool.length;do{p=pool[i++]}while(i<l&&p&&p.firstChild);return p&&!p.firstChild||((p=document.createElement("div")).id=xui._ghostDivId,pool.push(p)),p},$xid:0,$registerNode:function(o){var id,v,purge=xui.$cache.domPurgeData;return o.$xid&&(v=purge[o.$xid])&&v.element==o||((v=purge[id="!"+xui.$xid++]||(purge[id]={})).element=o,o.$xid=v.$xid=id),o=null,v},getId:function(node){return"string"==typeof node&&(node=document.getElementById(node)),node?window===node?"!window":document===node?"!document":node.$xid||"":""},getNode:function(xid){return xui.use(xid).get(0)},getNodeData:function(node,path){if(node)return xui.get(xui.$cache.domPurgeData["string"==typeof node?node:xui.getId(node)],path)},setData:function(path,value){return xui.set(xui.$cache.data,path,value)},getData:function(path){return xui.get(xui.$cache.data,path)},setNodeData:function(node,path,value){if(node)return xui.set(xui.$cache.domPurgeData["string"==typeof node?node:xui.getId(node)],path,value)},$purgeChildren:function(node){var i,j,o,t,v,w,id,cache=xui.$cache,proMap=cache.profileMap,pdata=(cache.UIKeyMapEvents,cache.domPurgeData),event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3,children=xui.browser.ie&&node.all?node.all:node.getElementsByTagName("*"),l=children.length,bak=[];for(i=0;i<l;i++)if(v=children[i]){if(t=v.$xid){if(o=pdata[t]){if(w=o.eHandlers)for(j in xui.browser.isTouch&&w.onxuitouchdown&&event._removeEventListener(v,"xuitouchdown",handler),w)event._removeEventListener(v,j,handler),event._removeEventListener(v,j,handler3);for(j in o)o[j]=null;delete pdata[t]}xui.browser.ie?v.removeAttribute("$xid"):delete v.$xid}if((id=v.id)&&id in proMap){if(!(o=proMap[id]))continue;if("!window"===(t=o.renderId)||"!document"===t)continue;o.__gc(!0,!0),bak[bak.length]=id,o.$domId&&o.$domId!=o.domId&&(bak[bak.length]=o.$domId)}}for(i=0;i<bak.length;)delete proMap[bak[i++]];for(i=node.childNodes.length-1;i>=0;i--)node.removeChild(node.childNodes[i])},create:function(tag,bak){var arr,o,t,r1=/</;if(xui.isArr(tag)){arr=[];for(var i=0,l=tag.length;i<l;i++)Array.prototype.push.apply(arr,xui.create(tag[i]).get());return xui(arr)}if("string"==typeof tag)if(t=xui.absBox.$type[tag]){for(arr=[],i=1,l=arguments.length;i<l;i++)arr[i-1]=arguments[i];(o=new(xui.SC(t))(!1))._ini&&o._ini.apply(o,arr)}else(t=xui.SC.get(tag))&&t["xui.Module"]||"xui.Module"==bak?t?o=new t:(o=new xui.UI.MoudluePlaceHolder,xui.require(tag,(function(module){if(module&&module["xui.Module"]){var t=o.get(0);if(t)if(t.renderId){var m=new module;m.create((function(){o.replaceWithModule(m)}))}else t._module=new module}}))):/^[\w-]+$/.test(tag)?((o=document.createElement(tag)).id="string"==typeof id?id:xui.id(),o=xui(o)):(r1.test(tag)&&(o=xui.str.toDom(tag)),o&&o.n0||(o=xui.str.toDom("<xui>"+tag+"</xui>")));else tag["xui.Module"]?(t=xui.SC.get(tag.key))&&t["xui.Module"]?o=new t(tag):(o=new xui.UI.MoudluePlaceHolder,(t=tag.events)&&o.setEvents(t),(t=tag.properties)&&o.setProperties(t),tag.moduleClass&&tag.moduleXid&&(o.get(0).moduleClass=tag.moduleClass,o.get(0).moduleXid=tag.moduleXid),xui.require(tag.key,(function(module){if(module&&module["xui.Module"]){var m=new module(tag);m.create((function(){o.replaceWithModule(m)}))}}))):o=new(xui.SC(tag.key))(tag);return o["xui.absObj"]&&(t=o.n0)&&t.host&&t.host!=t&&t.alias&&o.setHost(t.host,t.alias),o},query:function(){return xui.doc.query.apply(xui.doc,arguments)},querySelector:function(){return xui.doc.querySelector.apply(xui.doc,arguments)},querySelectorAll:function(){return xui.doc.querySelectorAll.apply(xui.doc,arguments)},use:function(xid){var c=xui._tempBox||(xui._tempBox=xui()),n=c._nodes;return n[0]=xid,1!=n.length&&(n.length=1),c}}),new function(){var ini=xui.ini={rootModuleName:"_xui_root"};window.xui_ini&&xui.merge(ini,window.xui_ini,"all");var w=window,u=navigator.userAgent.toLowerCase(),d=document,dm=d.documentMode,b=xui.browser={kde:/webkit/.test(u),applewebkit:/applewebkit/.test(u),opr:/opera/.test(u),ie:/msie/.test(u)&&!/opera/.test(u),newie:/trident\/.* rv:([0-9]{1,}[.0-9]{0,})/.test(u),gek:/mozilla/.test(u)&&!/(compatible|webkit)/.test(u),isStrict:"CSS1Compat"==d.compatMode,isWebKit:/webkit/.test(u),isFF:/firefox/.test(u),isChrome:/chrome/.test(u),isSafari:!/chrome/.test(u)&&/safari/.test(u),isWin:/(windows|win32)/.test(u),isMac:/(macintosh|mac os x)/.test(u),isAir:/adobeair/.test(u),isLinux:/linux/.test(u),isSecure:0==location.href.toLowerCase().indexOf("https"),isTouch:!!(navigator.userAgent.match(/AppleWebkit.*Mobile.*/)||"ontouchend"in d&&!/hp-tablet/.test(u)||w.DocumentTouch&&d instanceof w.DocumentTouch||w.PointerEvent||w.MSPointerEvent),isIOS:/iphone|ipad|ipod/.test(u),isAndroid:/android/.test(u),isBB:/blackberry/.test(u)||/BB[\d]+;.+\sMobile\s/.test(navigator.userAgent)},v=function(k,s){return s=u.split(s)[1].split("."),k+(b.ver=parseFloat(s.length>0&&isFinite(s[1])?s[0]+"."+s[1]:s[0]))};if(w.matchMedia&&"function"==typeof w.matchMedia?(b.isTouch=w.matchMedia("(any-pointer: coarse)").matches,b.deviceType=b.isTouch?w.matchMedia("(any-hover: hover)").matches||w.matchMedia("(any-pointer: fine)").matches?"hybrid":"touchOnly":"mouseOnly"):b.deviceType=b.isTouch?"touchOnly":"mouseOnly",xui.ini.fakeTouch&&"mouseOnly"==b.deviceType&&(b.fakeTouch=!0),xui.$secureUrl=b.isSecure&&b.ie?'javascript:""':"about:blank",xui.filter(b,(function(o){return!!o})),b.newie)b["newie"+(b.ver=dm)]=!0,b.cssTag1="-ms-",b.cssTag2="ms";else if(b.ie){if(xui.isNumb(dm)?b["ie"+(b.ver=dm)]=!0:b[v("ie","msie ")]=!0,b.ie6){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}w.XMLHttpRequest=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}(b.ie6||b.ie7)&&(b.ie67=1),(b.ie6||b.ie7||b.ie8)&&(b.ie678=1),b.cssTag1="-ms-",b.cssTag2="ms"}else b.gek?(b[v("gek",/.+\//)]=!0,b.cssTag1="-moz-",b.cssTag2="Moz"):b.opr?(b[v("opr","opera/")]=!0,b.cssTag1="-o-",b.cssTag2="O"):b.kde&&(b[v("kde","webkit/")]=!0,b.isSafari?/applewebkit\/4/.test(u)?b["safari"+(b.ver=2)]=!0:/version/.test(u)&&(b[v("safari","version/")]=!0):b.isChrome&&(b[v("chrome","chrome/")]=!0),b.isWebKit?(b.cssTag1="-webkit-",b.cssTag2="Webkit"):(b.cssTag1="-khtml-",b.cssTag2="Khtml"));if(b.isBB&&!b.ver&&(b.ver=parseFloat(u.split("/")[1].substring(0,3)),b["bb"+b.ver]=!0),!ini.path)for(var s,arr=document.getElementsByTagName("script"),reg=/js\/xui(-[\w]+)?\.js$/,l=arr.length;--l>=0;)if((s=arr[l].src).match(reg)){ini.path=s.replace(reg,"").replace(/\(/g,"%28").replace(/\)/g,"%29");break}xui.merge(ini,{appPath:location.href.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,""),dummy_tag:"$_dummy_$"},"without"),ini.path||(ini.path=ini.appPath+"/xui/"),ini.basePath||(ini.basePath=ini.path.replace(/xui\/$/,"").replace(/runtime\/$/,"")),ini.releasePath=ini.appPath,ini.verPath&&(ini.releasePath+=(ini.verPath?ini.verPath+"/":"")+(ini.ver?ini.ver+"/":""));var data=new Image;data.onload=data.onerror=function(){var path=xui.ini.path+"appearance/_oldbrowser/";1==this.width&&1==this.height||(document.documentElement.className+=" xui-nodatauri",xui.merge(xui.ini,{img_dd:path+"ondrag.gif",img_busy:path+"busy.gif",img_pic:path+"picture.png",img_handler:path+"handler.gif",img_bg:path+"bg.gif",img_blank:path+"bg.gif",img_touchcur:path+"touchcur.png"},"without")),data.onload=data.onerror=null},data.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",xui.merge(xui.ini,{img_dd:"data:image/gif;base64,R0lGODlhEABAAPcAAAAAAAEBAQICAgMDAwUFBAUFBQcHBwgICAkJCQwMDA8PDx4eHiQkJDAwMD8/P0JCQl1dXf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAQAEAAAAj/AP8JHPigQQMHAxMOTAAAgIABAgAkUPgPQsMABAoQCNAQAISEFw0cMMCxI4CFAAIY+Eey4b+LCgSmXCnzpECVBf49AEBgJEWVBwg8WCCgQMuEQEkuYDBgo8uBIlsyeCCgJMWWAB68fPpP5cCOAhm6TLpV4teQI0tyrTgzrcmPChNoVIuAYsKCB+3qtQsgQt+/fgPb/Ce4MOCvEfb6HbhYb1/Eigc35ptYZmW7kw1rRgy48+S9oEOLHk26tGnRnlMzTl0Yst7Mgyk+tnzWpO3JfSPo3q274eXcfjv21rxbeHDBwE32VphbeHPmvYEvBzmc9+eXxa3Hxm69OHPbtk2zNO68WvNh2q8lb6fuuix434Ola5/Nvbt53tLhH8/unXpw49vlhx90/E2HmH3XyTcgSO91FBAAOw==",img_busy:"data:image/gif;base64,R0lGODlhEAAQAOMAAAQCBHx+fLy+vOTm5ERCRMTGxISGhAQGBISChMTCxOzq7FRSVMzKzP7+/gAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQANACwAAAAAEAAQAAAESrDJSau9OOvNe1VFonCFIBRcIiQJp7BjNySDxRjMNAQBUk+FAwCAaiR6gURhsUgYhgCEZIDgDRYEwqIALTZmNay2UTB4KwKmwBIBACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRE8MlJq7046827n47RIJwBAEZ5phsikg9TMNZBHBMj7PR0DEDco7ATFA6JhA04IEh0AgUjEQgomcLY7EG1PmzZClJpiQAAIfkECQkADQAsAAAAABAAEAAABEewyUmrtcywWxn4BTcZH4CIUlGGaFMYbOsuSywuBLHIuC4LNEFrkBjIBoEAwmhRFBKKRDKQuBQEgsIAoWRWEoJEleitRKGWCAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJ6UxDM2sDgHkHcWgT5x1DOpKIhRDpQJAaqtK1iJNHkqy7RyIQSAQlw+IR5APiGAXGkiGoSoOFqqBwpAoU1yA0vJxEAAAh+QQJCQANACwAAAAAEAAQAAAES7DJWdYqMzdmWFsEsTRDMkwMoFbhMgQBcjaGCiCCJQhwkEgFG2YyQMRmjYJhmCkhNVBFoqCAQgu7nzWTECS0W4k0UQ2bz+i0en2OAAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJeVI6M79DcApB8jAFQy3DUIEJI7zmQ6RDZx3FKxTSQWMTl0AR23Q0o5LEYWggkEgDAGCAaqRUawbRfGq/4LB4TC5DIwAh+QQJCQANACwAAAAAEAAQAAAER7DJqUpSM7eRRkuCUGjSgAQIJyQJ+QXwxWLkAKeuxnm5VCyLVk+yIBAWQ6IRmRQABclJwcCIMg4AwGhoyAIQyYJ3O5ySo9EIACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRG8MlJ62SFWcuE19tUeEIRXp4Cng+2hkeSHKyUBEFSP3e+x7Od5ECg1Q6LwcB4IigHBETD4NgcngcDAGCAFR9a7g5hMCAsEQA7",img_pic:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJOgAACToB8GSSSgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA92SURBVHiczZt7fFTlmce/ZzKT66S5cQsChUC4yKVsFaEUYlAWi4ClfqTq6tYVrfVSy1W01roudPWj4H6ga6ygu3SpZdeu0iKIgLFoIZREBAIGSDDhHkLIhMncJzNz3v3jPScZkklyzkzYT5/5vJ9J5pzznvf3O8/7vM/zvM9RhBAkIoqiWAALYNNaMpCkHY4AIaBV+1aFEGpCN+xlURIhQAOfBKQCGUAmkI4kQUEC9wEewAv4gfDfEgnWeC9UFEVBPvk04BtAXyAXSUKqdloQCf4q4ABaAK+iKKG/FRLiJgAJPgUJuL/W+gHpAyBTBdEon74PqR2p2v0UJAmtZkjQCL9GRKLzlzgJiHr6KUAWkJMPgyfB8BkwdDjkW4DTcGU31B6D+jNgsUJSWF6nAJ6eSFAURcFJAWl8Cz9ZOKliPcd5iSAgFEVRkTzETURcNkCb+8lIlc8fDeN/CjO/D7f2gb5WsGoGIOSCli1QthEOfgE1yKlwCWhCTo+Y00HxKzeQyjsofO+aAxHqqWIR32I30rCGgEjcJAghTDek4csAhoyHO7fCe5ehQYCI1a6C869w8LvwPHA3UAwUAnlILbJc07+fIgTNiG4+VfwKyEfaH1vHPow2S1ysSVFSIHk2DJoKk/tJGxBTsiFrLIx6FeYXwY0a8IFIDbIDNk2rUAJKEal8BOR0e/fRrOBFpml9pANJsexET5IIAaIAlHtgUhbc0NPJmWCfCDe+Bt+fBqOJRYJTmaGBtxsYuY0fsRgYgLRDKYDFLAnxrgIqEJ4MDIZh1nbHp1vJgIwbYczLoD4P7IOTbQcrmEo2mzECXpc+FCI1L4D0MVq1sRmWRDQgMhWUTKmqhg1QJmRMhLFr4AdFuia8zmxu4j3MgJed5ZJEDlID0mlfZg1LXARoFlf9IzS0QoUwyXomZIyD0f8Kdw1/jNn8jNewkGZ6IE04iJBKu/dpSBOjJW5HSAihblCUsApVQi5pA8xcnwEZzmLGX1jLzVjj1MRTnEc+xCTa/YvrrwG6PCaEbyNsjMABs9d+VgT3bSctmBbnGAIEeJrdyIArrH2rmJiOkCABABUQcMEqAYeNXrPnVpi7A7wZcd9WsJZtHMaBNH5eZNxhPr4w6Pjorm90U9A8yR2Qch5GhOFAV86Q3v58KyLD062L09NH5U22ASuAx4F5wASgD9IOWLoab0xs3QH3+xkaibAyHOajcJjyQIC3Gxq4H2l0UpA2xAIo68HWBLcI+Or/AfxzwJPAAmAKMBiw4/PdQzi8nnC4nFBoB17vy3z++RhkIKYbScUQAeEwjwqBK9Zht5udK1cyFumGpugdb4P0Bhgfhr2dwBf3Avg3+Aj4OfAUcC8wDRjOW28VEgp9GBNIJOKhpmY50vHKoIPb3BX4BT3NDL+fc88+yzRkHqBtDV4ASZdgrArHosGnexME/zp/BlYCi4D7gOnACDZtGkckUtvjPC4tXappSpY+VWIS4HKRJwSXjcQSXi8XnniCmcigxK6TsB/SHDAlDOW9An4VB4H1wEvAo8BtwCg2bhxvCLwQgkDAye23/z0wlPYASon19P/BTEDl8XDxkUf4HjIeaCNhPdiKt/Ngqp9IvNAVFfHtxTj7wi7gbeBfgPuBSaxZc5Nh8Hr77W//DbhFG2s6YOlk7UMhXjdDgGYT6hcuZPY1JPi5HUHcz15REXOfQPwSgj+Guhvgv4EXgAd46KE5tLaeNjdKIfjss13AbGAM0oW3dvIDhCCl4289id1O/rp1/MfChUwAsjjGHVj5EEG62b4AFAFznoLv/gb6Q/IUyF8KE8dCDsXFfSkp2YDNNjSOrlOR6m9HWxU6usKKz8eRrCzzPesk1Exl3b5s/pkAaaSirQ/G+4kGn4lc3AdCagZ8c1BGxm0PvP/+4HBGRp75EQJHjtQjV60UtNWgkwYcPkypquKJp3+7nfxt97JsSCM+WpBBagTDzmkX4BkADIW0GV7viIfWrPEY7zFKgsEgGzee6vR7RxsApNTVscysHYhuzS6uDDlIMxcQuBGEEKjG5vwrIN4A8T8g/gKiBoQDRABECMQVcP9oxYpzCKGaGtWvf/1HYAnSiN6i8ZoSiwAbkFNfz5ZESHC00DSkAqcREoyAj2gtAKIWPD945pkLhknYt+8Q8CzwE2AuMBZpBG2dzkXO2vTsbL555gzbEyHhylWah5TT0h0JRsGrWguBaAFRCd55y5df6pGEsrJDWK3PA08jvcepSIcoHUiKRYCuBdmZmYyqrWXHdSRBvW0RLiPgda8yAiIIohnEIfDOWb68vksSysoOa+AXAQ/Qno3OpitHSCNB3/ToY7dz49dfs/M6kKAm/Ts7RsO6lVBrBHw0CQHtvEPgmRNLE/bu/Qqr9UVgMfAgcDsyBdeHqFR8l6PWSEgF+trtjO1lElTeYCvwnAWevgWW7oQ6I+CF9ns0CV+Cb240CXv21GC1rkFGjf8EzESm4/tqmNqCoS53hqK2v2xApt1O/8pKXi8oYFb3603X0uTk6k3VJJ3bSynPsB+ZzHDkgWMp5D4MP8+BiTbaA/quRGgthMyGnAHfi8uXt5TOmhUMzp69i0jEC9QDtfIwl5Cbs/o2fdtTjn0DeYKqXeD2eLg8+k/8/vOzVMVLQJ9scg6PJPSdLRxBbos5gAYHnF29cmX1iOZmb/WoUcf0/FZ3LoSe/LMhY9yhkL5qzZqsV2fN8g2JRNKQGaIQ0hvxaf9HosHrQLtt2n2SqGEml/FYqojsqeN4ItPh6lUai4tZBMwCxrJ69TgikWqEECk+X8P+wsJTzSC8mtXvaip0nA7NII6C9zdQWQjrkEmTecB4pPp33oYzMmLc3EoYN34EjQhLFZHSU9QkQkJLCw3z53M/jz46ndbWU9FHrR5P45ZRo47Vg3CDaDVIQhCEC0QdeLbCl38no8cFQBFQgIwDrERlhXoGLzcq3agIwog2Er5C3X2S2kRIONgw6ARe75lYR60uV9N7I0acO6+BMkpCSCPCAe49cGCKdIDmAZOQnnU6PWWE2g6GmK4tXEJLTXQm4QR18YCvduW3pLQ0NnZ3ltXpbN40cmS1URJ0IvTWAq59sL8IltG+DGYDth4J6AS+Iwm++Ek42ZLvSm6+5DBydpLL1fT7wsJaMyRENze4y2DvZHgYmT3ur9kCpUsC8DAAgaPL0CUBEk625LuSHfXNZvTF5nQ2by4sPK2T0JNhjFGfcOV92PRtmUobiKxriu0IAQoqW3rM2cQg4ZMeSIgHfLQmbBo58sR5zTCaJaERau6UgdAgjYDYGoCbvj2C75qESNkRjvU2eL31+fjj0r9C3SUQPs3oGSUgCIG9sGqcDITalsPOjpCNm7r1Zjp6I3q1kB3U3WwtnsTblZVURJ9W7cp3Twh/GW7Nze++6qM7KS+v8N111x9Ww6uX4ZBeCGA0M5IESf0hq0j+23bpNQQoiqKgkm1qYDoJ/8V2lrI/FCI4ZQolx49TBlDjzndNiBwKJQS+rOww06Z94AuF1K1wvgReCMFxM2khBUKZQKHcSA3rv3fWgEYqTQ/wbT7iCcqQvr0zEODS5Mm8uK1q2M4JHA205gzINd2nPvD9ZUcoLv6AcDgI+CLgKYW6Y/AzAUdMdBWKwL4T0CI0gVgEzKSOCLWGu32HHfyEfYCb9hK4i56HnvLfVVA1OpjZp5+JQV4jeeU7zj6/s2jQ4PxwCjKQcQCO0+BYCxUn4F4VvjDQlVBlUHR+vRC+a490XAHAxiFmIwxsaLzDDmTI+VNktqUIGMnq1eMIhWoSMXh55TvO/OplS2TtWsRbb3F54kQeQ26EDkGmtZNeAqsXJgm5IRvqwgCqETjph0diLvkxlsEkIJOj/JIwgZjAAwRYwwdIN/Mp5F5dEVBISckYPbDpDfC/+x2itBRRUUH9vHnMR25tZaFldE5BihOGqfC+KmsVVc0jjKgQUOFkCJa9BNZYt+uUD4iqAs1mCZN5jEX0YwzZ9OUKTZziPMsppZwmZCjuABqABkpKrDz++J+wWEYaU/LOklfx8dkln84dbE9XLXl5kJ8vW9++ANQvXszCzZupApxoiXchhLisKBm5cE8STFJk4OMX8JkKR6xC7O3qfrEIUDQtSEPW8A0A+pNEjlaQlISMq/3aIK4AjZSUJCcM/uDOs0s+mRMTfGYm2Gzg83HhySdZ+O67HIf23QchhEBRrC2QaYPUdAhfhdYcIVq6u2fMjJBGghUZOWXBNaVoOgFebQBOXnnFyooVH19v8BYLKAq43Vz44Q/5x507OYV8CEHirBfuLiWmV1+lILUhTfvbgiRAfxkiQCj0n1itC+IBDpB3cNe5JZ/cOcierlpyc2HgwK7B61JXx1+GD2cRcBn5IIJ0zPYYkO5SYirSYfBrN2hCLnH1yDnfBLjweot7E3z0k7fbY4MHKCigqKSEecgsbwZxFElCD1ViGpt6XlAvR/Vp3wEgRHLyDLM3bZMDByoXbLzTEQ1+4MB28MnJscHrMmEC30Gmutpqhc0OoccLRLuoQohIVJMlaYoy3uxNASgvr2T69P99Z4O62e3mC7PgAQYMYCjSPn0DLd1tdhiJ1gkqqGqz6avKyyuZNu0PhMPecBjHqlWsDoX43Ax4gJYWAkj1z6C9WMuUJFwoSSh0zNT5UeCBZqC+tZVz993Hc01NfGoUPEB1NQ20v65nshJBSuIE7Nu3GVV1Gjq3vPxoR/DAReCiy8WFqVNZdvYsnxoB7/fjf+01vkSGtaZLZHVJnIA77rhEdfULPZ5XXn6UoqJo8PqKcgW5ljudThpuvpklp0/zaU/drVvH9spKmpHGWN8EuT6lsl012jdnctm162n8/s6JzmAwyJtvfojF8hxyi/pB2vfq+iH9C6vW0oB+ycmM3bWLdaEQ/o63dblw/eIXvAs8A/wYmIPc788lKttrtCX05ii0OUypQC7Tp4/i4YdnM2zYOBQlnaNH69m06WsOHtSLmp1AI+1+hJtr3/LQ45BMoM/8+Yy7+25mFBQwyuuFQ4eo37CB6tOncdO+tXYRqUnNQECYfCGzNwjQ3eY05JLUD+mc6GW0oO0vaoNs0r69aOB17y1qQzYZadlztb70N1JtWn9BwKX11Yh8M1V/LdcUoETeHAWkn6Aoih4cgfQePciYPZoAD5IEN9KZCtPBddX6UmnXighyjrdo/UUT4EGS4Nbu3buxgOmO2qPIZK3p1eQKEmyrNvBWtI3frgas9RXdX4r2bUVa+3BUX60k8OJkrxEAnQau1+mDfJptzehgo6ZEdIvur1sijcj/AcgCrHU5y1W7AAAAAElFTkSuQmCC",img_handler:"data:image/gif;base64,R0lGODlhBAAEAPcAAAAAAGSMtP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAEAAQAAAgPAP8JFCDwX4B/BAUe/BcQADs=",img_touchcur:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAMAAACqTK3AAAAAnFBMVEVKS0sAAAD6+vr39/fj4+OsrKxQUVHk5OTY2NjV1dVgYWHm5ube3t7c3NzV1dXT09PPz8/q6ur19fXNzc2/v7/v7+/u7u6QkJB1dnbt7e1SU1Pd3d3b29vW1tbU1NTT09Ps7Ozl5eXe39/e3t709PS7u7u5ublmZ2fp6enn5+fj4+Ph4eHg4ODc3Nzc3NzZ2dnZ2dnW1tbU1NTT09Pxrtv7AAAANHRSTlPmAP78+fHnyPf26NGiizAcBfr49fPu7e3q6Oedh08oDPr5+Pj38vLp3NfBuLGUkXRrSzgYlzzxjwAAAKFJREFUGNNl0NUOwzAMQFE7sDLzSmPm/f+/LY2atVXv45FlyQac1ZPnaCfLdgdqr4TF/KATq+nJS1gOXWZE35L8wlhAHw+bjuxAiCqyOgozGDKJC1hTGKeXgM52QnsN0DYmxM9iik0oFlMuWY6JVYCY8JHk5CvoSc2/LNY3edAlOCox0laSr1Eu92WrwlPPeaWE6Ru6u/soSfapyketXjjrB1sXCDrwyo6RAAAAAElFTkSuQmCC",img_bg:data.src,img_blank:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="},"without");var f=xui._domReadyFuns=function(){if(!xui.isDomReady&&(d.addEventListener?(d.removeEventListener("DOMContentLoaded",f,!1),w.removeEventListener("load",f,!1)):d.detachEvent&&(d.detachEvent("onreadystatechange",f),w.detachEvent("onload",f)),"touchOnly"!=xui.browser.deviceType&&!xui.Dom.getScrollBarSize()&&xui.UI)){var f2=function(c){xui.arr.each(c,(function(key){(key=xui.SC.get(key))&&(key.$DataModel.overflow&&(key.$DataModel.overflow.ini="auto",key.$DataStruct.overflow="auto"),key.$children&&key.$children.length&&f2(key.$children))}))};f2(xui.UI.$children)}try{if(xui.ini.customStyle&&!xui.isEmpty(xui.ini.customStyle)){var txt,arr=[],style=xui.ini.customStyle;xui.each(style,(function(v,k){arr.push(k+" : "+v+";")})),txt=".xui-custom{\r\n"+arr.join("\r\n")+"\r\n}",xui.CSS.addStyleSheet(txt,"xui:css:custom",1)}for(var i=0,l=xui._m.length;i<l;i++)xui.tryF(xui._m[i]);xui._m.length=0,xui.History&&xui.History.activate(),xui.isDomReady=!0}catch(e$3){xui.asyRun((function(){throw e$3}))}};if(d.addEventListener)d.addEventListener("DOMContentLoaded",f,!1),w.addEventListener("load",f,!1);else{d.attachEvent("onreadystatechange",f),w.attachEvent("onload",f);var ff=function(){if(!xui.isDomReady)try{d.activeElement.id,d.documentElement.doScroll("left"),f()}catch(e$4){xui.setTimeout(ff,9)}};ff()}var fe=function(){xui.isDomReady||d.readyState&&!/in/.test(d.readyState)?f():xui.setTimeout(fe,9)};fe()},new function(){xui._uriReg=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,xui._localReg=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,xui._curHref=function(a){try{return location.href}catch(e){return(a=document.createElement("a")).href="",a.href}}(),xui._localParts=xui._uriReg.exec(xui._curHref.toLowerCase())||[]},new function(){xui.pseudocode={getScope:function(eventArgs,module,temp){return{temp:temp,page:module,args:eventArgs,functions:xui.$cache.functions,constant:xui.constant,global:xui.$cache.data,getCookies:xui.Cookies.get,getFI:function(key){var h=xui.getUrlParams();return h&&h[key]}}},exec:function(_ns,conf,resumeFun,level){var t,tt,m,n,arr,t1,t2,con,ns=this,type=conf.type||"other",comparevars=function(x,y,s){switch(xui.str.trim(s)){case"=":case"is":return x===y;case"<>":case"is-not":case"!=":return x!==y;case"exists":case"defined":return xui.isDefined(x);case"not-exists":case"undefined":return!xui.isDefined(x);case"empty":return xui.isEmpty(x);case"non-empty":return!xui.isEmpty(x);case">":return parseFloat(x)>parseFloat(y);case"<":return parseFloat(x)<parseFloat(y);case">=":return parseFloat(x)>=parseFloat(y);case"<=":return parseFloat(x)<=parseFloat(y);case"inlist":return-1!==xui.arr.indexOf(xui.isArr(y)?y:(y+"").split(/[,;\s:|]+/),x);case"exlist":return-1==xui.arr.indexOf(xui.isArr(y)?y:(y+"").split(/[,;\s:|]+/),x);case"include":return-1!=(x+"").indexOf(y+"");case"exclude":return-1==(x+"").indexOf(y+"");case"begin":return 0===(x+"").indexOf(y+"");case"end":return(x+"").indexOf(y+"")===(x+"").length-(y+"").length;case"objhaskey":return"object"==typeof x&&y in x;case"objnokey":return"object"==typeof x&&!(y in x);case"arrhasvalue":return!!xui.isArr(x)&&-1!==xui.arr.indexOf(x,y);case"arrnovalue":return!!xui.isArr(x)&&-1==xui.arr.indexOf(x,y);case"objarrhaskey":return!!xui.isArr(x)&&-1!==xui.arr.subIndexOf(x,"id",y);case"objarrnokey":return!!xui.isArr(x)&&-1==xui.arr.subIndexOf(x,"id",y);default:return!1}},adjustparam=function(o,_ns){if("string"==typeof o){var m,jsondata,oo,t=o;xui.str.startWith(o,"[data]")&&(o=o.replace("[data]",""),jsondata=1),o=xui.adjustVar(oo=o,_ns),xui.isDefined(o)||(o=xui.adjustVar(oo)),jsondata&&"string"==typeof o?o=xui.unserialize(xui.getFileSync(o)):o&&xui.isStr(t)&&xui.isHash(o)&&(o.actions&&xui.isArr(o.actions)&&o.actions.length||o.return)?(t=(""+t).split(".functions"))&&2==t.length&&(t=xui.adjustVar(t[0]+"}",_ns))&&(oo=o,o=function(){return xui.pseudocode._callFunctions(oo,arguments,t,_ns.temp,null,"refer:"+(oo.desc||oo.id||""))}):o&&xui.isStr(t)&&xui.isFun(o)&&(t=t.replace(/\[(\d+)\]/,".$1"),(t=xui._s2a(t)).length>1?m=t.pop().replace(/[()}\s]/g,""):(m=t[0].replace(/[{()}\s]/g,""),t=["{window"]),t=t.join(".")+"}",t=xui.adjustVar(tt=t,_ns),xui.isDefined(t)||(t=xui.adjustVar(tt)),o=function(){return t[m].apply(t,arguments)})}else if(xui.isHash(o))for(var i in o)o[i]=adjustparam(o[i],_ns);else if(xui.isArr(o)){i=0;for(var l=o.length;i<l;i++)o[i]=adjustparam(o[i],_ns)}return o},redirection=conf.redirection,target=conf.target,method=conf.method,iparams=xui.clone(conf.args||conf.params)||[],conditions=conf.conditions||[],adjust=adjustparam(conf.adjust,_ns)||null,timeout=xui.isSet(conf.timeout)?parseInt(conf.timeout,10):null,resetid=conf.resetid||null,_debug='"'+conf.desc+'"',_var={type:type,target:target,method:method,args:iparams,pseudo:conf,scope:_ns};if(-1!=method.indexOf("-")){t=method.split("-"),method=t[0];for(var i=1,l=t.length;i<l;i++)t[i]&&(iparams[i-1]=t[i])}for(i=0,l=conditions.length;i<l;i++)if(con=conditions[i],!comparevars(xui.isDefined(t1=xui.adjustVar(con.left,_ns))?t1:xui.adjustVar(con.left),xui.isDefined(t2=xui.adjustVar(con.right,_ns))?t2:xui.adjustVar(con.right),con.symbol))return"function"==typeof resumeFun?(xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),"//",_debug,_var]),resumeFun()):void xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),"//",_debug,_var]);if(redirection&&(arr=redirection.split(":"))&&xui.isArr(arr)&&(arr[0]&&(type=arr[0]),arr[1]&&(target=arr[1]),arr[2]&&(method=arr[2])),target&&method&&"none"!=target&&"none"!=method){for(i=redirection?3:"other"!=type||"callback"!=target||"call"!=method&&"set"!=method?0:1,l=iparams.length;i<l;i++)iparams[i]=adjustparam(iparams[i],_ns);!redirection||"other"==type&&"callback"==target&&"call"==method||(iparams=iparams.slice(3));var fun=function(){if(xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),_debug,_var]),!1!==xui.tryF(ns._Handlers,[type,method,iparams,adjust,target,conf]))switch(type){case"page":if("switch"==method){xui.History._callbackTag||(xui.History._callbackTag=function(fi,init){if(!init){var ar=xui.urlDecode(fi||"");return ar.cls||(ar.cls="App",ar.cache=!0),xui("body").children().each((function(xid){var module=xui.Module.getFromDom(xid);module&&module._showed&&(ar.cache?module.hide():module.destroy())})),xui.showModule(ar.cls),!1}});var hash={cls:target,cache:!!iparams[0]};return iparams[1]&&!xui.isEmpty(iparams[1])&&(hash=xui.merge(hash,iparams[1])),void xui.History.setFI(hash,!0)}if("open"==method)return hash={cls:target},iparams[0]&&!xui.isEmpty(iparams[0])&&(hash=xui.merge(hash,iparams[0])),void window.open("#!"+xui.urlEncode(hash));var ins,cls=xui.get(window,target.split("."));if(cls)for(var i in cls._cache){ins=cls._cache[i];break}if("destroy"==method)return void(ins&&xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams));if("show"==method&&iparams.unshift((function(err,module){err&&xui.message(err)})),ins)xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams);else{var t1=_ns.temp._module_funs_=_ns.temp._module_funs_||{},t2=t1[target]=t1[target]||[];t2.push((function(ins,t){xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams)})),1===t2.length&&xui.getModule(target,(function(err,ins){if(!err){if(ins)for(var i=0,l=t2.length;i<l;i++)t2[i].call(null,ins);t2.length=0,t1=t2=null,delete _ns.temp._module_funs_[target]}}))}break;case"control":case"module":if("{"==target.charAt(0)&&(t=xui.adjustVar(target,_ns))&&xui.isFun(t.getAlias)&&(target=t.getAlias()),"disable"==method||"enable"==method)xui.isFun(t=xui.get(_ns.page,[target,"setDisabled"]))&&t.apply(_ns.page[target],["disable"==method,!0]);else{if("setProperties"==method){var params=xui.merge(iparams[0],iparams[1],"all");iparams[1]=null,(m=params)&&(m.CA&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomAttr"]))&&t.apply(_ns.page[target],[m.CA]),delete m.CA),m.CC&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomClass"]))&&t.apply(_ns.page[target],[m.CC]),delete m.CC),m.CS&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomStyle"]))&&t.apply(_ns.page[target],[m.CS]),delete m.CS))}xui.isFun(t=xui.get(_ns.page,[target,method]))&&t.apply(_ns.page[target],iparams)}break;case"other":switch(target){case"url":switch(method){case"close":window.close();break;case"open":xui.Dom.submit(iparams[0],iparams[1],iparams[2],iparams[3]);break;case"mailTo":xui.mailTo.apply(xui,iparams);break;case"selectFile":xui.Dom.selectFile.apply(xui.Dom,iparams);break;case"readText":xui.getFileAsync.apply(xui,iparams);break;case"readJSON":iparams[4]={rspType:"json"},xui.getFileAsync.apply(xui,iparams)}break;case"msg":"busy"==method||"free"==method?xui.isFun(t=xui.get(xui.Dom,[method]))&&t.apply(xui.Dom,iparams):"console"==method&&xui.isDefined(window.console)&&"function"==typeof console.log?console.log.apply(console,iparams):xui.isFun(t=xui.get(xui,[method]))&&t.apply(xui,iparams);break;case"var":if(iparams[0].length){var v=iparams[1];if(iparams[2]&&(v=xui.get(v,xui._s2a(iparams[2]))),adjust)switch(adjust){case"serialize":v=xui.serialize(v);break;case"unserialize":v=xui.unserialize(v);break;case"stringify":v=xui.stringify(v);break;default:"function"==typeof adjust&&(v=adjust(v))}xui.set(_ns,xui._s2a(method+"."+xui.str.trim(iparams[0])),v)}break;case"callback":switch(method){case"setCookies":iparams[0]&&!xui.isEmpty(iparams[0])&&xui.Cookies.set(iparams[0]);break;case"setFI":iparams[0]&&!xui.isEmpty(iparams[0])&&xui.History.setFI(iparams[0],!0,!0);break;case"set":xui.set(_ns,xui._s2a("temp."+xui.str.trim(iparams[0])),iparams[1]);break;case"call":var doit,doit2,y,args=iparams.slice(3);if(t=iparams[0],xui.isStr(t)&&/^\{[\w][\w.]*[\w](\([^)]*\))?\}$/.test(t.replace(/\s/g,"").replace(/\[(\d+)\]/,".$1"))&&(t=t.replace(/\[(\d+)\]/,".$1"),(t=xui._s2a(t)).length>1?m=t.pop().replace(/[()}\s]/g,""):(m=t[0].replace(/[{()}\s]/g,""),t=["{window"]),t=t.join(".")+"}",t=xui.adjustVar(tt=t,_ns),xui.isDefined(t)||(t=xui.adjustVar(tt)),t&&t[m]))if(xui.isFun(t[m]))doit=1;else if((t[m].actions&&xui.isArr(t[m].actions)&&t[m].actions.length||t[m].return)&&(t=t[m],doit2=1,args&&args.length&&t.params&&t.params.length)){i=0;for(var l=args.length;i<l;i++)(y=t.params[i]&&t.params[i].type)&&(args[i]="String"==y?args[i]+"":"Number"==y?parseFloat(args[i])||0:"Boolean"==y?!!args[i]:args[i])}doit?t=t[m].apply(t,args):doit2&&((n=(""+conf.args[0]).split(".functions"))&&2==n.length&&(n=xui.adjustVar(n[0]+"}",_ns)),t=ns._callFunctions(t,args,n||_ns.page,_ns.temp,null,"nested:"+(t.desc||t.id||""),(level||1)+1)),(doit||doit2)&&iparams[1]&&iparams[2]&&xui.get(_ns,xui._s2a(iparams[1]))&&xui.set(_ns,xui._s2a(iparams[1]+"."+iparams[2]),t)}}}};null!==timeout?resetid?xui.resetRun(resetid,fun,timeout):xui.asyRun(fun,timeout):fun()}return conf.return},_callFunctions:function(pseudo,args,module,temp,holder,fromtag,level){temp=temp||{};var fun,t,newbie,funsrtn,ns=this,resume=0,funs=pseudo.actions||pseudo||[],rtn=pseudo.return,newbies=pseudo.newbies,innerE=1==funs.length&&("function"==typeof funs[0]||"string"==typeof funs[0]),_ns=ns.getScope(args,module,temp),recursive=function(data){var irtn;xui.isStr(this)&&(_ns.temp[this+""]=data||"");for(var j=resume,l=funs.length;j<l;j++)if(resume=j+1,fun=funs[j],module&&"string"==typeof fun&&(fun=module[fun]),holder&&"string"==typeof fun&&(fun=holder[fun]),"function"==typeof fun){if(!1===(irtn=xui.tryF(fun,_ns.args,_ns.page))){resume=j;break}}else if(xui.isHash(fun)){if("onOK"in fun||"onKO"in fun){var resumeFun=function(key,args,flag){if(recursive)return xui.isStr(flag)&&(_ns.temp[flag]=!0),recursive.apply(key,args||[])};"onOK"in fun&&((fun.args||fun.params||(fun.args=[]))[parseInt(fun.onOK,10)||0]=function(){resumeFun&&resumeFun("okData",arguments,fun.okFlag)}),"onKO"in fun&&((fun.args||fun.params||(fun.args=[]))[parseInt(fun.onKO,10)||0]=function(){resumeFun&&resumeFun("koData",arguments,fun.koFlag)}),ns.exec(_ns,fun,resumeFun,level);break}if(!1===ns.exec(_ns,fun,null,level)){xui._debugInfo("pseudo",xui.str.repeat("  ",level||1),"The action returns false to stop the follow-up actions!"),resume=j;break}}return resume==j&&(resume=recursive=null),irtn};if(!innerE&&(xui._debugGroup("pseudo",xui.str.repeat("  ",(level||1)-1),'"'+fromtag+'"',{pseudo:pseudo},{scope:_ns}),xui._debugInfo("pseudo",xui.str.repeat("  ",(level||1)-1),"{"),newbies))for(var k in temp.newbies={},newbies)(newbie=xui.create(newbies[k])).setHost&&_ns.page&&newbie.setHost(_ns.page,newbie.getAlias()+"-"+xui.rand()),temp.newbies[k]=newbie;return funsrtn=recursive(),rtn?(rtn=xui.adjustVar(t=rtn,_ns),xui.isDefined(rtn)||(rtn=xui.adjustVar(t))):rtn=funsrtn,innerE||(xui._debugInfo("pseudo",xui.str.repeat("  ",level||1),"return",rtn),xui._debugInfo("pseudo",xui.str.repeat("  ",(level||1)-1),"}"),xui._debugGroupEnd("pseudo",xui.str.repeat("  ",(level||1)-1))),rtn}}},new function(){var M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","/":"\\/","\v":"\\u000b"},H={"@window":"window","@this":"this"},A1=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/:/[\\"\x00-\x1f\x7f-\xff]/,A2=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,D=/^(-\d+|\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,3}))?((?:[+-](\d{2})(\d{2}))|Z)?$/,E=function(t,i,a,v,m,n,p){for(i in t)"string"==(a=typeof(v=t[i]))&&(v=D.exec(v))?(n="Z"!=(m=v[8]&&v[8].charAt(0))?("-"==m?-1:1)*(60*(+v[9]||0))+(+v[10]||0):0,(n+=(m=new Date(+v[1],+v[2]-1,+v[3],+v[4],+v[5],+v[6],+v[7]||0)).getTimezoneOffset())&&m.setTime(m.getTime()+6e4*n),t[i]=m):"object"==a&&t[i]&&(xui.isObj(t[i])||xui.isArr(t[i]))&&E(t[i]);return t},F="function",N="number",L="boolean",S="string",O="object",T={},PS=function(v,n){return("000"+(v||0)).slice(-n)},Z=((a=-(new Date).getTimezoneOffset()/60)>0?"+":"-")+(1==(a=""+Math.abs(a)).length?"0":"")+a+"00",a,safeW;T[void 0]=function(){return"null"},T[L]=function(x){return String(x)},T[N]=function(x){return(x||0===x)&&isFinite(x)?String(x):"null"},T[S]=function(x){return H[x]||'"'+(A1.test(x)?x.replace(A2,(function(a,b){return(b=M[a])?b:"\\u"+((b=a.charCodeAt())<16?"000":b<256?"00":b<4096?"0":"")+b.toString(16)})):x)+'"'},T[O]=function(x,filter,dateformat,deep,max,MAXL,MAXS){var map={prototype:1,constructor:1,toString:1,valueOf:1,toLocaleString:1,propertyIsEnumerable:1,isPrototypeOf:1,hasOwnProperty:1};if(deep=deep||1,max=max||0,MAXL=MAXL||xui.SERIALIZEMAXLAYER,MAXS=MAXS||xui.SERIALIZEMAXSIZE,deep>MAXL||max>MAXS)return xui.$_outofmilimted;if(max++,x){var f,i,l,v,a=[],b=[];if(x===window)return"window";if(x===document)return"document";if(!(typeof x!=O&&typeof x!=F||xui.isFun(x.constructor)))return x.nodeType?"document.getElementById('"+x.id+"')":"$alien";if(xui.isArr(x)){for(a[0]="[",l=x.length,i=0;i<l;++i)"function"==typeof filter&&0==filter.call(x,x[i],i,b)||(xui.isNaN(v=x[i])?b[b.length]="NaN":xui.isNull(v)?b[b.length]="null":xui.isDefined(v)?(f=T[typeof v])&&typeof(v=f(v,filter,dateformat,deep+1,max,MAXL,MAXS))==S&&(b[b.length]=v):b[b.length]="undefined");a[2]="]"}else if(xui.isDate(x))switch(dateformat){case"utc":return'"'+PS(x.getUTCFullYear(),4)+"-"+PS(x.getUTCMonth()+1,2)+"-"+PS(x.getUTCDate(),2)+"T"+PS(x.getUTCHours(),2)+":"+PS(x.getUTCMinutes(),2)+":"+PS(x.getUTCSeconds(),2)+"."+PS(x.getUTCMilliseconds(),3)+'Z"';case"gmt":return'"'+PS(x.getFullYear(),4)+"-"+PS(x.getMonth()+1,2)+"-"+PS(x.getDate(),2)+"T"+PS(x.getHours(),2)+":"+PS(x.getMinutes(),2)+":"+PS(x.getSeconds(),2)+"."+PS(x.getMilliseconds(),3)+Z+'"';case"date":return"new Date("+[x.getFullYear(),x.getMonth(),x.getDate(),x.getHours(),x.getMinutes(),x.getSeconds(),x.getMilliseconds()].join(",")+")";default:return'"'+xui.Date.format(x,dateformat||"yyyy-mm-dd hh:mm:ss")+'"'}else{if(xui.isReg(x))return String(x);if(typeof x.serialize==F&&(x=x.serialize()),typeof x!=O)return String(x);if(x.nodeType)return"document.getElementById('"+x.id+"')";for(i in a[0]="{",x)map[i]||(!0===filter?"_"==i.charAt(0):"function"==typeof filter&&!1===filter.call(x,x[i],i,b))||(xui.isNaN(v=x[i])?b[b.length]=T.string(i)+":NaN":xui.isNull(v)?b[b.length]=T.string(i)+":null":xui.isDefined(v)?(f=T[typeof v])&&typeof(v=f(v,filter,dateformat,deep+1,max,MAXL,MAXS))==S&&(b[b.length]=T.string(i)+":"+v):b[b.length]=T.string(i)+":undefined");a[2]="}"}return a[1]=b.join(", "),a[0]+a[1]+a[2]}return"null"},T[F]=function(x){return x.$path?x.$path:String(x)},xui.$_outofmilimted='"..."',xui.serialize=function(obj,filter,dateformat,MAXL,MAXS){return xui.isNaN(obj)?"NaN":xui.isNull(obj)?"null":xui.isDefined(obj)?T[typeof obj](obj,filter,xui.getDateFormat(dateformat),0,0,MAXL,MAXS)||"":"undefined"},xui.stringify=function(obj,filter,dateformat,MAXL,MAXS){return xui.fromUTF8(xui.serialize(obj,filter,xui.getDateFormat(dateformat),0,0,MAXL,MAXS))},xui.unserialize=function(str,dateformat){if("string"!=typeof str)return str;if(!str)return!1;if(!safeW){var ifr=document.createElement(xui.browser.ie&&xui.browser.ver<9?"<iframe>":"iframe"),w,d;for(var i in document.body.appendChild(ifr),w="contentWindow"in ifr?ifr.contentWindow:"window"in ifr?ifr.window:(d=ifr.contentDocument||ifr.document).defaultView||d.parentWindow,safeW={},w)safeW[i]=null;document.body.removeChild(ifr)}str="({ _ : (function(){ with(this){ return ("+str+"); } }).call(safeW) })";try{str=eval(str)}catch(e){return!1}return xui.getDateFormat(dateformat)&&E(str),str=str._,str}},new function(){xui.id=function(){if(this.constructor!==xui.id||this.a)return(xui.id._||(xui.id._=new xui.id)).next();this.a=[-1],this.b=[""],this.value=""},xui.id.prototype={constructor:xui.id,_chars:"abcdefghijklmnopqrstuvwxyz".split(""),next:function(i){var m,k,l;if(i=i||0===i?i:this.b.length-1,(m=this.a[i])>=25)if(m=0,0===i){for(this.a.splice(0,0,1),this.b.splice(0,0,"a"),l=this.a.length,k=1;k<l;++k)this.a[k]=0,this.b[k]="0";++i}else this.next(i-1);else++m;return this.a[i]=m,this.b[i]=this._chars[m],this.value=this.b.join("")}}},xui.Class("xui.Thread",null,{Constructor:function(id,tasks,delay,callback,onStart,onEnd,cycle){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null;var self=this,me=arguments.callee,t=xui.$cache.thread;if(self.constructor!==me||self.id)return new me(id,tasks,delay,callback,onStart,onEnd,cycle);"string"!=typeof id&&(id="$"+self.constructor.$xid++),self.id=id,self.profile=t[id]||(t[id]={id:id,_start:!1,time:0,_left:0,_asy:.1,index:0,tasks:tasks||[],delay:delay||0,callback:callback,onStart:onStart,onEnd:onEnd,cache:{},status:"ini",cycle:!!cycle,instance:self})},Instance:{_fun:xui.fun(),__gc:function(){var m=xui.$cache.thread,t=m[this.id];if(t)for(var i in delete m[this.id],t.tasks.length=0,t)t[i]=null},_task:function(){var p=this.profile;if(p&&p.status&&p.tasks){p._asy=.1;var r,i,t={},value=p.tasks[p.index],type=typeof value;if("function"==type)t.task=value;else if("object"==type)for(i in value)t[i]=value[i];if("function"!=typeof t.callback&&(t.callback=p.callback),"function"==typeof t.task&&(t.args=t.args||[],t.args=t.args.concat([p.id,p.tasks,p.index])),p.index++,p.time=xui.stamp(),"function"==typeof t.task&&(r=xui.tryF(t.task,t.args||[p.id,p.tasks,p.index],t.scope||this,null)),p.status){if(t.id&&(p.cache[t.id]=r),t.callback&&!1===xui.tryF(t.callback,[p.id,p.tasks,p.index],this,!0))return this.abort("callback");"run"===p.status&&this.start()}}},start:function(time,delaycb){var p=this.profile;if(p.__delaycb&&(xui.tryF(p.__delaycb,[p.id],this),delete p.__delaycb),delaycb&&(p.__delaycb=delaycb),!1===p._start&&(p._start=!0,p.onStart)){var r=xui.tryF(p.onStart,[p.id],this);if(!1===r)return this.abort("start");if(!0===r)return;if(xui.isNumb(r))return void this.suspend(r)}if(p.status="run",!p.tasks.length)return this.abort("empty");if(p.index>=p.tasks.length){if(!0!==p.cycle)return this.abort("normal");this.profile.index=0}var task=p.tasks[p.index],delay="number"==typeof task?task:task&&"number"==typeof task.delay?task.delay:p.delay;return p._left=time||0===time?time:delay,.1!=p._asy&&xui.clearTimeout(p._asy),p._asy=xui.asyRun(this._task,p._left,[],this),p.time=xui.stamp(),this},suspend:function(time,delaycb){var n,p=this.profile;if("pause"!=p.status)return p.status="pause",.1!==p._asy&&(xui.clearTimeout(p._asy),p.index>0&&p.index--),n=p._left-(xui.stamp()-p.time),p._left=n>=0?n:0,Number(time)&&this.resume(time,delaycb),this},resume:function(time,delaycb){var p=this.profile;return"run"==p.status||(time=time===undefined?p._left:!0===time?p.delay:!1===time?0:Number(time)||0,p.status="run",this.start(time,delaycb)),this},abort:function(flag){var p=this.profile;if("stop"!=p.status){p.status="stop";var onEnd=p.onEnd,id=p.id;xui.clearTimeout(p._asy),this.__gc(),xui.tryF(onEnd,[id,flag])}},links:function(thread){var p=this.profile,onEnd=p.onEnd;return p.id,p.onEnd=function(tid,flag){xui.tryF(onEnd,[tid,flag]),thread.start()},this},insert:function(arr,index){var a,o=this.profile.tasks,l=o.length;return xui.isArr(arr)||(arr=[arr]),(index=index||this.profile.index)<0&&(index=-1),-1==index?Array.prototype.push.apply(o,arr):(index>l&&(index=l),a=o.splice(index,l-index),o.push.apply(o,arr),o.push.apply(o,a)),this},getCache:function(key){return this.profile.cache[key]},setCache:function(key,value){return this.profile.cache[key]=value,this},isAlive:function(){return!!xui.$cache.thread[this.id]},getStatus:function(){return this.profile.status}},After:function(){for(var self=this,f=function(i){self[i]=function(id){var t;if(xui.$cache.thread[id])return(t=xui.Thread(id))[i].apply(t,Array.prototype.slice.call(arguments,1))}},a="start,suspend,resume,abort,links,insert,isAlive,getStatus".split(","),i=0,l=a.length;i<l;i++)f(a[i])},Static:{$asFunction:1,$xid:1,__gc:function(){xui.$cache.thread={}},get:function(id){return(id=xui.$cache.thread[id])&&id.instance},isAlive:function(id){return!!xui.$cache.thread[id]},observableRun:function(tasks,onEnd,threadid,busyMsg){var thread=xui.Thread,dom=xui.Dom;xui.isArr(tasks)||(tasks=[tasks]),xui.$cache.thread[threadid]?("function"==typeof onEnd&&tasks.push(onEnd),thread.insert(threadid,tasks)):thread(threadid,tasks,0,null,(function(threadid){dom&&dom.busy(threadid,busyMsg)}),(function(threadid){xui.tryF(onEnd,arguments,this),dom&&dom.free(threadid)})).start()},group:function(id,group,callback,onStart,onEnd){var bak={},thread=xui.Thread,f=function(o,i,threadid){if("string"==typeof o&&(o=thread(o)),o){var f=function(){var me=arguments.callee;xui.tryF(me.onEnd,arguments,this),me.onEnd=null,delete bak[i],xui.tryF(callback,[i,threadid],this),xui.isEmpty(bak)&&thread.resume(threadid)};f.onEnd=o.profile.onEnd,o.profile.onEnd=f,o.start()}};for(var i in group)bak[i]=1;return thread(id,[function(threadid){if(!xui.isEmpty(group))for(var i in thread.suspend(threadid),group)f(group[i],i,threadid)}],0,null,onStart,onEnd)},repeat:function(task,interval,onStart,onEnd){return xui.Thread(null,[null],interval||0,task,onStart,onEnd,!0).start()}}}),xui.Class("xui.absIO",null,{Constructor:function(uri,query,onSuccess,onFail,threadid,options){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,"object"==typeof uri?options=uri:(options=options||{},xui.merge(options,{uri:uri,query:query,onSuccess:onSuccess,onFail:onFail,threadid:threadid}));var self=this,me=arguments.callee,con=self.constructor;if(con!==me||self.id)return new me(options);xui.merge(options,{id:options.id||""+con._id++,uid:""+con.uid++,uri:options.uri?xui.adjustRes(options.uri,0,1,1):"",username:options.username||undefined,password:options.password||undefined,query:options.query||"",contentType:options.contentType||"",Accept:options.Accept||"",header:options.header||null,asy:!1!==options.asy,scriptType:options.scriptType},"all");var m=(options.method||con.method).toUpperCase();options.method="POST"==m?"POST":"PUT"==m?"PUT":"DELETE"==m?"DELETE":"PATCH"==m?"PATCH":"GET";for(var a="retry,timeout,reqType,rspType,optimized,customQS".split(","),i=0,l=a.length;i<l;i++)options[a[i]]=a[i]in options?options[a[i]]:con[a[i]],"string"==typeof options[a[i]]&&(options[a[i]]=options[a[i]].toLowerCase());return xui.merge(self,options,"all"),"xml"==self.reqType&&(self.method="POST"),con.events&&xui.merge(self,con.events),self.query=self.customQS(self.query,options&&options.exData),"object"==typeof self.query&&"xml"!=self.reqType&&(self.query=xui.copy(self.query,(function(o){return o!==undefined}))),!self._useForm&&xui.isHash(self.query)&&"xml"!=self.reqType&&(self.query=con._buildQS(self.query,"json"==self.reqType,"POST"==self.method)),self},Instance:{_fun:xui.fun(),_flag:0,_response:!1,_txtresponse:"",_retryNo:0,_time:function(){this.constructor,this._clear(),this._retryNo<this.retry?(this._retryNo++,xui.tryF(this.onRetry,[this._retryNo],this),this.start()):!1!==xui.tryF(this.onTimeout,[],this)&&this._onError(new Error("Request timeout"))},_onEnd:function(){this._end||(this._end=!0,this._flag>0&&(xui.clearTimeout(this._flag),this._flag=0),xui.Thread.resume(this.threadid),xui.tryF(this.$onEnd,[],this),xui.tryF(this.onEnd,[],this),this._clear())},_onStart:function(){xui.Thread.suspend(this.threadid),xui.tryF(this.$onStart,[],this),xui.tryF(this.onStart,[],this)},_onResponse:function(){!1!==xui.tryF(this.beforeSuccess,[this._response,this.rspType,this.threadid],this)&&xui.tryF(this.onSuccess,[this._response,this.rspType,this.threadid],this),this._onEnd()},_onError:function(e){!1!==xui.tryF(this.beforeFail,[e,this.threadid],this)&&xui.tryF(this.onFail,[e,this.rspType,this.threadid,e],this),this._onEnd()},isAlive:function(){return!this._end},abort:function(){this._onEnd()}},Static:{$abstract:!0,get:function(uri,query,onSuccess,onFail,threadid,options){return(options=options||{}).method="GET",this.apply(this,arguments).start()},post:function(uri,query,onSuccess,onFail,threadid,options){return(options=options||{}).method="POST",this.apply(this,arguments).start()},_id:1,uid:1,method:"GET",retry:0,timeout:6e4,reqType:"form",rspType:"json",optimized:!1,callback:"callback",_buildQS:function(hash,flag,post){return hash=xui.clone(hash,(function(o,i){return!(xui.isNaN(o)||!xui.isDefined(o))})),flag?(flag=xui.serialize(hash))&&(post?flag:encodeURIComponent(flag)):xui.urlEncode(hash)},customQS:function(obj,ex){return ex&&("string"==typeof obj?obj=(obj||"")+"&"+xui.urlEncode(ex):xui.merge(obj,ex,"all")),obj},_if:function(doc,id,onLoad){var w,d,ie8=xui.browser.ie&&xui.browser.ver<9,scr=ie8?"<iframe "+(id?"name='xui_xdmi:"+id+"'":"")+(onLoad?" onload='xui.XDMI._o(\""+id+"\")'":"")+">":"iframe",ifr=doc.createElement(scr);return id&&(ifr.id=ifr.name="xui_xdmi:"+id),!ie8&&onLoad&&(ifr.onload=onLoad),ifr.style.display="none",doc.body.appendChild(ifr),[ifr,w="contentWindow"in ifr?ifr.contentWindow:"window"in ifr?ifr.window:(d=ifr.contentDocument||ifr.document).defaultView||d.parentWindow,w.document]},isCrossDomain:function(uri){var b=xui._localParts;uri=uri.replace(/#.*$/,"").replace(/^\/\//,b[1]+"//");var a=xui._uriReg.exec((uri||"").toLowerCase());return!(!a||a[1]===b[1]&&a[2]===b[2]&&(a[3]||("http:"===a[1]?80:443))===(b[3]||("http:"===b[1]?80:443)))},groupCall:function(hash,callback,onStart,onEnd,threadid){var i,f=function(o,i,hash){hash[i]=xui.Thread(null,[function(threadid){o.threadid=threadid,o.start()}])};for(i in hash)f(hash[i],i,hash);return xui.Thread.group(null,hash,callback,(function(){xui.Thread.suspend(threadid),xui.tryF(onStart,arguments,this)}),(function(){xui.tryF(onEnd,arguments,this),xui.Thread.resume(threadid)})).start()}}}),xui.Class("xui.Ajax","xui.absIO",{Instance:{_XML:null,_unsafeHeader:"Accept-Charset,Accept-Encoding,Access-Control-Request-Headers,Access-Control-Request-Method,Connection,Content-Length,Cookie,Cookie2,Date,DNT,Expect,Host,Keep-Alive,Origin,Referer,TE,Trailer,Transfer-Encoding,Upgrade,User-Agent,Via".toLowerCase().split(","),_isunsafe:function(k){return xui.browser.isWebKit&&(xui.str.startWith("Proxy-",k)||xui.str.startWith("Sec-",k)||-1!==xui.arr.indexOf(this._unsafeHeader,k.toLowerCase()))},_header:function(n,v){this._isunsafe(n)||this._XML&&this._XML.setRequestHeader(n,v)},start:function(){var self=this;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart();try{if(self._XML=new window.XMLHttpRequest,self.asy&&(self._XML.onreadystatechange=function(){self&&self._XML&&4==self._XML.readyState&&(self._complete.apply(self),self._clear())}),self._retryNo||"POST"==self.method||(self.query&&(self.uri=self.uri.split("#")[0].split("?")[0]+"?"+self.query),self.query=null),self.username&&self.password?self._XML.open(self.method,self.uri,self.asy,self.username,self.password):self._XML.open(self.method,self.uri,self.asy),self._header("Accept",self.Accept?self.Accept:"json"==self.rspType?"application/json,text/javascript,*/*;q=0.01":"xml"==self.rspType?"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8":"*/*"),!xui.absIO.isCrossDomain(self.uri)&&(self._header("Content-type",self.contentType?self.contentType:("xml"==self.reqType?"text/xml; ":"json"==self.reqType?"application/json; ":"POST"==self.method?"application/x-www-form-urlencoded; ":"")+"charset="+(self.charset||"UTF-8")),self._header("X-Requested-With","XMLHttpRequest"),self.optimized))try{self._header("User-Agent",null),self._header("Accept-Language",null),self._header("Connection","keep-alive"),self._header("Keep-Alive",null),self._header("Cookie",null),self._header("Cookie","")}catch(e){}try{xui.isHash(self.header)&&xui.each(self.header,(function(o,i){self._header(i,o)}))}catch(e$5){}if(!1===xui.tryF(self.beforeSend,[self._XML],self))return void self._onEnd();try{self._XML.send(self.query)}catch(e$6){}if(!self.asy)return self._complete();self._XML&&self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}catch(e$7){self._onError(e$7)}return self}self._onEnd()},abort:function(){var self=this;self._XML&&(self._XML.onreadystatechange=self._fun,self._XML.abort(),self._XML=null),arguments.callee.upper.call(self)},_clear:function(){this._XML&&(this._XML.onreadystatechange=this._fun,this._XML=null)},_complete:function(){var obj,ns=this,status=ns._XML.status;return ns._txtresponse="xml"==ns.rspType?ns._XML.responseXML:ns._XML.responseText,ns._response="json"==ns.rspType?/^\s*</.test(ns._txtresponse)&&(obj=xui.XML.xml2json(xui.XML.parseXML(ns._txtresponse)))&&obj.data?obj.data:!1===(obj=xui.unserialize(ns._txtresponse))?ns._txtresponse:obj:ns._txtresponse,!status&&xui._localReg.test(xui._localParts[1])&&(status=ns._XML.responseText?200:404),1223==status&&(status=204),status>=200&&status<300||304==status?ns._onResponse():status===undefined||status<10?ns._onError(new Error("Network problems--"+status)):ns._onError(new Error("XMLHTTP returns--"+status)),ns._response}},Static:{$asFunction:1}}),xui.Class("xui.JSONP","xui.absIO",{Instance:{start:function(){var id,n,self=this,c=self.constructor,ok=!1;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart(),"script"==self.rspType&&(self.retry=0),id=self.id,c._pool[id]?c._pool[id].push(self):c._pool[id]=[self],c.No["_"+id]=function(rsp){c.$response(rsp,id)};var w=document,_cb=function(){ok||(ok=!0,"script"==self.rspType?"string"==typeof self.checkKey?xui.setTimeout((function(){xui.exec("!function(t){if(t=xui.get(xui.JSONP,['_pool','"+id+"',0])) {if(xui.SC.get('"+self.checkKey+"'))t._onResponse();else t._loaded();}}()")}),!1):self._onResponse():self._loaded())};n=self.node=w.createElement("script");var uri=self.uri;self.query&&(uri=uri.split("#")[0].split("?")[0]+"?"+self.query),n.src=uri,n.type=self.scriptType||"text/javascript",n.charset=self.charset||"UTF-8",self.attrs&&xui.each(self.attrs,(function(o,i){n.setAttribute(i,o)})),n.onload=n.onreadystatechange=function(){if(!ok){var t=this.readyState;t&&"loaded"!=t&&"complete"!=t||_cb(),"interactive"==t&&xui.browser.opr&&xui.Thread.repeat((function(){return!ok&&(/loaded|complete/.test(document.readyState)?(_cb(),!1):void 0)}),50)}},"onerror"in n&&(n.onerror=function(e){self._clear(),self._onError(new Error("Not Found - "+uri)),self=null}),(self.keepDomNode?w.getElementsByTagName("head")[0]:w.body).appendChild(n),n=null,self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}else self._onEnd()},_clear:function(){var n=this.node,c=this.constructor,id=this.id,_pool=c._pool;if(_pool[id]&&(_pool[id].length=0,delete _pool[id]),delete c.No["_"+id],n){if(this.node=n.onload=n.onreadystatechange=n.onerror=null,!this.keepDomNode){var div=document.createElement("div");div.appendChild(n.parentNode&&n.parentNode.removeChild(n)||n),xui.browser.ie?xui.asyRun((function(){div.innerHTML=n.outerHTML="",xui.isEmpty(_pool)&&(c._id=1),_pool=c=n=div=null})):xui.asyRun((function(){div.innerHTML="",n=div=null,xui.isEmpty(_pool)&&(c._id=1)}))}}else xui.isEmpty(_pool)&&(c._id=1)},_loaded:function(){var self=this;xui.asyRun((function(){self.id&&self.constructor._pool[self.id]&&self._onError(new Error("JSONP return script doesn't match"))}),500)}},Static:{$asFunction:1,_pool:{},No:{},$response:function(obj,id){var o;if(obj&&(o=this._pool[id]))for(var i=0,l=o.length;i<l;i++)o[i]._response=obj,o[i]._onResponse();else this._onError(new Error("JSONP return value formatting error--"+obj))},customQS:function(obj,ex){var b=this.constructor.callback,nr="script"!=this.rspType;return"string"==typeof obj?(obj=(obj||"")+(nr?"&"+b+"=xui.JSONP.No._"+this.id:""),ex&&(obj=(obj||"")+(nr?"&"+xui.urlEncode(ex):""))):nr&&(obj[b]="xui.JSONP.No._"+this.id,ex&&xui.merge(obj,ex,"all")),obj}}}),xui.Class("xui.XDMI","xui.absIO",{Instance:{_useForm:!0,start:function(){var i,id,t,k,b,form,onload,self=this,w=window,c=self.constructor;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart(),id=self.id,c._pool[id]?c._pool[id].push(self):c._pool[id]=[self];var a=c._if(document,id,onload);self.node=a[0],self.frm=a[1],(form=self.form=document.createElement("form")).style.display="none",w.postMessage?(self._msgcb=function(e){if(self.node&&e.source===self.frm)if(e=e.data,"json"==self.rspType&&(e=xui.unserialize(e)||e),e&&(t=c._pool[self.id]))for(var i=0,l=t.length;i<l;i++)t[i]._response=e,t[i]._onResponse();else self._clear(),self._onError(new Error("XDMI return value formatting error"))},w.addEventListener?w.addEventListener("message",self._msgcb,!1):w.attachEvent("onmessage",self._msgcb)):self._onload=onload=function(id){if(!self.OK&&self.node){var o,t,w=self.node.contentWindow,c=xui.XDMI;if(xui.browser.opr)try{if("about:blank"==w.location)return}catch(e){}self.OK=1;var flag=0;try{w.name===undefined&&(flag=1)}catch(e$8){flag=1}flag&&w.location.replace(c._getDummy()+"#"+xui.ini.dummy_tag);var getData=function(){var data,flag=0;try{w.name===undefined&&(flag=1)}catch(e$9){flag=1}if(flag)return xui.asyRun(getData);if("xui_xdmi:"+self.id==w.name)return self._clear(),void self._onError(new Error("XDMI no return value"));if((data=w.name)&&(o=xui.unserialize(data))&&(t=c._pool[self.id]))for(var i=0,l=t.length;i<l;i++)t[i]._response=o,t[i]._onResponse();else self._clear(),self._onError(new Error("XDMI return value formatting error, or no matched 'id'-- "+data))};getData()}};var uri=self.uri;"POST"!=self.method&&(uri=uri.split("#")[0].split("?")[0]),form.action=self.uri,form.method=self.method,form.target="xui_xdmi:"+id,k=self.query||{};var file,files=[];for(i in k)k[i]&&k[i]["xui.UIProfile"]&&k[i].$xuiFileCtrl?(file=k[i].boxing().getUploadObj())&&(files.push({id:k[i].$xid,file:file}),file.id=file.name=i,form.appendChild(file),b=!0):k[i]&&1==k[i].nodeType?(k[i].id=k[i].name=i,form.appendChild(k[i]),b=!0):xui.isDefined(k[i])&&((t=document.createElement("textarea")).id=t.name=i,t.value="string"==typeof k[i]?k[i]:xui.serialize(k[i],(function(o){return o!==undefined})),form.appendChild(t));"POST"==self.method&&b&&(form.enctype="multipart/form-data",form.encoding&&(form.encoding=form.enctype)),document.body.appendChild(form),form.submit(),files.length&&xui.arr.each(files,(function(o,i){(i=xui.getObject(o.id))&&i["xui.UIProfile"]&&i.boxing()&&i.boxing().setUploadObj&&i.boxing().setUploadObj(o.file)})),t=form=null,self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}else self._onEnd()},_clear:function(){var n=this.node,f=this.form,c=this.constructor,w=window,div=document.createElement("div"),id=this.id,_pool=c._pool;if(_pool[id]&&(_pool[id].length=0,delete _pool[id]),n&&w.postMessage)w.removeEventListener?w.removeEventListener("message",this._msgcb,!1):w.detachEvent("onmessage",this._msgcb),this._msgcb=null;else if(xui.browser.gek&&n)try{n.onload=null;var d=n.contentWindow.document;d.write(" "),d.close()}catch(e){}this.form=this.node=this.frm=null,n&&div.appendChild(n.parentNode.removeChild(n)),f&&div.appendChild(f.parentNode.removeChild(f)),div.innerHTML="",xui.isEmpty(_pool)&&(c._id=1),f=div=null}},Static:{$asFunction:1,method:"POST",_pool:{},_o:function(id){var p=this._pool[id],o=p[p.length-1];xui.tryF(o._onload)},_getDummy:function(win){var arr,o,ns=this,d=(win=win||window).document,ini=xui.ini,b=xui.browser,f=ns.isCrossDomain;if(ns.dummy)return ns.dummy;if(ini.dummy)return ns.dummy=ini.dummy;if(f(ini.path)||d.getElementById("xui:img:bg")||((o=d.createElement("img")).id="xui:img:bg",o.src=ini.img_bg,o.style.display="none",d.body.appendChild(o),o=null),o=d.getElementById("xui:img:bg"))return ns.dummy=o.src.split("#")[0];for(var i=0,j=(arr=d.getElementsByTagName("img")).length;i<j;i++)if((o=arr[i]).src&&!f(o.src))return ns.dummy=o.src.split("#")[0];if(b.gek)for(i=0,j=(arr=d.getElementsByTagName("link")).length;i<j;i++)if("stylesheet"==(o=arr[i]).rel&&!f(o.href))return ns.dummy=o.href.split("#")[0];try{if(win!=win.parent&&(win=win.parent)&&!f(""+win.document.location.href))return ns._getDummy(win)}catch(e){}return"/favicon.ico"},customQS:function(obj,ex){var t=this.constructor.callback,w=window;return w.postMessage?obj[t]=obj.parentDomain=w.location.origin||w.location.protocol+"//"+w.location.hostname+(w.location.port?":"+w.location.port:""):obj[t]="window.name",ex&&xui.merge(obj,ex,"all"),obj}}}),new function(){xui.SAjax=xui.JSONP,xui.IAjax=xui.XDMI},xui.Class("xui.SC",null,{Constructor:function(path,callback,isAsy,threadid,options,force){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null;var r,p=xui.$cache.SC;return(r=p[path]||(p[path]=xui.get(xui.window,path.split("."))))?xui.tryF(callback,[path,null,threadid],r):((options=options||{}).$cb=callback,isAsy&&(options.threadid=threadid),r=p[path]=xui.SC._call(path||"",options,isAsy,force)),r},Static:{$asFunction:1,__gc:function(k){xui.$cache.SC={}},beforeGetScript:function(path,onSucess,onFail){},get:function(path,obj1,obj2,v){if("string"==typeof path)return path=xui._s2a(path),obj1&&(v=xui.get(obj1,path)),obj2&&v===undefined&&(v=xui.get(obj2,path)),v===undefined&&(v=xui.get(xui.window,path)),v},_call:function(s,options,isAsy,force){isAsy=!!isAsy;var t,r,o,ajax,ep=xui.SC.get,ct=xui.$cache.snipScript,f=function(text,rspType,threadid){var t,uri=this.uri;if(text&&!ep(s))if(this.$p)(this.$cache||ct)[this.$tag]=text;else try{xui.exec(text,s)}catch(e){xui.asyRun((function(){throw e}))}t=xui.Class._last,xui.Class._ignoreNSCache=xui.Class._last=null,xui.tryF(this.$cb,[this.$tag,text,threadid],ep(s)||t||{}),!ep(s)&&t&&t.KEY!=s&&xui.log("[xui] > '"+s+"' doesn't in '"+uri+"'. The last class '"+t.KEY+"' was triggered.")},fe=function(text,rspType,threadid){xui.tryF(this.$cb,[null,null,this.threadid],this)};return force||!(r=ep(s))?(!force&&(t=ct[s])&&(isAsy=!1,f.call({$cb:options.$cb},t),delete ct[s]),(force||!(r=ep(s)))&&(options=options||{},o=xui.getPath(s,".js","js",options),options.$tag=s,xui.Class._ignoreNSCache=1,xui.Class._last=null,isAsy&&!options.$p?(options.rspType="script",ajax=xui.JSONP):(options.asy=isAsy,ajax=xui.Ajax),!1!==xui.SC.beforeGetScript(o,f,fe)&&ajax(o,xui._rnd(options.force),f,fe,null,options).start(),isAsy||(r=ep(s)))):options.$cb&&f.call(options),r},loadSnips:function(pathArr,cache,callback,onEnd,threadid,options,isAsy){if(pathArr&&pathArr.length){var s,bak={};options=xui.merge(options||{},{$p:1,$cache:cache||xui.$cache.snipScript});for(var i=0,l=pathArr.length;i<l;i++)bak[pathArr[i]]=1;for((callback||onEnd)&&(options.$cb=function(path){callback&&xui.tryF(callback,arguments,this),delete bak[path||this.$tag],xui.isEmpty(bak)&&(xui.tryF(onEnd,[threadid]),onEnd=null,xui.Thread.resume(threadid))}),xui.Thread.suspend(threadid),i=0;s=pathArr[i++];)this._call(s,xui.merge({$tag:s},options,isAsy),!0)}else xui.tryF(onEnd,[threadid])},runInBG:function(pathArr,callback,onStart,onEnd){var j,t,i=0,self=this;xui.Thread(null,[function(threadid){for(;pathArr.length>i&&(t=self.get(j=pathArr[i++])););t||self._call(j,{threadid:threadid},!0),pathArr.length<i&&xui.Thread.abort(threadid),pathArr.length==i&&i++}],1e3,callback,onStart,onEnd,!0).start()},execSnips:function(cache){var i,h=cache||xui.$cache.snipScript;for(i in h)try{xui.exec(h[i],i)}catch(e){xui.asyRun((function(){throw e}))}h={}},groupCall:function(pathArr,onEnd,callback,threadid,options,isAsy){if(pathArr){var self=this;self.execSnips(),xui.Thread.suspend(threadid),self.loadSnips(pathArr,0,callback,(function(){self.execSnips(),xui.tryF(onEnd,[threadid]),onEnd=null,xui.Thread.resume(threadid)}),null,options,isAsy)}else xui.tryF(onEnd,[threadid])}}}),xui.Class("xui.absBox",null,{Constructor:function(){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,this._nodes=[],this.Class=this.constructor},Before:function(key){var t=xui.absBox;t&&((t=t.$type)[key.replace("xui.","")]=t[key]=key)},Instance:{__gc:function(){this.each((function(profile){xui.tryF(profile.__gc)})),this._nodes=0},_get:function(index){var t=this._nodes;return xui.isNumb(index)?t[index]:t},_empty:function(){return this._nodes.length=0,this},getProfile:function(all){return all?this._nodes:this._nodes[0]},get:function(index){return this._get(index)},size:function(){return this._nodes.length},_each:function(fun,scope,desc){var i,n,j=this._nodes,l=j.length;if(desc)for(i=l;i>=0&&(!(n=j[i])||!1!==fun.call(scope||this,n,i));i--);else for(i=0;i<l&&(!(n=j[i])||!1!==fun.call(scope||this,n,i));i++);return n=null,this},each:function(fun,scope,desc){return this._each(fun,scope,desc)},isEmpty:function(){return!this._nodes.length},merge:function(obj){if(this==xui.win||this==xui.doc||this==xui("body")||this==xui("html"))return this;var t,c=this.constructor,i=0,n=this._nodes;if((obj=obj._nodes).length){for(;t=obj[i++];)n[n.length]=t;this._nodes=c._unique(n)}return this},reBoxing:function(key,ensureValue){var t=xui.absBox.$type[key||"Dom"];return t?t==this.KEY?this:(t=xui.SC(t))?t.pack(this._nodes,ensureValue):void 0:xui.UI.pack([])}},Static:{$abstract:!0,$type:{},pack:function(arr,ensureValue){var o=new this(!1);return o._nodes=arr?!1===ensureValue?xui.isArr(arr)?arr:[arr]:"function"==typeof this._ensureValues?this._ensureValues(arr):xui.isArr(arr)?arr:[arr]:[],o.n0=o._nodes[0],o},_unique:function(arr){for(var t,k,h={},a=[],i=0,l=arr.length;i<l;i++)a[i]=arr[i];for(arr.length=0,i=0;t=a[i++];)h[k="string"==typeof t?t:t.$xid]||(h[k]=1,arr.push(t));return arr},plugIn:function(name,fun){return this.prototype[name]=fun,this}}}),xui.Class("xui.absProfile",null,{Constructor:function(){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,this.$xid||(this.$xid=xui.absProfile.$xid.next())},Instance:{getId:function(){return this.$xid},getUid:function(ext){return this.key+":"+this.$xid+(ext?":"+ext:"")},link:function(obj,id,target,index){return xui.absProfile.prototype.$link(this,obj,id,target,index)},$link:function(self,obj,id,target,index){var uid="$"+self.$xid;return target=target||self,obj[uid]&&self.unLink(id),obj[uid]=target,xui.isArr(obj)&&xui.arr.insertAny(obj,target,index,!0),self._links[id]=obj,self},unLink:function(id){return xui.absProfile.prototype.$unLink(this,id)},$unLink:function(self,id){var o,index,uid="$"+self.$xid;if(self._links&&(o=self._links[id]))return xui.isArr(o)&&-1!=(index=xui.arr.indexOf(o,o[uid]))&&xui.arr.removeFrom(o,index),delete o[uid],delete self._links[id],index},unLinkAll:function(){return xui.absProfile.prototype.$unLinkAll(this)},$unLinkAll:function(self){var o,i,id="$"+self.$xid,l=self._links;for(i in l)o=l[i],xui.isArr(o)&&xui.arr.removeValue(o,o[id]),delete o[id];return self._links={},self},getModule:function(top){var t,getUpperModule=function(module){if(module.moduleClass&&module.moduleXid){var pm=xui.SC.get(module.moduleClass);if(pm&&(pm=pm.getInstance(module.moduleXid)))return getUpperModule(pm)}return module};if(this.moduleClass&&this.moduleXid&&(t=xui.SC.get(this.moduleClass))&&(t=t.getInstance(this.moduleXid)))return top?getUpperModule(t):t},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{$xid:new xui.id,$abstract:!0}}),xui.Class("xui.Profile","xui.absProfile",{Constructor:function(host,key,alias,box,properties,events,options){var upper=arguments.callee.upper,args=xui.toArr(arguments);upper.apply(this,args),upper=null;var self=this;xui.merge(self,options),self.key=key||self.key||"",self.alias=alias||self.alias||"",self.properties=properties?xui.copy(properties):self.properties||{},self.events=events?xui.copy(events):self.events||{},self.host=host||self.host||self,self.Class=self.constructor,self.box=box||self.box,self.events&&(self.setEvents(self.events),delete self.events),self._links={}},Instance:{setEvents:function(key,value){var evs=this.box.$EventHandlers;if(xui.isHash(key))return xui.merge(this,key,"all",(function(o,i){return evs[i]}));evs[key]&&(this[key]=value)},getEvents:function(key){if(key)return this[key];var self=this,hash={};return xui.each(self.box.$EventHandlers,(function(o,i){self[i]&&(hash[i]=self[i])})),hash},getProperties:function(key){var prop=this.properties;return xui.isFun(this._propGetter)&&(prop=this._propGetter(prop)),xui.isFun(this.propGetter)&&(prop=this.propGetter(prop)),key?prop[key]:xui.copy(prop)},setProperties:function(key,value){xui.isHash(key)?(xui.merge(key,this.box.$DataStruct,(function(o,i){i in key||(key[i]=xui.isObj(o)?xui.clone(o):o)})),this.properties=key,xui.isFun(this._propSetAction)&&this._propSetAction(key),xui.isFun(this.propSetAction)&&this.propSetAction(key)):this.properties[key]=value},_applySetAction:function(fun,value,ovalue,force,tag,tag2){return fun.call(this,value,ovalue,force,tag,tag2)},__gc:function(){var o,ns=this,args=xui.toArr(arguments);ns.$beforeDestroy&&(xui.each(ns.$beforeDestroy,(function(f){xui.tryF(f,args,ns)})),delete ns.$beforeDestroy),xui.tryF(ns.$ondestory,args,ns),ns.onDestroy&&ns.boxing().onDestroy(),ns.destroyTrigger&&ns.destroyTrigger(),ns.alias&&ns.host&&(o=ns.host[ns.alias])&&(o=o._nodes)&&(0===o.length||1===o.length&&o[0]==ns)&&delete ns.host[ns.alias],ns.unLinkAll(),xui.tryF(ns.clearCache,[],ns),ns.destroyed=!0,ns.$afterDestroy&&(xui.each(ns.$afterDestroy,(function(f){xui.tryF(f,args,ns)})),delete ns.$afterDestroy),ns.afterDestroy&&ns.boxing().afterDestroy(ns),xui.breakO([ns.properties,ns.events,ns],2),ns.destroyed=!0},boxing:function(){var t;return this.box?((t=this.Instace)&&t.get(0)==this&&1==t._nodes.length||(t=this.Instace=this.box.pack([this],!1)),t):null},serialize:function(rtnString,keepHost){var t,o=(t=this.box._beforeSerialized)?t(this):this,r={alias:o.alias,key:o.key,host:o.host};r.host===this?delete r.host:o.host&&!keepHost&&(!1!==rtnString?r.host="@this":delete r.host);var c={},p=o.box.$DataStruct,map=xui.absObj.$specialChars;xui.merge(c,o.properties,(function(o,i){return i in p&&p[i]!==o&&!map[i.charAt(0)]})),xui.isEmpty(c)||(r.properties=c),xui.isEmpty(t=this.getEvents())||(r.events=t);var eh=o.box.$EventHandlers;return xui.filter(r.events,(function(o,i){return o!=eh[i]})),xui.isEmpty(r.events)&&delete r.events,!1===rtnString?r:xui.serialize(r)}}}),xui.Class("xui.absObj","xui.absBox",{Constructor:function(){var upper=arguments.callee.upper,args=xui.toArr(arguments);if(upper.apply(this,args),upper=null,!1!==args[0]&&"function"==typeof this._ini)return this._ini.apply(this,args)},Before:function(key,parent_key,o){return xui.absBox.$type[key]=key,!0},After:function(){var temp,t,k,u,m,i,j,l,v,self=this,me=arguments.callee;for(self._nameId=0,self._nameTag=self.$nameTag||self.KEY.replace(/\./g,"_").toLowerCase(),self._cache=[],m=me.a1||(me.a1=xui.toArr("$Keys,$DataStruct,$EventHandlers,$DataModel")),j=0;v=m[j++];){if(k={},(t=self.$parent)&&(i=t.length))for(;i--;)xui.merge(k,t[i][v]);self[v]=k}for(self.setDataModel(self.DataModel),delete self.DataModel,self.setEventHandlers(self.EventHandlers),delete self.EventHandlers,m=me.a5||(me.a5=xui.toArr("RenderTrigger,LayoutTrigger")),j=0;v=m[j++];){if(temp=[],(t=self.$parent)&&(l=t.length))for(i=0;i<l;i++)(u=(u=t[i])["$"+v])&&temp.push.apply(temp,u);self[v]&&temp.push(self[v]),xui.arr.stableSort(temp,(function(x,y){return(x=x.$order||0)>(y=y.$order||0)?1:x==y?0:-1})),self["$"+v]=temp,delete self[v]}},Static:{$abstract:!0,$specialChars:{_:1,$:1},DataModel:{name:"",desc:"",tag:"",tagVar:{ini:{},action:function(){var r=this.properties.renderer;r&&/^\s*[a-zA-Z]+([\w]+\.?)+[\w]+\s*$/.test(r)&&this.boxing().refresh()}},propBinder:{hidden:1,ini:{}},dataBinder:{ini:"",set:function(value){var p=this.properties,ovalue=p.dataBinder;ovalue&&xui.DataBinder._unBind(ovalue,this),p.dataBinder=value,xui.DataBinder._bind(value,this)}},dataField:{ini:""}},get:function(index){return this.pack([this._cache[index||0]])},getAll:function(){return this.pack(this._cache)},pickAlias:function(){return xui.absObj.$pickAlias(this)},$pickAlias:function(cls){for(var t,a=cls._nameTag,p=cls._cache;t=a+ ++cls._nameId;){for(var i=0,l=p.length;i<l;i++)if(p[i].alias===t){t=-1;break}if(-1!=t)return t}},setDataModel:function(hash){var i,j,t,o,n,m,r,self=this,sc=xui.absObj.$specialChars,ds=self.$DataStruct,dm=self.$DataModel,ps=self.prototype;for(i in hash)if(dm[i]||(dm[i]={}),null===(o=hash[i])||undefined===o)r=xui.str.initial(i),delete ds[i],delete dm[i],ps[j="get"+r]&&ps[j].$auto$&&delete ps[j],ps[j="set"+r]&&ps[j].$auto$&&delete ps[j];else{for(j in"object"==typeof o&&o.constructor==Object||(o={ini:o}),ds[i]="ini"in o?o.ini:i in ds?ds[i]:"",t=dm[i])j in o||(o[j]=t[j]);dm[i]=o}return xui.each(hash,(function(o,i){if(null!==o&&undefined!==o&&!sc[i.charAt(0)]){if(r=xui.str.initial(i),n="set"+r,null===o.set||o&&(o.readonly||o.inner))delete ps[n];else{var $set=o.set;m=ps[n],ps[n]="function"!=typeof $set&&"function"==typeof m?m:xui.Class._fun((function(value,force,tag,tag2){return this.each((function(v){var t;if(v.properties&&(force||dm[i]&&dm[i].$spaceunit&&v.$forceu&&"auto"!=value&&(t=xui.$us(v),value=v.$forceu(value,2==t?"em":-2==t?"px":null)),(v.properties[i]!==value||force)&&(!v.$beforePropSet||!1!==v.$beforePropSet(i,value,force,tag,tag2)))){var ovalue=v.properties[i];if(!v.beforePropertyChanged||!1!==v.boxing().beforePropertyChanged(v,i,value,ovalue)){if("function"==typeof $set)$set.call(v,value,force,tag,tag2);else{var m=xui.get(v.box.$DataModel,[i,"action"]);v.properties[i]=value,"function"==typeof m&&!1===v._applySetAction(m,value,ovalue,force,tag,tag2)&&(v.properties[i]=ovalue)}v.afterPropertyChanged&&v.boxing().afterPropertyChanged(v,i,value,ovalue),v.$afterPropertyChanged&&xui.tryF(v.$afterPropertyChanged,[v,i,value,ovalue],v)}}}))}),n,self.KEY,null,"instance"),ps[n]!==m&&(ps[n].$auto$=1)}if(n="get"+r,o&&o.inner)delete ps[n];else{var $get=o.get;m=ps[n],ps[n]="function"!=typeof $get&&"function"==typeof m?m:xui.Class._fun((function(){var t=this.get(0),args=xui.toArr(arguments),_get=function(){return"function"==typeof $get?$get.apply(t,args):t.properties[i]};return"function"==typeof t.$beforePropGet?t.$beforePropGet(i,_get):_get()}),n,self.KEY,null,"instance"),ps[n]!==m&&(ps[n].$auto$=1)}}})),self},setEventHandlers:function(hash){var self=this;return xui.each(hash,(function(o,i){if(null===o)delete self.$EventHandlers[i],delete self.prototype[i];else{self.$EventHandlers[i]=o;var f=function(fun){var j,l=arguments.length;if(1==l&&("function"==typeof fun||"string"==typeof fun||xui.isHash(fun)||xui.isArr(fun)))return this.each((function(v){v.renderId&&v.clearCache(),v.box._addEventHanlder&&v.box._addEventHanlder(v,i,fun),v[i]=fun}));if(1==l&&null===fun)return this.each((function(v){v.clearCache(),v.box._removeEventHanlder&&v.box._removeEventHanlder(v,i,v[i]),delete v[i]}));var args=[],prf=this.get(0);if(prf){var events=prf[i],host=prf.host||prf;if(events&&(!xui.isArr(events)||events.length)){if(prf.$inDesign)return;for(prf.$lastEvent=i,arguments[0]!=prf&&(args[0]=prf),j=0;j<l;j++)args[args.length]=arguments[j];return(xui.isStr(events)||xui.isFun(events))&&(events=[events]),xui.isArr(events.actions||events)&&xui.isNumb(j=(events.actions||events)[0].event)&&(args[j]=args[j]?xui.Event.getEventPara(args[j]):{}),xui.pseudocode._callFunctions(events,args,host,null,prf.$holder,(host&&host.alias||prf.$holder&&prf.$holder.alias)+"."+prf.alias+"."+i)}}};f.$event$=1,f.$original$=o.$original$||self.KEY,f.$name$=i,f.$type$="event",self.plugIn(i,f)}})),self},unserialize:function(target,keepSerialId){"string"==typeof target&&(target=xui.unserialize(target));var f=function(o){xui.isArr(o)&&(o=o[0]),delete o.serialId,o.children&&xui.arr.each(o.children,f)},a=[];return xui.arr.each(target,(function(o){keepSerialId||f(o),a.push(new(xui.SC(o.key))(o).get(0))})),this.pack(a,!1)}},Instance:{clone:function(){var arr=[],clrItems=arguments,f=function(p){delete p.alias;for(var i=0;i<clrItems.length;i++)delete p[clrItems[i]];var c;if(p.children)for(i=0;c=p.children[i];i++)f(c[0])};return this.each((function(o){o=o.serialize(!1,!0),f(o),arr.push(o)})),this.constructor.unserialize(arr)},serialize:function(rtnString,keepHost){var a=[];return this.each((function(o){a[a.length]=o.serialize(!1,keepHost)})),!1===rtnString?a:1==a.length?" new "+a[0].key+"("+xui.serialize(a[0])+")":"xui.UI.unserialize("+xui.serialize(a)+")"},getProperties:function(key){var funName,h={},prop=this.get(0).properties;if(!0===key)return xui.copy(prop);if("string"==typeof key)return prop[key];for(var k in prop)"function"==typeof this[funName="get"+xui.str.initial(k)]&&(h[k]=this[funName].call(this));return h},setProperties:function(key,value,force){if("string"==typeof key){var h={};h[key]=value,key=h}return this.each((function(o){xui.each(key,(function(v,k){var funName="set"+xui.str.initial(k),ins=o.boxing();ins&&"function"==typeof ins[funName]?ins[funName].call(ins,v,!!force):o.properties[k]=v}))}))},getEvents:function(key){return this.get(0).getEvents(key)},setEvents:function(key,value){if("string"==typeof key){var h={};h[key]=value,key=h}return this.each((function(o){var ins=o.boxing();xui.each(key,(function(v,k){"function"==typeof ins[k]&&ins[k].call(ins,v)}))}))},alias:function(value){return value?this.setAlias(value):this.getAlias()},host:function(value,alias){return value?this.setHost(value,alias):this.getHost()},setHost:function(host,alias){return this._setHostAlias(host,alias)},_setHostAlias:function(host,alias){var prf=this.get(0),oldAlias=prf.alias;if(alias=alias||prf.alias,oldAlias&&prf.host&&prf.host!==prf){try{delete prf.host[oldAlias]}catch(e){prf.host[oldAlias]=undefined}prf.host._ctrlpool&&delete prf.host._ctrlpool[oldAlias]}return prf.alias=alias,prf.box&&prf.box._syncAlias&&prf.box._syncAlias(prf,oldAlias,alias),host&&(prf.host=host),prf.host&&prf.host!==prf&&(prf.host[alias]=this,prf.host._ctrlpool&&(prf.host._ctrlpool[alias]=this.get(0))),this},setAlias:function(alias){return this._setHostAlias(null,alias)},getAlias:function(){return this.get(0).alias},getHost:function(){return this.get(0).host},reBindProp:function(dataMap,scope_set,scope_clear,_scope_handled){var prop,ins,fn,r;_scope_handled||(scope_set=scope_set||xui._scope_set,scope_clear=scope_clear||xui._scope_clear);try{_scope_handled||scope_set.call(this,dataMap),this.each((function(prf){(prop=prf.properties).propBinder&&!xui.isEmpty(prop.propBinder)&&(ins=prf.boxing(),xui.each(prop.propBinder,(function(get_prop_value,key){if(xui.isDefined(r=xui.isFun(get_prop_value)?get_prop_value(prf):xui.adjustVar(get_prop_value))&&!1!==xui.tryF(ins._reBindProp,[prf,r,key,get_prop_value],ins))switch(key){case"CA":ins.setCustomAttr(r);break;case"CC":ins.setCustomClass(r);break;case"CS":ins.setCustomStyle(r);break;default:xui.isFun(ins[fn="set"+xui.str.initial(key)])&&ins[fn](r,!0)}})))}))}catch(e){_scope_handled||scope_clear.call(this)}return this}}}),xui.Class("xui.Timer","xui.absObj",{Instance:{_ini:function(properties,events,host){var profile,options,alias,temp,c=this.constructor;for(var i in properties&&properties["xui.Profile"]?alias=(profile=properties).alias||c.pickAlias():(properties&&properties.key&&xui.absBox.$type[properties.key]?(options=properties,properties=null,alias=options.alias||c.pickAlias()):alias=c.pickAlias(),profile=new xui.Profile(host,this.$key,alias,c,properties,events,options)),profile._n=profile._n||[],temp=c.$DataStruct)i in profile.properties||(profile.properties[i]="object"==typeof temp[i]?xui.copy(temp[i]):temp[i]);return profile.link(c._cache,"self").link(xui._pool,"xui"),this._nodes.push(profile),profile.Instace=this,this.n0=profile,this._after_ini&&this._after_ini(profile,alias),this},_after_ini:function(profile){profile.$inDesign||xui.asyRun((function(){profile&&profile.box&&profile.properties.autoStart&&profile.boxing().start()}))},destroy:function(){this.each((function(profile){profile._threadid&&xui.Thread.abort(profile._threadid),profile.__gc()}))},start:function(){return this.each((function(profile){if(!profile.$inDesign)if(profile._threadid)xui.Thread.resume(profile._threadid);else{var p=profile.properties,box=profile.boxing(),t=xui.Thread.repeat((function(threadId){return(!profile.$onTime||!1!==profile.$onTime(profile,threadId))&&(!profile.onTime||!1!==box.onTime(profile,threadId))&&void 0}),p.interval,(function(threadId){profile.onStart&&box.onStart(profile,threadId)}),(function(threadId){profile.onEnd&&box.onEnd(profile,threadId)}));profile._threadid=t.id}}))},suspend:function(){return this.each((function(profile){profile._threadid&&xui.Thread.suspend(profile._threadid),profile.onSuspend&&profile.boxing().onSuspend(profile,profile._threadid)}))},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{_objectProp:{tagVar:1,propBinder:1},_beforeSerialized:function(profile){var o={};xui.merge(o,profile,"all");var p=o.properties=xui.clone(profile.properties,!0);if(profile.box._objectProp)for(var i in profile.box._objectProp)i in p&&p[i]&&(xui.isHash(p[i])||xui.isArr(p[i]))&&xui.isEmpty(p[i])&&delete p[i];return o},DataModel:{autoStart:!0,interval:1e3},EventHandlers:{onTime:function(profile,threadId){},onStart:function(profile,threadId){},onSuspend:function(profile,threadId){},onEnd:function(profile,threadId){}}}}),xui.Class("xui.MessageService","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(profile){if(!profile.$inDesign){var t,p=profile.properties;(t=p.recipientType||p.msgType)&&profile.boxing().seRecipientType(t,!0)}},destroy:function(){this.each((function(profile){if(!profile.$inDesign){var t,id=profile.$xid;(t=profile.properties.msgType)&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.unsubscribe(t,id)})),profile.__gc()}}))},broadcast:function(recipientType,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,readReceipt){return this.each((function(profile){var ins=profile.boxing();xui.arr.each(recipientType.split(/[\s,;:]+/),(function(t){xui.publish(t,[msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,function(){xui.tryF(readReceipt),profile.onReceipt&&profile.boxing().onReceipt.apply(ins,[profile,t,xui.toArr(arguments)])}],null,ins)}))}))},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId},Static:{_objectProp:xui.Timer._objectProp,_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,recipientType:{ini:"",set:function(value){var t,profile=this,p=profile.properties,id=profile.$xid;(t=p.recipientType)&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.unsubscribe(t,id)})),(t=p.recipientType=value||"")&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.subscribe(t,id,(function(){var a=xui.toArr(arguments),ins=profile.boxing();a.unshift(profile),profile.onMessageReceived&&ins.onMessageReceived.apply(ins,a)}),p.asynReceive)}))}},asynReceive:!1},EventHandlers:{onMessageReceived:function(profile,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,readReceipt){},onReceipt:function(profile,recipientType,args){}}}}),xui.Class("xui.ExcelFormula",null,{Static:{MAXCOUNT:256,Supported:function(){var flatten=function(args){for(var t,arr=[],i=0,l=(args=xui.toArr(args)).length;i<l;i++)xui.isArr(t=args[i])?arr=arr.concat(t):arr.push(t);return arr};return{SUM:function(){for(var v,parsed,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"number"==typeof(v=arr[i])?result+=v:"string"==typeof v&&(parsed=parseFloat(v),xui.isNaN(parsed)||(result+=parsed));return result},AVERAGE:function(){for(var v,parsed,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"number"==typeof(v=arr[i])?result+=v:"string"==typeof v&&(parsed=parseFloat(v),xui.isNaN(parsed)||(result+=parsed));return result/l},COUNT:function(){for(var v,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"string"!=(v=typeof arr[i])&&"number"!==v||result++;return result},MIN:function(){return Math.min.apply(Math,flatten(arguments))},MAX:function(){return Math.max.apply(Math,flatten(arguments))},ROUND:function(){return Math.round.apply(Math,arguments)},FIXED:function(){return xui.toFixedNumber.apply(xui,arguments)},CHOOSE:function(){var a=arguments;return xui.isNumb(a[0])&&a[a[0]]||""},CONCATENATE:function(){return flatten(arguments).join("")},ABS:function(a){return Math.abs(a)},ISNUMBER:function(v){return xui.isFinite(v)},NOW:function(){return new Date},TODAY:function(){return xui.Date.getTimSpanStart(new Date,"DAY")},IF:function(a,b,c){return eval(a)?b:c},AND:function(){return!!eval(xui.toArr(arguments).join("&&"))},OR:function(){return!!eval(xui.toArr(arguments).join("||"))},NOT:function(a){return!a}}}(),toColumnChr:function(num){var s="";for(num-=1;num>=0;)s=String.fromCharCode(num%26+97)+s,num=Math.floor(num/26)-1;return s.toUpperCase()},toColumnNum:function(chr){chr=chr.split("");for(var base="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=0,j=chr.length-1,result=0;i<chr.length;i+=1,j-=1)result+=Math.pow(base.length,j)*(base.indexOf(chr[i])+1);return result},toCoordinate:function(cell,offset,rtnArr){var row,col,cellU=cell.toUpperCase();return offset||0===offset||(offset=-1),row=parseInt(cellU.match(/[0-9]+/)[0],10)+offset,col=this.toColumnNum(cellU.match(/[A-Z]+/)[0])+offset,rtnArr?[row,col]:{col:col,row:row}},toCellId:function(col,row,offset){return this.toColumnChr(col+(offset||1))+(row+(offset||1))},getCellRanges:function(cellFrom,cellEnd,colLimited,rowLimited){var ns=this,alpha=/[A-Z]+/,num=/[0-9]+/;alpha.test(cellFrom)||(cellFrom="A"+cellFrom),num.test(cellFrom)||(cellFrom+="1"),alpha.test(cellEnd)||(cellEnd=ns.toColumnChr(colLimited||ns.MAXCOUNT)+cellEnd),num.test(cellEnd)||(cellEnd+=rowLimited||ns.MAXCOUNT);var row,col,cellStart=ns.toCoordinate(cellFrom,0),cellStop=ns.toCoordinate(cellEnd,0),colStart=cellStart.col,colStop=cellStop.col,rowStart=cellStart.row,rowStop=cellStop.row,cellRange=[];if(colStart<colStop)for(col=colStart;col<=colStop;col++)if(rowStart<rowStop)for(row=rowStart;row<=rowStop;row++)cellRange.push(ns.toColumnChr(col)+row);else for(row=rowStart;row>=rowStop;row--)cellRange.push(ns.toColumnChr(col)+row);else for(col=colStart;col>=colStop;col--)if(rowStart<rowStop)for(row=rowStart;row<=rowStop;row++)cellRange.push(ns.toColumnChr(col)+row);else for(row=rowStart;row>=rowStop;row--)cellRange.push(ns.toColumnChr(col)+row);return cellRange},validate:function(formula){var str;if(xui.isFun(formula))str=formula+"";else{if(!/^\s*=\s*/.test(formula))return!1;str=formula.replace(/^\s*=\s*/,"")}if(str=str.replace(/(\b)([\?_])([0-9]+\b)/g,"1").replace(/(\b[A-Z]+)([\?_])(\b)/g,"1"),/function\s*\(/.test(str))try{str=xui.fun.body(str),new Function("",str)}catch(e){return xui._debugInfo("throw","#VALUE! ",formula,str,e),!1}else{var fake=function(){return 1},reg=new RegExp(xui.toArr(this.Supported,!0).join("|"),"g");if(str=xui.replace(str,[[/"(\\.|[^"\\])*"/,"1"],[/'(\\.|[^'\\])*'/,"1"],[/\{[^}]+\}/,"1"],[/([A-Z\d]+\s*:\s*[A-Z\d]+)/,"1"],[/([A-Z]+[\d]+)/,"1"],[/[=<>]+/g,function(a){return"="==a[0]?"==":"<>"==a[0]?"!=":a[0]}]]),/[A-Z_$]/.test(str.replace(reg,"")))return!1;str=str.replace(reg,"fake");try{eval(str)}catch(e$10){return xui._debugInfo("throw","#VALUE! ",formula,str,e$10),!1}}return!0},getRefCells:function(formula,colLimited,rowLimited){return this._parse(formula,!1,colLimited,rowLimited)},parse:function(formula){return this._parse(formula,null)},calculate:function(formula,cellsMap,colLimited,rowLimited){return this._parse(formula,cellsMap||!0,colLimited,rowLimited)},_parse:function(formula,cellsMap,colLimited,rowLimited){var ret,ns=this,Supported=ns.Supported,RANGE=function(cellsMap,cellStart,cellStop){for(var arr=ns.getCellRanges(cellStart,cellStop,colLimited,rowLimited),i=0,l=arr.length;i<l;i++)arr[i]=cellsMap[arr[i]];return arr},doParse=function(formula,CELLS){var cellHash,rtn,str=formula,f=function(a){if(a[8])return cellHash&&(a[8]in cellHash||(cellHash[a[8]]=1)),'CELLS["'+a[8]+'"]';if(a[6]&&a[7]){if(cellHash)for(var arr=ns.getCellRanges(a[6],a[7],colLimited,rowLimited),i=0,l=arr.length;i<l;i++)arr[i]in cellHash||(cellHash[arr[i]]=1);return'RANGE(CELLS, "'+a[6]+'","'+a[7]+'")'}return a[10]&&a[11]?'Supported["'+a[10]+'"]'+a[11]:void 0};if(cellHash={},!ns.validate(str))return!1;if(xui.isFun(str)?str+="":str=str.replace(/^\s*=\s*/,""),/function\s*\(/.test(str)){str=xui.fun.body(str),str=xui.replace(str,[[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,"$0"],[/\/\/[^\n]*/,"$0"],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/\b([A-Z]+[\d]+)\b/,function(a){return cellHash[a[0]]=1,a[0]}]]);try{if(!1===cellsMap)rtn=cellHash;else{!0===cellsMap&&(cellsMap={});var pre="var map=arguments[0]";xui.each(cellHash,(function(o,i){pre+=", \n",pre+=i+" = map['"+i+"']"})),str=pre+";\n"+str,rtn=xui.isHash(cellsMap)?new Function("",str).call(null,CELLS,formula):str}}catch(e){xui._debugInfo("throw","#VALUE! ",formula,str,e)}finally{return rtn}}else{str=xui.replace(str,[[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/([A-Z\d]+)\s*:\s*([A-Z\d]+)/,f],[/[A-Z]+[\d]+/,f],[/([A-Z]+)(\s*\()/,f],[/[=<>]+/g,function(a){return"="==a[0]?"==":"<>"==a[0]?"!=":a[0]}]]);try{!1===cellsMap?rtn=cellHash:(!0===cellsMap&&(cellsMap={}),rtn=xui.isHash(cellsMap)?eval(str):str)}catch(e$11){xui._debugInfo("throw","#VALUE! ",formula,str,e$11)}finally{return rtn}}};return ret=doParse(formula,cellsMap),!xui.isNaN(ret)&&ret}}}),xui.Class("xui.APICaller","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(profile,ins,alias){profile.name||profile.Instace.setName(alias)},destroy:function(){this.each((function(profile){var box=profile.box,name=profile.properties.name;delete box._pool[name],profile.__gc()}))},setHost:function(value,alias){var self=this;return value&&alias&&self.setName(alias),arguments.callee.upper.apply(self,arguments)},setQueryData:function(data,path){return this.each((function(prf){path?xui.set(prf.properties.queryArgs,(path||"").split("."),data):prf.properties.queryArgs=data||{}}))},invoke:function(onSuccess,onFail,onStart,onEnd,mode,threadid,options){var ns=this,con=ns.constructor,prf=ns.get(0),prop=prf.properties,funs=xui.$cache.functions,t1=funs["$APICaller:beforeInvoke"],t2=funs["$APICaller:beforeData"],t3=funs["$APICaller:onError"];if(!(xui.isFun(t1)&&!1===t1(requestId,prf)||xui.isHash(t1)&&xui.isArr(t1.actions)&&!1===xui.pseudocode._callFunctions(t1,[requestId,prf],ns.getHost(),null,null,"$APICaller:beforeInvoke")||prf.beforeInvoke&&!1===prf.boxing().beforeInvoke(prf,requestId))){var responseType=prop.responseType,requestType=prop.requestType,requestId=prop.requestId,queryURL=prop.queryURL,proxyType=prop.proxyType.toLowerCase(),queryUserName=prop.queryUserName,queryPassword=prop.queryPassword,queryArgs=xui.clone(prop.queryArgs),oAuth2Token=prop.oAuth2Token,queryOptions=xui.clone(prop.queryOptions),queryHeader=xui.clone(prop.queryHeader),requestDataSource=prop.requestDataSource,responseDataTarget=prop.responseDataTarget,responseCallback=prop.responseCallback;if(queryURL=xui.adjustVar(queryURL),"sajax"==proxyType?proxyType="jsonp":"iajax"==proxyType&&(proxyType="xdmi"),"FORM"!=requestType&&"JSON"!=requestType||(queryArgs="string"==typeof queryArgs?xui.unserialize(queryArgs):queryArgs),queryArgs||(queryArgs={}),prop.avoidCache){for(var i=0,rnd="_rand_";queryArgs.hasOwnProperty(rnd);)rnd="_rand_"+ ++i;queryArgs[rnd]=xui.rand()}if(requestDataSource&&requestDataSource.length)for(var i in requestDataSource){var v,path,o=requestDataSource[i];switch(o.type){case"databinder":if(t=xui.DataBinder.getFromName(o.name)){if("force"!==mode&&!t.updateDataFromUI())return;path=(o.path||"").split("."),xui.isHash(v=xui.get(queryArgs,path))?xui.merge(v,t.getData(),"without"):xui.set(queryArgs,path,t.getData())}break;case"form":if((t=xui.get(prf,["host",o.name]))&&t.Class["xui.absContainer"]&&t.getRootNode()){if(!("force"===mode||t.checkValid()&&t.checkRequired()))return;path=(o.path||"").split("."),xui.isHash(v=xui.get(queryArgs,path))?xui.merge(v,t.getFormValues(),"without"):xui.set(queryArgs,path,t.getFormValues())}}}var rMap={header:{}};if(xui.isEmpty(queryHeader)||xui.merge(rMap.header,queryHeader),queryOptions.header&&!xui.isEmpty(queryOptions.header)&&(xui.merge(rMap.header,queryOptions.header),delete queryOptions.header),("SOAP"==responseType||"SOAP"==requestType)&&(con.WDSLCache||(con.WDSLCache={}),!con.WDSLCache[queryURL])){var wsdl=xui.SOAP.getWsdl(queryURL,(function(rspData){prf.afterInvoke&&prf.boxing().afterInvoke(prf,rspData,requestId),xui.isFun(t3)?t3(rspData,requestId,prf):xui.isHash(t3)&&xui.isArr(t3.actions)&&xui.pseudocode._callFunctions(t3,[rspData,requestId,prf],ns.getHost(),null,null,"$APICaller:onError"),prf.onError&&prf.boxing().onError(prf,rspData,requestId),xui.tryF(onFail,arguments,this),xui.tryF(onEnd,arguments,this)}));if(!wsdl)return;con.WDSLCache[queryURL]=wsdl}switch(responseType){case"TEXT":rMap.rspType="text";break;case"JSON":rMap.rspType="json";break;case"XML":proxyType="ajax",rMap.rspType="xml";break;case"SOAP":proxyType="ajax",rMap.rspType="xml";var namespace=xui.SOAP.getNameSpace(con.WDSLCache[queryURL]),action=(namespace.lastIndexOf("/")!=namespace.length-1?namespace+"/":namespace)+(queryArgs.methodName||"");rMap.header.SOAPAction=action}switch(requestType){case"FORM":queryArgs="string"==typeof queryArgs?xui.unserialize(queryArgs):queryArgs;break;case"JSON":rMap.reqType="json","auto"==prop.queryMethod&&(rMap.method="POST"),queryArgs="string"==typeof queryArgs?queryArgs:xui.serialize(queryArgs);break;case"XML":rMap.reqType="xml",proxyType="ajax",rMap.method="POST",queryUserName&&queryPassword&&(rMap.username=queryUserName,rMap.password=queryPassword,rMap.header.Authorization="Basic "+con._toBase64(queryUserName+":"+queryPassword)),queryArgs="string"==typeof queryArgs?queryArgs:xui.XMLRPC.wrapRequest(queryArgs);break;case"SOAP":rMap.reqType="xml",proxyType="ajax",rMap.method="POST",queryUserName&&queryPassword&&(rMap.username=queryUserName,rMap.password=queryPassword,rMap.header.Authorization="Basic "+con._toBase64(queryUserName+":"+queryPassword)),queryArgs="string"==typeof queryArgs?queryArgs:xui.SOAP.wrapRequest(queryArgs,con.WDSLCache[queryURL])}oAuth2Token&&(rMap.header.Authorization="Bearer "+oAuth2Token),"ajax"!=proxyType&&(rMap.asy=!0),"jsonp"==proxyType&&(rMap.method="GET"),"asy"in(options=options||{})||(options.asy=!!prop.queryAsync),"method"in options||"auto"==prop.queryMethod||(options.method=prop.queryMethod),"onEnd"in options||(options.onEnd=onEnd),"onStart"in options||(options.onStart=onStart),xui.merge(options,queryOptions),xui.merge(options,rMap,"all"),options.proxyType=proxyType,xui.isEmpty(options.header)&&delete options.header;var t,cookies={};xui.isEmpty(prop.fakeCookies)||(options.$onStart=function(){xui.each(prop.fakeCookies,(function(v,k){xui.isSet(t=xui.Cookies.get(k))&&(cookies[k]=t,xui.Cookies.remove(k))})),xui.Cookies.set(prop.fakeCookies,1,"/")}),xui.isEmpty(prop.fakeCookies)||(options.$onEnd=function(){xui.each(prop.fakeCookies,(function(v,k){xui.Cookies.remove(k)})),xui.Cookies.set(cookies)});var ajax=xui._getrpc(queryURL,queryArgs,options).apply(null,[queryURL,queryArgs,function(rspData){var mapb;return"XML"!=responseType&&"SOAP"!=responseType||xui.isHash(rspData)||(xui.isStr(rspData)&&(rspData=xui.XML.parseXML(rspData)),"XML"==responseType?rspData=xui.XMLRPC.parseResponse(rspData):"SOAP"==responseType&&(rspData=xui.SOAP.parseResponse(rspData,queryArgs.methodName,con.WDSLCache[queryURL]))),prf.afterInvoke&&(mapb=prf.boxing().afterInvoke(prf,rspData,requestId),xui.isSet(mapb)&&(rspData=mapb),mapb=null),(!xui.isFun(t2)||!1!==t2(rspData,requestId,prf))&&(!xui.isHash(t2)||!xui.isArr(t2.actions)||!1!==xui.pseudocode._callFunctions(t2,[rspData,requestId,prf],ns.getHost(),null,null,"$APICaller:beforeData"))&&(!prf.beforeData||!1!==prf.boxing().beforeData(prf,rspData,requestId))&&(responseDataTarget&&responseDataTarget.length&&xui.arr.each(responseDataTarget,(function(o){var t,data=o.path?xui.get(rspData,o.path.split(".")):rspData;switch(o.type){case"alert":data=xui.stringify(data),xui.Coder&&(data=xui.Coder.formatText(data)),alert(data);break;case"log":xui.log(data);break;case"databinder":(t=xui.DataBinder.getFromName(o.name))&&(t.setData(data),t.updateDataToUI());break;case"form":(t=xui.get(prf,["host",o.name]))&&t.Class["xui.absContainer"]&&t.setFormValues(data)}})),responseCallback&&responseCallback.length&&xui.arr.each(responseCallback,(function(o){var t,host;switch(o.type){case"host":(t=ns.getHost())&&(t=t.functions)&&(t=t[o.name])&&(host=ns.getHost());break;default:(t=xui.$cache.functions[o.name])&&(host=null)}t&&t.actions&&xui.isArr(t.actions)&&xui.pseudocode._callFunctions(t,[rspData,ns],host,null,null,(host&&host.alias)+"."+ns.alias+"."+o.name)})),prf.onData&&prf.boxing().onData(prf,rspData,requestId),void xui.tryF(onSuccess,arguments,this))},function(rspData){prf.afterInvoke&&prf.boxing().afterInvoke(prf,rspData,requestId),responseDataTarget&&responseDataTarget.length&&xui.arr.each(responseDataTarget,(function(o,t){switch(o.type){case"alert":rspData=xui.stringify(rspData),xui.Coder&&(rspData=xui.Coder.formatText(rspData)),alert(rspData);break;case"log":xui.log(rspData)}})),xui.isFun(t3)?t3(rspData,requestId,prf):xui.isHash(t3)&&xui.isArr(t3.actions)&&xui.pseudocode._callFunctions(t3,[rspData,requestId,prf],ns.getHost(),null,null,"$APICaller:onError"),prf.onError&&prf.boxing().onError(prf,rspData,requestId),xui.tryF(onFail,arguments,this)},threadid,options]);if("busy"==mode)xui.observableRun((function(threadid){ajax.threadid=threadid,ajax.start()}));else{if("return"==mode)return ajax;ajax.start()}}}},Static:{WDSLCache:{},$nameTag:"api_",_pool:{},_objectProp:{tagVar:1,propBinder:1,queryArgs:1,queryHeader:1,queryOptions:1,fakeCookies:1,requestDataSource:1,responseDataTarget:1,responseCallback:1},destroyAll:function(){this.pack(xui.toArr(this._pool,!1),!1).destroy(),this._pool={}},getFromName:function(name){var o=this._pool[name];return o&&o.boxing()},_toBase64:function(str){var c1,c2,c3,e1,e2,e3,e4,keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",arr=[],i=0;do{e1=(c1=str.charCodeAt(i++))>>2,e2=(3&c1)<<4|(c2=str.charCodeAt(i++))>>4,e3=(15&c2)<<2|(c3=str.charCodeAt(i++))>>6,e4=63&c3,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),arr.push(keyStr.charAt(e1)+keyStr.charAt(e2)+keyStr.charAt(e3)+keyStr.charAt(e4))}while(i<str.length);return arr.join("")},_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,requestId:"",queryAsync:!0,queryURL:"",avoidCache:!0,oAuth2Token:"",queryUserName:"",queryPassword:"",queryMethod:{ini:"auto",listbox:["auto","GET","POST","PUT","DELETE"]},requestType:{ini:"FORM",listbox:["FORM","JSON","XML","SOAP"]},responseType:{ini:"JSON",listbox:["JSON","TEXT","XML","SOAP"]},requestDataSource:{ini:[]},responseDataTarget:{ini:[]},responseCallback:{ini:[]},queryArgs:{ini:{}},queryHeader:{ini:{}},queryOptions:{ini:{}},fakeCookies:{ini:{}},proxyType:{ini:"auto",listbox:["auto","AJAX","JSONP","XDMI"]},name:{set:function(value){var o=this,ovalue=o.properties.name,_p=o.box._pool,_old=_p[ovalue],_new=_p[value];_p[o.properties.name=value]=o,_new&&!_old&&(o._n=_new._n),_old&&delete _p[ovalue]}},proxyInvoker:{inner:!0,trigger:function(){var prop=this.get(0).properties,bak1=prop.responseDataTarget,bak2=prop.responseCallback,fun=function(d){prop.responseDataTarget=bak1,prop.responseCallback=bak2,d=xui.stringify(d),xui.Coder&&(d=xui.Coder.formatText(d)),alert(d)};prop.responseDataTarget=[],prop.responseCallback=[],this.invoke(fun,fun)}}},EventHandlers:{beforeInvoke:function(profile,requestId){},afterInvoke:function(profile,rspData,requestId){},onData:function(profile,rspData,requestId){},beforeData:function(profile,rspData,requestId){},onError:function(profile,rspData,requestId){}}}}),xui.Class("xui.MQTT","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(prf){var prop=prf.properties,fun=function(){xui.asyRun((function(){prf.$inDesign||prf.host&&prf.host.$inDesign||prop.autoConn&&prf.boxing().connect()}))};xui.get(window,"Paho.Client")?fun():xui.include("Paho.Client",prop.libCDN,(function(){prf&&prf.box&&fun&&fun()}),null,!1,{cache:!0})},destroy:function(){this.each((function(prf){prf.$inDesign||(prf.boxing().disconnect(),prf.__gc())}))},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId,connect:function(){var t,p,prf=this.get(0),prop=prf.properties,path=xui.str.trim(prop.path),server=xui.str.trim(prop.server);path.length&&"/"!=path[0]&&(path="/"+path),(t=prf.$mqtt=new window.Paho.Client(server,parseInt(prop.port,10),path,prop.clientId)).onConnected=function(reconnect){prf.onConnSuccess&&prf.boxing().onConnSuccess(prf,reconnect)},t.onConnectionLost=function(err){prf&&prf.box&&(prf.boxing()._clear(),prf.onConnLost&&prf.boxing().onConnLost(prf,err))},t.onMessageDelivered=function(msgObj){prf.onMsgDelivered&&prf.boxing().onMsgDelivered(prf,msgObj.payloadString,msgObj)},t.onMessageArrived=function(msgObj){prf.onMsgArrived&&prf.boxing().onMsgArrived(prf,msgObj.payloadString,msgObj)};var opt={cleanSession:prop.cleanSession,useSSL:prop.useSSL,onSuccess:function(){prf.$mqtt_connected=1,prf.$mqtt_subed={},prop&&prop.autoSub&&xui.arr.each(prop.subscribers,(function(sub){var topic=sub.topic||sub+"",opt=xui.isHash(sub)?xui.copy(sub):{};delete opt.topic,opt.qos=parseInt(opt.qos)||0,prf.boxing().subscribe(topic,opt)}))},onFailure:function(e){prf&&prf.box&&(prf.onConnFailed?prf.boxing().onConnFailed(prf,e):xui.log(e.errorMessage+"["+e.errorCode+"]"),prf.boxing()._clear())}};if((p=prop.timeout)&&(opt.timeout=p),(p=prop.userName)&&(opt.userName=p),(p=prop.password)&&(opt.password=p),(p=prop.keepAliveInterval)&&(opt.keepAliveInterval=p),prop.willTopic&&prop.willMessage){var msg=new window.Paho.Message(prop.willTopic);msg.destinationName=prop.willMessage,msg.qos=parseInt(prop.willQos)||0,msg.retained=prop.willRetained,opt.willMessage=msg}t.connect(opt)},_clear:function(){var prf=this.get(0),t=prf.$mqtt;t&&(delete t.onConnected,delete t.onConnectionLost,delete t.onMessageDelivered,delete t.onMessageArrived),delete prf.$mqtt_connected,delete prf.$mqtt_subed,delete prf.$mqtt},disconnect:function(){var prf=this.get(0),t=prf.$mqtt;t&&prf.$mqtt_connected&&t.disconnect(),this._clear()},subscribe:function(topic,option){var prf=this.get(0),prop=prf.properties,t=prf.$mqtt;if(t&&prf.$mqtt_connected){var opt=xui.isHash(option)?xui.copy(option):{};prf.$mqtt_subed||(prf.$mqtt_subed={}),opt.qos=parseInt(opt.qos)||0,opt.onSuccess=function(){prf.$mqtt_subed[topic]=new Date,prf.onSubSuccess&&prf.boxing().onSubSuccess(prf,topic)},opt.onFailure=function(e){delete prf.$mqtt_subed[topic],prf.onSubFailed&&prf.boxing().onSubFailed(prf,e,topic)},opt.timeout=prop.timeout,t.subscribe(topic,opt)}},unsubscribe:function(topic,option){var prf=this.get(0),prop=prf.properties,t=prf.$mqtt;if(t&&prf.$mqtt_connected&&prf.$mqtt_subed&&prf.$mqtt_subed[topic]){var opt=xui.isHash(option)?xui.copy(option):{};opt.onSuccess=function(){delete prf.$mqtt_subed[topic],prf.onUnsubSuccess&&prf.boxing().onUnsubSuccess(prf,topic)},opt.onFailure=function(e){prf.onUnsubFailed&&prf.boxing().onUnsubFailed(prf,e,topic)},opt.timeout=prop.timeout,t.unsubscribe(topic,opt)}},publish:function(topic,payload,qos,retained){var prf=this.get(0),t=(prf.properties,prf.$mqtt);t&&prf.$mqtt_connected&&prf.$mqtt_subed&&prf.$mqtt_subed[topic]&&t.publish(topic,"string"==typeof payload?payload:xui.stringify(payload),parseInt(qos)||0,retained||!1)}},Static:{_objectProp:{tagVar:1,propBinder:1,subscribers:1},_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,libCDN:"https://cdn.jsdelivr.net/npm/paho-mqtt@1.1.0/paho-mqtt-min.js",autoConn:!0,autoSub:!0,subscribers:[],server:"broker.mqttdashboard.com",port:"8000",path:"mqtt",clientId:"xui_mqtt_client",timeout:30,userName:"",password:"",keepAliveInterval:60,cleanSession:!0,useSSL:!1,reconnect:!0,willTopic:"",willMessage:"",willQos:{ini:0,listbox:[0,1,2]},willRetained:!1},EventHandlers:{onConnSuccess:function(profile,reconnect){},onConnFailed:function(profile,error){},onConnLost:function(profile,error){},onSubSuccess:function(profile,topic){},onSubFailed:function(profile,error,topic){},onUnsubSuccess:function(profile,topic){},onUnsubFailed:function(profile,error,topic){},onMsgDelivered:function(profile,payloadString,msgObj){},onMsgArrived:function(profile,payloadString,msgObj){}}}}),xui.Class("xui.DataBinder","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,destroy:function(){this.each((function(profile){var box=profile.box,name=profile.properties.name;xui.arr.each(profile._n,(function(v){v&&box._unBind(name,v)})),delete box._pool[name],profile.__gc()}))},setHost:function(value,alias){var self=this;return value&&alias&&self.setName(alias),arguments.callee.upper.apply(self,arguments)},isDirtied:function(){for(var elems=this.constructor._getBoundElems(this.get(0)),i=0,l=elems.length;i<l;i++){var ins,profile=elems[i];if(profile.box["xui.absValue"]&&(ins=profile.boxing()).getUIValue()+" "!=ins.getValue()+" ")return!0}return!1},checkValid:function(ignoreAlert){var result=!0,profile=this.get(0);return!!this.checkRequired(ignoreAlert)&&(xui.absValue.pack(this.constructor._getBoundElems(profile),!1).each((function(prf){if(!prf.boxing().checkValid()){if(!ignoreAlert)return prf.beforeInputAlert&&!1===prf.boxing().prf.beforeInputAlert(profile,prf,"invalid")||xui.alert("$inline.invalid",xui.getRes("$inline.invalid")+(prf.properties.labelCaption?" : "+prf.properties.labelCaption:""),(function(){prf&&prf.renderId&&prf.boxing().activate()})),result=!1;result=!1}})),result)},checkRequired:function(ignoreAlert){var i,result=!0,profile=this.get(0);return xui.absValue.pack(this.constructor._getBoundElems(profile),!1).each((function(prf){if(prf.properties.required&&!(i=prf.boxing().getUIValue())&&0!==i){if(!ignoreAlert)return prf.beforeInputAlert&&!1===prf.boxing().prf.beforeInputAlert(profile,prf,"required")||xui.alert("$inline.required",xui.getRes("$inline.required")+(prf.properties.labelCaption?" : "+prf.properties.labelCaption:""),(function(){prf&&prf.renderId&&prf.boxing().activate()})),result=!1;result=!1}})),result},getUI:function(key){var r;return key?xui.arr.each(this.constructor._getBoundElems(this.get(0)),(function(profile){var p=profile.properties;if((p.dataField||p.name||profile.alias)==key)return r=profile.boxing(),!1})):r=xui.UI.pack(this.constructor._getBoundElems(this.get(0)),!1),r},getUIValue:function(withCaption,dirtied){var prf=this.get(0),hash={};return xui.arr.each(this.constructor._getBoundElems(prf),(function(profile){if(profile.box["xui.absValue"]){var keys,p=profile.properties,ins=profile.boxing(),uv=ins.getUIValue(),key=p.dataField||p.name||profile.alias;dirtied&&uv+" "==ins.getValue()+" "||(ins.getCaption?(-1!=key.indexOf(":")&&(keys=key.split(":")),keys&&keys[0]&&keys[1]?(hash[keys[0]]=uv,hash[keys[1]]=ins.getCaption()):withCaption?xui.set(hash,key,{value:uv,caption:ins.getCaption()},!0):xui.set(hash,key,uv,!0)):xui.set(hash,key,uv,!0))}})),hash},getDirtied:function(withCaption){return this.getUIValue(withCaption,!0)},getData:function(key,force,ignoreAlert){var prf=this.get(0);(prf.$inDesign||force)&&(prf.properties.data={},this.updateDataFromUI(!1,!1,!1,null,null,ignoreAlert,!1));var data=prf.properties.data;return xui.isSet(key)?xui.get(data,key,!0):data},setData:function(key,value,force){var prf=this.get(0),prop=prf.properties;return!1===key?xui.each(prop.data,(function(o,i){prop.data[i]=null})):xui.isSet(key)?xui.isHash(key)?prop.data=key:xui.set(prop.data,key,value,!0):prop.data={},(prf.$inDesign||force)&&this.updateDataToUI(),this},resetValue:function(){return xui.arr.each(this.constructor._getBoundElems(this.get(0)),(function(p,i){(i=p.properties.value)!==p.properties.$UIvalue&&p.boxing().resetValue(i)})),this},clearValue:function(){return xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),!1).resetValue(null),this},updateValue:function(){return xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),!1).updateValue(),this},updateDataFromUI:function(updateUIValue,withCaption,returnArr,adjustData,dataKeys,ignoreAlert,ignoreEvent){var mapb,prf=this.get(0),prop=prf.properties,map={};if(!ignoreAlert){if(!this.checkValid())return!1;if(!this.checkRequired())return!1}return xui.merge(map,prop.data,(function(v,t){return!dataKeys||dataKeys===t||!!xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,t)})),xui.arr.each(this.constructor._getBoundElems(prf),(function(profile){var keys,cap,p=profile.properties,ins=(profile.box.$EventHandlers,profile.boxing()),key=p.dataField||p.name||profile.alias;if("function"==typeof ins.setCaption&&-1!=key.indexOf(":")&&(keys=key.split(":"))[1]&&keys[2]&&(key=keys[0],cap=keys[1]),!dataKeys||dataKeys===key||xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,key)){var capv,b=profile.boxing(),uv=profile.box["xui.absValue"]?b.getUIValue(xui.isBool(returnArr)?returnArr:profile.__returnArray):null,target=xui.get(map,key,!0);if(xui.isHash(target)){var pp=target.properties,theme=target.theme,cc=target.CC,ca=target.CA,cs=target.CS;pp&&delete target.properties,theme&&delete target.theme,ca&&delete target.CA,cc&&delete target.CC,cs&&delete target.CS,xui.filter(target,(function(o,i){return!!(i in p)})),xui.isEmpty(target)||xui.each(target,(function(o,i){i in p&&(target[i]=p[i])})),xui.isHash(pp)&&(xui.filter(pp,(function(o,i){return i in p&&!(i in target)})),xui.isEmpty(pp)||(xui.each(pp,(function(o,i){i in p&&(pp[i]=p[i])})),target.properties=pp)),theme&&(target.theme=profile.theme),ca&&(target.CA=xui.clone(profile.CA,!0)),cc&&(target.CC=xui.clone(profile.CC,!0)),cs&&(target.CS=xui.clone(profile.CS,!0)),"caption"in p&&b.getCaption&&(cap?map[cap]=b.getCaption():("caption"in target||withCaption)&&(pp&&"caption"in pp?pp.caption=b.getCaption():target.caption=b.getCaption())),xui.isDefined(uv)&&"value"in p&&(pp&&"value"in pp?pp.value=uv:target.value=uv)}else profile.box["xui.UI.ComboInput"]&&"file"==p.type?target=profile:"caption"in p?(capv="function"==typeof b.getCaption?b.getCaption():p.caption,cap?(target=uv,map[cap]=capv):target=withCaption?!capv&&!uv||capv==uv?uv:{value:uv,caption:capv}:uv):target=uv,xui.set(map,key,target,!0);!1!==updateUIValue&&profile.renderId&&profile.box["xui.absValue"]&&b.updateValue()}})),adjustData&&(map=xui.tryF(adjustData,[map,prf],this)),!ignoreEvent&&prf.afterUpdateDataFromUI&&(mapb=this.afterUpdateDataFromUI(prf,map),xui.isHash(mapb)&&(map=mapb),mapb=null),xui.merge(prf.properties.data,map,"all"),!0},updateDataToUI:function(adjustData,dataKeys,ignoreEvent){var key,keys,cap,p,v,c,b,pp,uv,mapb,ns=this,prf=ns.get(0),prop=prf.properties,map={};return xui.merge(map,prop.data,(function(v,t){return!dataKeys||dataKeys===t||!!xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,t)})),adjustData&&(map=xui.tryF(adjustData,[map,prf],ns)),!ignoreEvent&&prf.beforeUpdateDataToUI&&(mapb=ns.beforeUpdateDataToUI(prf,map),xui.isHash(mapb)&&(map=mapb),mapb=null),xui.arr.each(ns.constructor._getBoundElems(prf),(function(profile){p=profile.properties,profile.box.$EventHandlers,key=p.dataField||p.name||profile.alias,"function"==typeof profile.boxing().setCaption&&-1!=key.indexOf(":")&&(keys=key.split(":"))[1]&&keys[2]&&(key=keys[0],cap=keys[1]),(!dataKeys||dataKeys===key||xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,key))&&map&&xui.isDefined(xui.get(map,key,!0))&&(v=xui.clone(xui.get(map,key,!0),null,2),uv=c=undefined,b=profile.boxing(),xui.isHash(v)?((pp=v.properties)&&(xui.filter(pp,(function(o,i){return i in p})),c=cap&&pp[cap]||(xui.isSet(pp.caption)?pp.caption:null),uv=xui.isSet(pp.value)?pp.value:null,delete pp.caption,delete pp.value,xui.isEmpty(pp)||b.setProperties(pp),delete v.properties),(pp=v.theme)&&("function"==typeof b.setTheme&&b.setTheme(pp),delete v.theme),(pp=v.CS)&&(xui.isEmpty(pp)||b.setCustomStyle(pp),delete v.CS),(pp=v.CC)&&(xui.isEmpty(pp)||b.setCustomClass(pp),delete v.CC),(pp=v.CA)&&(xui.isEmpty(pp)||b.setCustomAttr(pp),delete v.CA),xui.isEmpty(v)||(xui.filter(v,(function(o,i){return i in p||i in v})),xui.isEmpty(v)||(c=xui.isSet(c)?c:cap&&pp[cap]||xui.isSet(v.caption)?v.caption:null,uv=xui.isSet(uv)?uv:xui.isSet(v.value)?v.value:null,delete v.caption,delete v.value,xui.isEmpty(v)||b.setProperties(v)))):(uv=v,c=cap&&pp[cap]||undefined),xui.isDefined(uv)&&xui.isFun(b.resetValue)&&(b.resetValue(uv),profile.__returnArray=xui.isArr(uv)),xui.isDefined(c)&&xui.isFun(b.setCaption)&&xui.tryF(b.setCaption,[c,!0],b))})),ns}},Static:{$nameTag:"databinder_",_pool:{},_objectProp:{tagVar:1,propBinder:1,data:1},destroyAll:function(){this.pack(xui.toArr(this._pool,!1),!1).destroy(),this._pool={}},getFromName:function(name){var o=this._pool[name];return o&&o.boxing()},_beforeSerialized:xui.Timer._beforeSerialized,_getBoundElems:function(prf){var arr=[];return xui.arr.each(prf._n,(function(profile){profile.behavior.PanelKeys?xui.absValue.pack(profile.boxing().getChildren(null,!0)).each((function(p){arr.push(p)})):profile.box["xui.absValue"]&&arr.push(profile)})),xui.arr.removeDuplicate(arr)},_bind:function(name,profile){if(name){var b,o=this._pool[name];o||((b=new xui.DataBinder).setName(name),o=b.get(0)),profile&&-1==xui.arr.indexOf(o._n,profile)&&profile.link(o._n,"databinder."+name)}},_unBind:function(name,profile){profile&&profile.box&&this._pool[name]&&profile.unLink("databinder."+name)},DataModel:{dataBinder:null,dataField:null,name:{set:function(value){var o=this,ovalue=o.properties.name,_p=o.box._pool,_old=_p[ovalue],_new=_p[value];if(_p[o.properties.name=value]=o,_old&&!_new&&o._n.length)for(var i=0,l=o._n.length;i<l;i++)xui.set(o._n[i],["properties","dataBinder"],value);_new&&!_old&&(o._n=_new._n),_old&&delete _p[ovalue]}},data:{ini:{}}},EventHandlers:{beforeInputAlert:function(profile,ctrlPrf,type){},beforeUpdateDataToUI:function(profile,dataToUI){},afterUpdateDataFromUI:function(profile,dataFromUI){}}}}),xui.Class("xui.Event",null,{Constructor:function(event,node,fordrag,tid){var id,t,src,pre,obj,self=xui.Event,w=window,d=document,dd=0,dragdrop=xui.DragDrop;if(!(event=event||w.event)||!(src=node))return src=node=null,!1;node=null;var type=event.type,xuievent=event.$xuievent,xuitype=event.$xuitype,xuiall=event.$xuiall;if(xui.browser.fakeTouch&&"click"==type&&xui.getData(["!document","$fakescrolling"]))return!1;if("xuitouchdown"==type&&(type="mousedown",xuievent=1,xuiall=0,xuitype="beforeMousedown"),"mouseover"==type||"mouseout"==type){if(1!=(dd=dragdrop&&dragdrop._profile.isWorking?1:2)&&fordrag)return src=null,self.$FALSE;if(!self._handleMouseHover(event,src,1==dd))return src=null,self.$FALSE;1==dd&&(pre=dragdrop&&dragdrop._dropElement)}else if((obj=self._tabHookStack).length&&self._kb[type]&&9==(event.$key||event.keyCode||event.charCode)&&!1===self._handleTabHook(self.getSrc(event),obj=obj[obj.length-1]))return void(src=null);if(id=tid||self.getId(src),obj=self._getProfile(id)){if("DOMMouseScroll"==type&&(type="mousewheel"),"mousedown"==type||"mousewheel"==type)xui.tryF(xui.Dom._blurTrigger,[obj,event]);else if("resize"==type&&(type="size",xui.browser.ie&&w===src)){var width=xui.browser.contentBox&&d.documentElement.clientWidth||d.body.clientWidth,height=xui.browser.contentBox&&d.documentElement.clientHeight||d.body.clientHeight;if(obj._w==width&&obj._h==height)return void(src=null);obj._w=width,obj._h=height}var j,f,name,r=!0,funs=[];for(j=0;j<=2&&(1!=dd||0===j||event.$force);++j)2==dd&&0===j||(name=self._type[type+j]||(self._type[type+j]=self._getEventName(type,j)),xuievent&&!xuiall&&name!==xuitype||obj._getEV(funs,id,name,src.$xid));return(f=function(a,b){for(var v,i=0;v=arguments.callee.tasks[i++];)if(!1===v(obj,a,b))return!1;return!0}).tasks=funs,r=f(event,src.$xid),w===src&&"size"==type&&xui.asyRun((function(){f(event,src.$xid),f.tasks.length=0,delete f.tasks,f=src=null}),150),dragdrop?"drag"==type?dragdrop._onDrag=f:"dragover"==type&&(dragdrop._onDragover=f):"size"!==type&&(f.tasks.length=0,delete f.tasks,f=null),1==dd&&("mouseover"==type&&dragdrop._dropElement==src.$xid&&pre&&pre!=src.$xid&&(self({type:"mouseout",target:t=xui.use(pre).get(0),$xui:!0,$xuitype:"beforeMouseout",preventDefault:function(e){xui.Event.stopDefault(e)},stopPropagation:function(e){xui.Event.stopBubble(e)}},t),dragdrop.setDropElement(src.$xid)),"mouseout"==type&&!dragdrop._dropElement&&pre&&pre==src.$xid&&(self._preDroppable=id,xui.asyRun((function(){delete xui.Event._preDroppable}))),src.$xid==dragdrop._dropElement&&(r=!1)),!1===r&&self.stopBubble(event),r}},Static:{$FALSE:!!xui.browser.opr&&undefined,_type:{},_kb:{keydown:1,keypress:1,keyup:1},_reg:/(-[\w]+)|([\w]+$)/g,$eventhandler:function(){return xui.Event(arguments[0],this)},$eventhandler2:function(){return xui.Event(arguments[0],this,1)},$eventhandler3:function(){var a=arguments[0],t=xui.Event.getSrc(a||window.event),r=xui.Event(a,t);return!1===r?r:t!==this?xui.Event(a,this):void 0},$lastMouseupTime:0,$dblcInterval:500,$lastClickFunMark:0,_events:"mouseover,mouseout,mouseleave,mouseenter,mousedown,mouseup,mousemove,mousewheel,click,dblclick,contextmenu,keydown,keypress,keyup,scroll,blur,focus,load,unload,beforeunload,abort,change,select,submit,reset,error,move,size,dragbegin,drag,dragstop,dragleave,dragenter,dragover,drop,touchstart,touchmove,touchend,touchcancel,mspointerdown,mspointermove,mspointerup,mspointercancel,pointerdown,pointermove,pointerup,pointercancel".split(","),_addEventListener:function(node,evt,fnc){var f1,f2,f,getName=function(name){return name.replace(/^on|before|after/,"").toLowerCase()};if(node.addEventListener){var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(e){}return node.addEventListener(getName(evt),fnc,!!passiveSupported&&{passive:!1}),!0}return!0,"function"==typeof node[evt="on"+getName(evt)]&&(f1=node[evt],f2=fnc,(f=function(){for(var funs=arguments.callee._funs,i=0,l=funs.length;i<l;i++)funs[i].apply(this,arguments)})._funs=f1._funs||[f1],f1._funs=null,f._funs.push(f2),fnc=f),node[evt]=fnc,!0},_removeEventListener:function(node,evt,fnc){var getName=function(name){return name.replace(/^on|before|after/,"").toLowerCase()};if(node.removeEventListener){var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(e){}return node.removeEventListener(getName(evt),fnc,!!passiveSupported&&{passive:!1}),!0}return!0,node[evt="on"+getName(evt)]===fnc?(node[evt]=null,!0):!(!node[evt]||!node[evt]._funs||-1==xui.arr.indexOf(node[evt]._funs,fnc)||(xui.arr.removeValue(node[evt]._funs,fnc),0))},simulateEvent:function(target,type,options,fromtype){options=options||{},target[0]&&(target=target[0]),xui.tryF(xui.Event.$eventsforSimulation[fromtype||type],[target,type,options])},_getEventName:function(name,pos){return(name=this._map1[name])&&(0===pos||1==pos||2==pos?name[pos]:name)},_getProfile:function(id,a,b){return id&&"string"==typeof id&&((a=(b=xui.$cache.profileMap)[id])?a["xui.UIProfile"]?a:(b=b[id.replace(this._reg,"")])?b:a:b[id.replace(this._reg,"")])},_handleTabHook:function(src,target){if(src===document)return!0;var node=src,tabindex=node.tabIndex;do{if(xui.getId(node)==target[0])return node=src=null,!0}while(node&&(node=node.parentNode)&&node!==document&&node!==window);return xui.tryF(target[1],[target[0],tabindex],src),node=src=null,!1},_handleMouseHover:function(event,target,dd){if(target==document)return target=null,!0;var node=("mouseover"==event.type?event.fromElement:event.toElement)||event.relatedTarget;if(dd&&"mouseover"==event.type&&this._preDroppable)try{do{if(node&&node.id&&node.id==this._preDroppable)return target=node=null,!0}while(node&&(node=node.parentNode)&&node!==document&&node!==window)}catch(a){}if(xui.browser.gek)try{do{if(node==target)return target=node=null,!1}while(node&&(node=node.parentNode))}catch(a$12){node=xui([target]);var pos=this.getPos(event),p=node.offset(),s=node.cssSize(),out=pos.left<p.left||pos.left>p.left+s.width||pos.top<p.top||pos.top>p.top+s.height;return target=node=null,"mouseover"==event.type?!out:out}else do{if(node==target)return target=node=null,!1}while(node&&(node=node.parentNode));return target=node=null,!0},_tabHookStack:[],pushTabOutTrigger:function(boundary,trigger){return this._tabHookStack.push([xui(boundary)._nodes[0],trigger]),this},popTabOutTrigger:function(flag){return flag?this._tabHookStack=[]:this._tabHookStack.pop(),this},getSrc:function(event){var a;return(a=event.target||event.srcElement||null)&&xui.browser.kde&&3==a.nodeType?a.parentNode:a},getId:function(node){return window===node?"!window":document===node?"!document":node.id},getBtn:function(event){return xui.browser.ie?4==event.button?"middle":2==event.button?"right":"left":2==event.which?"middle":3==event.which?"right":"left"},getPos:function(event,original){if(event=event||window.event,xui.browser.isTouch&&event.changedTouches&&event.changedTouches[0]&&(event=event.changedTouches[0]),"pageX"in event){var scale=original?1:xui.ini.$zoomScale||1;return{left:event.pageX/scale,top:event.pageY/scale}}var t,d=document,doc=d.documentElement,body=d.body,_L=(xui.isSet(t=doc&&doc.scrollLeft)||xui.isSet(t=body&&body.scrollLeft)?t:0)-(xui.isSet(t=doc.clientLeft)?t:0),_T=(xui.isSet(t=doc&&doc.scrollTop)||xui.isSet(t=body&&body.scrollTop)?t:0)-(xui.isSet(t=doc.clientTop)?t:0);return{left:event.clientX+_L,top:event.clientY+_T}},getKey:function(event){if(event&&event.$xuievent)return event;var t,res=[],k=(event=event||window.event).$key||event.keyCode||event.charCode||0;if("string"==typeof k)res[0]=k;else{var key=String.fromCharCode(k),type=event.type;if("keypress"==type&&k>=33&&k<=128||k>=48&&k<=57||k>=65&&k<=90)res[0]=key;else{if(!(t=arguments.callee.map)){t=arguments.callee.map={};for(var arr="3,enter,8,backspace,9,tab,12,numlock,13,enter,19,pause,20,capslock,27,esc,32, ,33,pageup,34,pagedown,35,end,36,home,37,left,38,up,39,right,40,down,44,printscreen,45,insert,46,delete,50,down,52,left,54,right,56,up,91,win,92,win,93,apps,96,0,97,1,98,2,99,3,100,4,101,5,102,6,103,7,104,8,105,9,106,*,107,+,109,-,110,.,111,/,112,f1,113,f2,114,f3,115,f4,116,f5,117,f6,118,f7,119,f8,120,f9,121,f10,122,f11,123,f12,144,numlock,145,scroll,186,;,187,=,189,-,190,.,191,/,192,`,219,[,220,\\,221,],222,',224,meta,63289,numlock,63276,pageup,63277,pagedown,63275,end,63273,home,63234,left,63232,up,63235,right,63233,down,63272,delete,63302,insert,63236,f1,63237,f2,63238,f3,63239,f4,63240,f5,63241,f6,63242,f7,63243,f8,63244,f9,63245,f10,63246,f11,63247,f12,63248,print".split(","),i=1,l=arr.length;i<l;i+=2)t[arr[i-1]]=arr[i];arr.length=0,t[188]=","}res[0]=t[k]||key}}return(event.modifiers?event.modifiers&Event.CONTROL_MASK:event.ctrlKey||event.ctrlLeft||17==k||57391==k)?(17!=k&&57391!=k||(res[0]=""),res.push("1")):res.push(""),(event.modifiers?event.modifiers&Event.SHIFT_MASK:event.shiftKey||event.shiftLeft||16==k||57390==k)?(16!=k&&57390!=k||(res[0]=""),res.push("1")):res.push(""),event.modifiers||!event.altKey&&!event.altLeft&&18!=k&&57388!=k?res.push(""):(18!=k&&57388!=k||(res[0]=""),res.push("1")),res[0]=res[0],res.key=res[0],res.keyCode=k,res.type=type,res.ctrlKey=!!res[1],res.shiftKey=!!res[2],res.altKey=!!res[3],"keypress"==type?this.$keydownchar&&this.$keydownchar.length>1&&(res.key=this.$keydownchar):"keydown"==type?res[0].length>1?this.$keydownchar=res[0]:this.$keydownchar&&(this.$keydownchar=null):"keyup"==type&&this.$keydownchar&&(this.$keydownchar=null),res},getEventPara:function(event,mousePos){mousePos||(mousePos=xui.Event.getPos(event));var keys=this.getKey(event),h={button:this.getBtn(event),pageX:mousePos&&mousePos.left,pageY:mousePos&&mousePos.top,key:keys.key,keyCode:keys.keyCode,ctrlKey:keys.ctrlKey,shiftKey:keys.shiftKey,altKey:keys.altKey,$xuieventpara:!0};for(var i in event)"$"==i.charAt(0)&&(h[i]=event[i]);return h},stopBubble:function(event){(event=event||window.event).stopPropagation&&event.stopPropagation(),"cancelBubble"in event&&(event.cancelBubble=!0),this.stopDefault(event)},stopDefault:function(event){(event=event||window.event).preventDefault?event.preventDefault():"returnValue"in event&&(event.returnValue=!1)},_kbh:function(cache,key,ctrl,shift,alt,fun,id,args,scope,base){if(key){if(id=id||("string"==typeof fun?fun:null),cache[key=(key||"").toLowerCase()+":"+(ctrl?"1":"")+":"+(shift?"1":"")+":"+(alt?"1":"")]=cache[key]||[],"function"==typeof fun)return id?(delete cache[key][id],xui.arr.removeValue(cache[key],id)):id=xui.rand(),cache[key][id]=[fun,args,scope,base],cache[key].push(id),id;id?(delete cache[key][id],xui.arr.removeValue(cache[key],id)):delete cache[key]}return this},keyboardHook:function(key,ctrl,shift,alt,fun,id,args,scope,base){return this._kbh(xui.$cache.hookKey,key,ctrl,shift,alt,fun,id,args,scope,base)},keyboardHookUp:function(key,ctrl,shift,alt,fun,id,args,scope,base){return this._kbh(xui.$cache.hookKeyUp,key,ctrl,shift,alt,fun,id,args,scope,base)},getWheelDelta:function(e){return e.wheelDelta?e.wheelDelta/120:-e.detail/3},$TAGNAMES:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},_supportCache:{},isSupported:function(name,node){var c=this._supportCache,rn=(node?node.tagName.toLowerCase():"div")+":"+name;if(rn in c)return c[rn];node=node||document.createElement(this.$TAGNAMES[name]||"div");var isSupported=(name="on"+name)in node;return isSupported||(node.setAttribute||(node=document.createElement("div")),node.setAttribute&&(node.setAttribute(name,""),isSupported="function"==typeof node[name],"undefined"!=typeof node[name]&&(node[name]=undefined),node.removeAttribute(name))),node=null,c[rn]=isSupported},_simulateMousedown:function(event){if(!event.touches)return!0;var E=xui.Event,first=event.changedTouches[0];return event.touches.length>1||(E.__simulatedMousedownNode=first.target,E.isSupported("mousedown")?E._xuitouchdowntime=xui.setTimeout((function(){E._xuitouchdowntime=0,E.simulateEvent(first.target,"xuitouchdown",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY},"mousedown")}),100):E.simulateEvent(first.target,"mousedown",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY})),!0},_simulateMouseup:function(event){if(!event.touches)return!0;var E=xui.Event,_now=(new Date).getTime(),interval=_now-E.$lastMouseupTime,first=event.changedTouches[0];return E._xuitouchdowntime&&xui.clearTimeout(E._xuitouchdowntime),E.__simulatedMouseupNode=first.target,E.isSupported("mouseup")||E.simulateEvent(first.target,"mouseup",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),E.__simulatedMouseupNode===E.__simulatedMousedownNode&&(E.isSupported("click")||E.simulateEvent(first.target,"click",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),interval<=E.$dblcInterval&&xui.asyRun((function(){E.$lastMouseupTime=0,E.simulateEvent(first.target,"dblclick",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY})}))),E.__simulatedMouseupNode=E.__simulatedMousedownNode=null,E.$lastMouseupTime=_now,!0},stopPageTouchmove:function(){xui.Event._addEventListener(document,xui.browser.ie&&xui.browser.ver>=11?"pointermove":xui.browser.ie&&xui.browser.ver>=10?"MSPointerMove":"touchmove",xui.Event.stopDefault)},allowPageTouchmove:function(){xui.Event._removeEventListener(document,xui.browser.ie&&xui.browser.ver>=11?"pointermove":xui.browser.ie&&xui.browser.ver>=10?"MSPointerMove":"touchmove",xui.Event.stopDefault)}},Initialize:function(){var t1,t2,s,ns=this,w=window,d=document,m1={move:null,size:null,drag:null,dragstop:null,dragover:null,mousewheel:null,dragbegin:"onmousedown",dragenter:"onmouseover",dragleave:"onmouseout",drop:"onmouseup"},a1=["before","on","after"];t1=ns._map1={},xui.arr.each(ns._events,(function(o){s=xui.str.initial(o),t1[o]=[a1[0]+s,a1[1]+s,a1[2]+s]})),t1=ns._eventMap={},t2=ns._eventHandler={},xui.arr.each(ns._events,(function(o){s=xui.str.initial(o),t1[o]=t1[a1[1]+o]=t1[a1[0]+s]=t1[a1[1]+s]=t1[a1[2]+s]=o,t2[o]=t2[a1[1]+o]=t2[a1[0]+s]=t2[a1[1]+s]=t2[a1[2]+s]=o in m1?m1[o]:"on"+o})),ns._addEventListener(w,"resize",ns.$eventhandler),ns._addEventListener(w,"DOMMouseScroll",ns.$eventhandler3),xui.browser.isTouch&&(ns._addEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerdown":xui.browser.ie&&xui.browser.ver>=10?"MSPointerDown":"touchstart",ns._simulateMousedown),ns._addEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerup":xui.browser.ie&&xui.browser.ver>=10?"MSPointerUp":"touchend",ns._simulateMouseup),ns._addEventListener(d,"xuitouchdown",ns.$eventhandler)),ns._addEventListener(w,"mousewheel",ns.$eventhandler3);var keyEvent=function(target,type,options){switch(type){case"textevent":type="keypress"}xui.merge(options,{bubbles:!0,cancelable:!0,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,keyCode=options.keyCode,charCode=options.charCode,customEvent=null;if(d.createEvent){try{(customEvent=d.createEvent("KeyEvents")).initKeyEvent(type,bubbles,cancelable,view,ctrlKey,altKey,shiftKey,metaKey,keyCode,charCode)}catch(ex){try{customEvent=d.createEvent("Events")}catch(uierror){customEvent=d.createEvent("UIEvents")}finally{customEvent.initEvent(type,bubbles,cancelable),customEvent.view=view,customEvent.altKey=altKey,customEvent.ctrlKey=ctrlKey,customEvent.shiftKey=shiftKey,customEvent.metaKey=metaKey,customEvent.keyCode=keyCode,customEvent.charCode=charCode}}target.dispatchEvent(customEvent)}else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.shiftKey=shiftKey,customEvent.metaKey=metaKey,customEvent.keyCode=charCode>0?charCode:keyCode,target.fireEvent("on"+type,customEvent)}},mouseEvent=function(target,type,options){options=options||{},xui.merge(options,{bubbles:!0,cancelable:!0,view:w,detail:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,screenX:0,screenY:0,clientX:0,clientY:0,button:0,relatedTarget:null},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,detail=options.detail,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,button=options.button,relatedTarget=options.relatedTarget,customEvent=null;if(d.createEvent)(customEvent=d.createEvent("MouseEvents")).initMouseEvent?customEvent.initMouseEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget):((customEvent=d.createEvent("UIEvents")).initEvent(type,bubbles,cancelable),customEvent.view=view,customEvent.detail=detail,customEvent.screenX=screenX,customEvent.screenY=screenY,customEvent.clientX=clientX,customEvent.clientY=clientY,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.metaKey=metaKey,customEvent.shiftKey=shiftKey,customEvent.button=button,customEvent.relatedTarget=relatedTarget),relatedTarget&&!customEvent.relatedTarget&&("mouseout"===type?customEvent.toElement=relatedTarget:"mouseover"===type&&(customEvent.fromElement=relatedTarget)),target.dispatchEvent(customEvent);else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;switch((customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.detail=detail,customEvent.screenX=screenX,customEvent.screenY=screenY,customEvent.clientX=clientX,customEvent.clientY=clientY,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.metaKey=metaKey,customEvent.shiftKey=shiftKey,button){case 0:customEvent.button=1;break;case 1:customEvent.button=4;break;case 2:break;default:customEvent.button=0}customEvent.relatedTarget=relatedTarget,target.fireEvent("on"+type,customEvent)}},UIEvent=function(target,type,options){xui.merge(options,{bubbles:!0,cancelable:"submit"===type,view:w,detail:1},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,detail=options.detail,customEvent=null;if(d.createEvent)(customEvent=d.createEvent("UIEvents")).initUIEvent(type,bubbles,cancelable,view,detail),target.dispatchEvent(customEvent);else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.detail=detail,target.fireEvent("on"+type,customEvent)}},gestureEvent=function(target,type,options){xui.merge(options,{bubbles:!0,cancelable:!0,detail:2,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,scale:1,rotation:0},"without");var customEvent,bubbles=options.bubbles,cancelable=options.cancelable,detail=options.detail,view=options.view,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,scale=options.scale,rotation=options.rotation;(customEvent=d.createEvent("GestureEvent")).initGestureEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,target,scale,rotation),target.dispatchEvent(customEvent)},touchEvent=function(target,type,options){if("touchstart"===type||"touchmove"===type){if(!options.touches||!options.touches.length)throw new Error("No touch object in touches.")}else if(!("touchend"!==type||options.changedTouches&&options.changedTouches.length))throw new Error("No touch object in changedTouches.");xui.merge(options,{bubbles:!0,cancelable:"touchcancel"!==type,detail:1,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,screenX:0,screenY:0,clientX:0,clientY:0,scale:1,rotation:0},"without");var customEvent,bubbles=options.bubbles,detail=options.detail,view=options.view,scale=options.scale,rotation=options.rotation,touches=options.touches,targetTouches=options.targetTouches,changedTouches=options.changedTouches,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,cancelable="touchcancel"!=type&&options.cancelable;if(!d.createEvent)throw type+" cant be simulated in "+navigator.userAgent;if(xui.browser.isAndroid)xui.browser.ver<4?((customEvent=d.createEvent("MouseEvents")).initMouseEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,0,target),customEvent.touches=touches,customEvent.targetTouches=targetTouches,customEvent.changedTouches=changedTouches):(customEvent=d.createEvent("TouchEvent")).initTouchEvent(touches,targetTouches,changedTouches,type,view,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey);else{if(!xui.browser.isIOS)throw type+" cant be simulated in "+navigator.userAgent;if(!(xui.browser.ver>=2))throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEvent("TouchEvent")).initTouchEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,touches,targetTouches,changedTouches,scale,rotation)}target.dispatchEvent(customEvent)};ns.$eventsforSimulation={click:mouseEvent,dblclick:mouseEvent,mouseover:mouseEvent,mouseout:mouseEvent,mouseenter:mouseEvent,mouseleave:mouseEvent,mousedown:mouseEvent,mouseup:mouseEvent,mousemove:mouseEvent,pointerover:mouseEvent,pointerout:mouseEvent,pointerdown:mouseEvent,pointerup:mouseEvent,pointermove:mouseEvent,MSPointerOver:mouseEvent,MSPointerOut:mouseEvent,MSPointerDown:mouseEvent,MSPointerUp:mouseEvent,MSPointerMove:mouseEvent,keydown:keyEvent,keyup:keyEvent,keypress:keyEvent,submit:UIEvent,blur:UIEvent,change:UIEvent,focus:UIEvent,resize:UIEvent,scroll:UIEvent,select:UIEvent,touchstart:touchEvent,touchmove:touchEvent,touchend:touchEvent,touchcancel:touchEvent,gesturestart:gestureEvent,gesturechange:gestureEvent,gestureend:gestureEvent}}}),xui.Class("xui.CSS",null,{Static:{_r:xui.browser.ie?"rules":"cssRules",_baseid:"xui:css:base",_firstid:"xui:css:first",_lastid:"xui:css:last",_reg1:/\.(\w+)\[CLASS~="\1"\]/g,_reg2:/\[ID"([^"]+)"\]/g,_reg3:/\*([.#])/g,_reg4:/\s+/g,_reg5:/\*\|/g,_reg6:/(\s*,\s*)/g,_rep:function(str){var ns=this;return str.replace(ns._reg1,".$1").replace(ns._reg2,"#$1").replace(ns._reg3,"$1").replace(ns._reg4," ").replace(ns._reg5,"").replace(ns._reg6,",").toLowerCase()},_appendSS:function(container,txt,id,before,attr){var fc=document.createElement("style");if(fc.type="text/css",id&&(fc.id=id),xui.browser.ie&&fc.styleSheet&&"cssText"in fc.styleSheet)fc.styleSheet.cssText=txt||"";else try{fc.appendChild(document.createTextNode(txt||""))}catch(p){fc.styleSheet.cssText=txt||""}return attr&&xui(fc).attr(attr),before?xui(container).prepend(fc):xui(container).append(fc),fc},_createCss:function(id,txt,last){var fc,c,head=this._getHead(),fid=this._firstid,lid=this._lastid;if((fc=document.createElement("style")).type="text/css",fc.id=id,txt)if(xui.browser.ie&&fc.styleSheet&&"cssText"in fc.styleSheet)fc.styleSheet.cssText=txt||"";else try{fc.appendChild(document.createTextNode(txt||""))}catch(p){fc.styleSheet.cssText=txt||""}if(last)head.appendChild(fc);else{for(c=document.getElementById(fid)||head.firstChild;(c=c.nextSibling)&&!/^(script|link|style)$/i.test(""+c.tagName););c||(c=document.getElementById(lid))?head.insertBefore(fc,c):head.appendChild(fc)}return fc},_getCss:function(id,css,last){return document.getElementById(id)||this._createCss(id,css,last)},_getBase:function(){return this._getCss(this._baseid)},_getFirst:function(){return this._getCss(this._firstid)},_getLast:function(){return this._getCss(this._lastid,null,!0)},_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]||document.documentElement)},_check:function(){if(xui.browser.ie){for(var l,count=0,i=0,t=this._getHead().childNodes;l=t[i++];)"text/css"==l.type&&count++;return count>20}},get:function(property,value){for(var l,i=0,t=this._getHead().childNodes;l=t[i++];)if("text/css"==l.type&&property in l&&l[property]==value)return l},addStyleSheet:function(txt,id,backOf,force){var e,ns=this,head=ns._getHead();if(id&&(id=id.replace(/[^\w\-_\.:]/g,"_"))&&(e=ns.get("id",id))){if(!force)return e;e.disabled=!0,head.removeChild(e)}return ns._check()?function(txt,backOf){var e=backOf?ns._getLast():ns._getBase();return e.styleSheet.cssText+=txt,e}(txt,backOf):function(txt,id,backOf){var e=document.createElement("style");if(e.type="text/css",id&&(e.id=id),xui.browser.ie&&e.styleSheet&&"cssText"in e.styleSheet)e.styleSheet.cssText=txt||"";else try{e.appendChild(document.createTextNode(txt||""))}catch(p){e.styleSheet.cssText=txt||""}return-1===backOf?head.firstChild?head.insertBefore(e,head.firstChild):head.appendChild(e):1===backOf?head.appendChild(e):head.insertBefore(e,backOf?ns._getLast():ns._getBase()),e.disabled=!0,e.disabled=!1,e}(txt,id,backOf)},includeLink:function(href,id,front,attrs){var e,head=this._getHead();return href&&(e=this.get("href",href))||((e=document.createElement("link")).type="text/css",e.rel="stylesheet",e.href=href,id&&(e.id=id),e.media="all",xui.each(attrs,(function(o,i){e.setAttribute(i,o)}))),head.insertBefore(e,front?this._getBase():this._getLast()),e.disabled=!0,e.disabled=!1,e},remove:function(property,value){var head=this._getHead();(value=this.get(property,value))&&(value.disabled=!0,head.removeChild(value))},replaceLink:function(href,property,oValue,nValue){var e,v,head=this._getHead(),attr={};attr[property]=nValue,e=this.includeLink(href,null,!1,attr),(v=this.get(property,oValue))&&head.replaceChild(e,v),e.disabled=!0,e.disabled=!1},_build:function(selector,value,flag){var t="";return xui.each(value,(function(o,i){t+=i.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+o+";"})),flag?t:selector+"{"+t+"}"},setStyleRules:function(selector,value,force){var target,target2,selectorText,bak,t,_t,ns=this,add=!0,ds=document.styleSheets;return selector=xui.str.trim(selector.replace(/\s+/g," ")),value&&force||(bak=selector.toLowerCase(),xui.arr.each(xui.toArr(ds),(function(o){try{o[ns._r]}catch(e$13){return}if(xui.arr.each(xui.toArr(o[ns._r]),(function(v,i){if(v.selectorText&&!v.disabled)if(selectorText=ns._rep(v.selectorText),_t=selectorText.split(","),value){if(selectorText==bak)return target=v,!1;if(-1!=xui.arr.indexOf(_t,bak))return target2=v,!1}else add=!1,-1!=xui.arr.indexOf(_t,bak)&&_t.length>1?(_t=xui.arr.removeFrom(_t,xui.arr.indexOf(_t,bak)).join(","),t=v.cssText.slice(v.cssText.indexOf("{")+1,v.cssText.lastIndexOf("}")),o.insertRule?o.insertRule(_t+"{"+t+"}",o[ns._r].length):o.addRule&&o.addRule(_t,t||"{}"),o.deleteRule?o.deleteRule(i):o.removeRule(i),o.disabled=!0,o.disabled=!1):selectorText==bak&&(o.deleteRule?o.deleteRule(i):o.removeRule(i),o.disabled=!0,o.disabled=!1)}),null,!0),target){add=!1;try{xui.each(value,(function(o,i){i=i.replace(/(-[a-z])/gi,(function(m,a){return a.charAt(1).toUpperCase()})),target.style[i]="function"==typeof o?o(target.style[i]):o}))}catch(e$14){}return o.disabled=!0,o.disabled=!1,!1}if(target2)return add=!1,o.insertRule(ns._build(selector,value),o[ns._r].length),o.disabled=!0,o.disabled=!1,!1}),null,!0)),(force||add)&&ns._addRules(selector,value),ns},$getCSSValue:function(selector,cssKey,cssValue,ownerNode){var css,o,v,i,j,selectorText,k=this._r,ds=document.styleSheets,l=ds.length;for(selector=xui.str.trim(selector.replace(/\s+/g," ").toLowerCase()),i=l-1;i>=0;i--){try{o=ds[i][k]}catch(e){continue}if(!ds[i].disabled&&(o=ds[i][k]))for(j=o.length-1;j>=0;j--)if((v=o[j]).selectorText&&!v.disabled&&(selectorText=this._rep(v.selectorText),-1!=xui.arr.indexOf(selectorText.split(/\s*,\s*/g),selector)))if(cssKey){if(cssValue){if(cssValue===v.style[cssKey])return ds[i].ownerNode||ds[i].owningElement}else if((!ownerNode||ownerNode==ds[i].ownerNode||ds[i].owningElement)&&""!==v.style[cssKey])return(v.style[cssKey]||"").replace(/^"|"$/g,"")}else(css=css||[]).push(v)}return css},_addRules:function(selector,value){var ns=this,target=ns._getLast(),changed=target.sheet||target.styleSheet;return changed.insertRule?changed.insertRule(ns._build(selector,value),changed[ns._r].length):changed.addRule&&changed.addRule(selector,ns._build(selector,value,!0)||"{}"),target.disabled=!0,target.disabled=!1,ns},adjustFont:function(fontSize,fontFamily,fontWeight,fontStyle){fontSize&&xui("html").css("font-size",fontSize),fontFamily&&xui("html").css("font-family",fontFamily),fontWeight&&xui("html").css("font-weight",fontWeight),fontStyle&&xui("html").css("font-style",fontStyle),this._dftEmStr="",this._getDftEmSize(!0),this._dftRemStr="",this._getDftRemSize(!0),xui.UI&&xui.UI.getAll().reLayout(!0)},_dftEmStr:"",_dftEm:0,_getDftEmSize:function(force){var ns=this;if(force||!ns._dftEm){var num,fz=ns.$getCSSValue(".xui-ui-ctrl","fontSize");if(!ns._dftEmStr||ns._dftEmStr!=fz)if((num=parseFloat(fz))&&ns.$isPx(fz))ns._dftEm=num,ns._dftEmStr=fz;else if(num&&ns.$isRem(fz))ns._dftEm=num*ns._getDftRemSize(),ns._dftEmStr=fz;else{var div;xui("body").append(div=xui.create('<div class="xui-ui-ctrl" style="height:1em;visibility:hidden;position:absolute;border:0;margin:0;padding:0;left:-10000px;"></div>')),ns._dftEm=div.get(0).offsetHeight,div.remove(),ns._dftEmStr=ns._dftEm+"px"}}return ns._dftEm},$resetEm:function(){delete xui.CSS._dftEm},_dftRemStr:"",_dftRem:0,_getDftRemSize:function(force){return!force&&this._dftRem||(this._dftRem=parseFloat(xui("html").css("font-size"))||16),this._dftRem},$resetRem:function(){delete xui.CSS._dftRem},$isEm:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))em$/i.test(xui.str.trim(value+"")):1==xui.$us()},$isRem:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))rem$/i.test(xui.str.trim(value+"")):1==xui.$us()},$isPx:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))px$/i.test(xui.str.trim(value+"")):1==xui.$us()},$em2px:function(value,node,roundPx){return value=value&&"auto"!=value&&(xui.isFinite(value)||this.$isEm(value))?(parseFloat(value)||0)*(node?xui.isFun(node)?node():xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value,roundPx?Math.round(parseFloat(value)||0):value},$px2em:function(value,node,roundPx){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isPx(value))?(roundPx?Math.round(parseFloat(value)||0):parseFloat(value)||0)/(node?xui.isFun(node)?node():xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value},$rem2px:function(value,roundPx){return value=value&&"auto"!=value&&(xui.isFinite(value)||this.$isRem(value))?(parseFloat(value)||0)*this._getDftRemSize():value,roundPx?Math.round(parseFloat(value)||0):value},$px2rem:function(value,roundPx){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isPx(value))?(roundPx?Math.round(parseFloat(value)||0):parseFloat(value)||0)/this._getDftRemSize():value},$em2rem:function(value,node){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isEm(value))?(parseFloat(value)||0)*(node?xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize())/this._getDftRemSize():value},$rem2em:function(value,node){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isRem(value))?(parseFloat(value)||0)*this._getDftRemSize()/(node?xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value},$px:function(value,node,roundPx){return value=!xui.isFinite(value)&&this.$isRem(value)?this.$rem2px(value,roundPx):this.$isEm(value)?this.$em2px(value,node,roundPx):value&&"auto"!=value?parseFloat(value)||0:value,roundPx?Math.round(parseFloat(value)||0):value},$em:function(value,node,roundPx){return xui.isFinite(value)||this.$isPx(value)?this.$px2em(value,node,roundPx):this.$isRem(value)?this.$rem2em(value,node):value&&"auto"!=value?parseFloat(value)||0:value},$rem:function(value,node,roundPx){return xui.isFinite(value)||this.$isPx(value)?this.$px2rem(value,roundPx):this.$isEm(value)?this.$em2rem(value,node):value&&"auto"!=value?parseFloat(value)||0:value},$addpx:function(a,b,node){return"auto"==a?a:this.$isRem(a)?this.$px2rem(Math.round(this.$rem2px(a)+(parseFloat(b)||0)))+"rem":this.$isEm(a)?this.$px2em(Math.round(this.$em2px(a,!1,node)+(parseFloat(b)||0)))+"em":Math.round((parseFloat(a)||0)+(parseFloat(b)||0))+"px"},$forceu:function(v,u,node,roundPx){return null===v||v===undefined||""===v||"auto"==v?v:(u?"rem"==u:0===xui.$us())?this.$rem(v,node,!1!==roundPx)+"rem":(u?"em"==u:1==xui.$us())?this.$em(v,node,!1!==roundPx)+"em":Math.round(this.$px(v,node,!1!==roundPx))+"px"},$picku:function(v){return v&&"auto"!=v&&(v+"").replace(/[-\d\s.]*/g,"")||(1==xui.$us()?"em":"px")},$addu:function(v){return"auto"==v?v:xui.isFinite(v)||this.$isPx(v)?Math.round(parseFloat(v)||0)+"px":v+""}},Initialize:function(){var b=xui.browser,inlineblock=(b.gek?b.ver<3?(b.ver<3?"-moz-outline-offset:-1px !important;":"")+"display:-moz-inline-block;display:-moz-inline-box;display:inline-block;":"display:inline-block;":b.ie6?"display:inline-box;display:inline;":"display:inline-block;")+(b.ie?"zoom:1;":""),css=".xui-node{margin:0;padding:0;line-height:1.22;-webkit-text-size-adjust:none;}.xui-node-highlight{color:#000;}.xui-title-node{}.xuifont-hover, .xuicon-hover{ color: #686868; }"+(xui.browser.fakeTouch||"touchOnly"==xui.browser.deviceType?"":".xuifont-active, .xuicon-active{ color: #3393D2; }")+".xuifont-checked, .xuicon-checked{ color: #3393D2; }.xui-wrapper{color:#000;font-family:arial,helvetica,clean,sans-serif;font-style:normal;font-weight:normal;vertical-align:middle;}.xui-cover{cursor:wait;background:url("+xui.ini.img_bg+") transparent repeat;opacity:1;}.xui-node-table{border-collapse:collapse;border-spacing:0;empty-cells:show;font-size:inherit;"+(b.ie?"font:100%;":"")+"}.xui-node-fieldset,.xui-node-img{border:0;}.xui-node-ol,.xui-node-ul,.xui-node-li{list-style:none;}.xui-node-caption,.xui-node-th{text-align:left;}.xui-node-th{font-weight:normal;}.xui-node-q:before,.xui-node-q:after{content:'';}.xui-node-abbr,.xui-node-acronym{border:0;font-variant:normal;}.xui-node-sup{vertical-align:text-top;}.xui-node-sub{vertical-align:text-bottom;}.xui-node-input,.xui-node-textarea,.xui-node-select{cursor:text;font-family:inherit;font-size:inherit;font-weight:inherit;"+(b.ie?"font-size:100%;":"")+"}.xui-node-del,.xui-node-ins{text-decoration:none;}.xui-node-pre,.xui-node-code,.xui-node-kbd,.xui-node-samp,.xui-node-tt{font-family:monospace;"+(b.ie?"font-size:108%;":"")+"line-height:100%;}.xui-node-select,.xui-node-input,.xui-node-textarea{font-family:arial,helvetica,clean,sans-serif;border-width:1px;}"+(b.ie&&b.ver<=8?".xui-node-input{overflow:hidden;}":"")+".xui-node-a, .xui-node-a .xui-node{cursor:pointer;color:#0000ee;text-decoration:none;}.xui-node-a:hover, .xui-node-a:hover .xui-node{color:red}"+(b.gek?".xui-node-a:focus{outline-offset:-1px;"+(b.ver<3?"-moz-outline-offset:-1px !important":"")+"}":"")+".xui-node-span, .xui-node-div{border:0;}"+(b.ie&&b.ver<=8?"":".xui-node-span:not(.xui-showfocus):focus, .xui-node-div:not(.xui-showfocus):focus{outline:0;}.xui-showfocus:focus{outline-width: 1px;outline-style: dashed;}")+".xui-node-span, .xui-wrapper span"+(b.ie&&b.ver<=7?"":", .xui-v-wrapper:before, .xui-v-wrapper > .xui-v-node")+"{outline-offset:-1px;"+inlineblock+"}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6{font-size:100%;font-weight:normal;}.xui-node-h1{font-size:138.5%;}.xui-node-h2{font-size:123.1%;}.xui-node-h3{font-size:108%;}.xui-node-h1,.xui-node-h2,.xui-node-h3{margin:1em 0;}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6,.xui-node-strong{font-weight:bold;}.xui-node-em{font-style:italic;}.xui-node-legend{color:#000;}"+(b.ie6?"#"+xui.$localeDomId+"{vertical-align:baseline;}":"")+".xui-nofocus:focus{outline:0;}.xui-cls-wordwrap{white-space: pre-wrap;word-break: break-all;"+(b.gek?"white-space: -moz-pre-wrap;":"")+(b.opr?"white-space: -pre-wrap;":"")+(b.opr?"white-space: -o-pre-wrap;":"")+(b.ie?"word-wrap: break-word;":"")+"}"+(b.ie&&b.ver<=8?"":".xui-v-wrapper:before{content:'';height:100%;font-size:0;vertical-align:middle;}.xui-v-wrapper > .xui-v-node{vertical-align:middle;}.xui-v-top > .xui-v-wrapper:before{vertical-align:top;}.xui-v-top > .xui-v-wrapper > .xui-v-node{vertical-align:top;}.xui-v-bottom > .xui-v-wrapper:before{vertical-align:bottom;}.xui-v-bottom > .xui-v-wrapper > .xui-v-node{vertical-align:bottom;}")+".xui-node-tips{background-color:#FDF8D2;}.xuifont, .xuicon{font-size:1.3333333333333333em;line-height:1em;}.xuicon{margin: 0 .25em;"+inlineblock+"}.xuicon:before{height:1em;width:1em;}.xui-ui-ctrl, .xui-ui-reset{font-family:arial,helvetica,clean,sans-serif; font-style:normal; font-weight:normal; vertical-align:middle; color:#000; }.xui-ui-reset{font-size: inherit;}.xui-ui-ctrl{cursor:default;font-size:.875rem;}.xui-title-node{font-size:1.1667em  !important;}.setting-uikey{font-family:'default'}";this.addStyleSheet(css,"xui.CSS")}}),xui.Class("xui.DomProfile","xui.absProfile",{Constructor:function(domId){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,xui.$cache.profileMap[this.domId=domId]=this},Instance:{__gc:function(){delete xui.$cache.profileMap[this.domId]},_getEV:function(funs,id,name){var t=xui.$cache.profileMap[id];if(t&&(t=t.events)&&(t=t[name]))for(var i=0,l=t.length;i<l;i++)"function"==typeof t[t[i]]&&(funs[funs.length]=t[t[i]])}},Static:{get:function(id){return xui.$cache.profileMap[id]},$abstract:!0}}),xui.Class("xui.Dom","xui.absBox",{Instance:{get:function(index){var s,purge=xui.$cache.domPurgeData,t=this._nodes;if(xui.isNumb(index))return(s=t[index])&&(s=purge[s])&&s.element;for(var a=[],l=t.length,i=0;i<l;i++)a[a.length]=(s=purge[t[i]])&&s.element;return a},each:function(fun,desc){var n,i,purge=xui.$cache.domPurgeData,j=this._nodes,l=j.length;if(desc)for(i=l;i>=0&&(!(n=purge[j[i]])||!(n=n.element)||!1!==fun.call(this,n,i));i--);else for(i=0;i<l&&(!(n=purge[j[i]])||!(n=n.element)||!1!==fun.call(this,n,i));i++);return n=null,this},serialize:function(){var a=[];return this.each((function(o){a[a.length]=o.id})),"xui(['"+a.join("','")+"'])"},xid:function(){return xui.getId(this.get(0))},id:function(value,ignoreCache){var t,i,cache=xui.$cache.profileMap;return"string"==typeof value?this.each((function(o){(i=o.id)!==value&&(!ignoreCache&&(t=cache[i])&&(cache[value]=t,delete cache[i]),o.id=value)})):this.get(0)&&this.get(0).id},$sum:function(fun,args){var r,i,arr=[];return this.each((function(o){if(r=fun.apply(o,args||[]))if(xui.isArr(r))for(i=0;o=r[i];i++)arr[arr.length]=o;else arr[arr.length]=r})),xui(arr)},children:function(){return this.$sum((function(){return xui.toArr(this.childNodes)}))},clone:function(deep){return this.$sum((function(){var o,n=this.cloneNode(!!deep),children=n.getElementsByTagName("*"),ie=xui.browser.ie&&xui.browser.ver<9,i=0;for(ie?n.removeAttribute("$xid"):delete n.$xid;o=children[i];i++)ie?o.removeAttribute("$xid"):delete o.$xid;return n}),arguments)},$iterator:function(type,dir,inn,fun,top){return this.$sum((function(type,dir,inn,fun,top){var self=arguments.callee;if("function"!=typeof fun){var count=fun||0;fun=function(n,index){return index==count}}for(var m,t,index=0,n=this,flag=0;n&&(1!=n.nodeType||!0!==fun(n,index++));)if("x"==type)n=dir?n.nextSibling:n.previousSibling;else if("y"==type)n=dir?self.call(1===dir?n.lastChild:n.firstChild,"x",1!==dir,!0,0,top):n.parentNode;else{if(inn=!xui.isBool(inn)||inn,m=null,n=dir?(t=inn&&n.firstChild)||(t=n.nextSibling)?t:m=n.parentNode:(t=inn&&n.lastChild)||(t=n.previousSibling)?t:m=n.parentNode,m){for(;!(m=dir?n.nextSibling:n.previousSibling);)if(!(n=n.parentNode)){if(flag)return null;flag=!0,m=dir?document.body.firstChild:document.body.lastChild;break}n=m}inn=!0}return n}),arguments)},query:function(tagName,property,expr){tagName=tagName||"*";var f="getElementsByTagName",me=arguments.callee,f1=me.f1||(me.f1=function(tag,attr,expr){var all=this[f](tag),arr=[];expr.test(this[attr])&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)expr.test(o[attr])&&(arr[arr.length]=o);return arr}),f2=me.f2||(me.f2=function(tag,attr,expr){var all=this[f](tag),arr=[];this[attr]==expr&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)o[attr]==expr&&(arr[arr.length]=o);return arr}),f3=me.f3||(me.f3=function(tag,attr,expr){var all=this[f](tag),arr=[];this[attr]&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)o[attr]&&(arr[arr.length]=o);return arr}),f4=me.f4||(me.f4=function(tag){return xui.toArr(this[f](tag))}),f5=me.f5||(me.f5=function(tag,attr){var all=this[f](tag),arr=[];attr(this)&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)attr(o)&&(arr[arr.length]=o);return arr});return this.$sum(property?"function"==typeof property?f5:expr?xui.isReg(expr)?f1:f2:f3:f4,[tagName,property,expr])},querySelector:function(selectors){return this.$sum((function(){return this.querySelector(selectors)}))},querySelectorAll:function(selectors){return this.$sum((function(){return xui.toArr(this.querySelectorAll(selectors))}))},$add:function(fun,target,reversed){if((xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),reversed?(reversed=xui(target),target=this):(target=xui(target),reversed=this),target._nodes.length){var fragment,p,i,o,j,v,uiObj,one=reversed.get(0),ns=target.get(),dom=xui.Dom,cache=xui.$cache.profileMap,arr=[];if(target.each((function(o){(uiObj=(p=o.id)&&(p=cache[p])&&p.LayoutTrigger&&(one===xui("body").get(0)||"none"!=dom.getStyle(one,"display"))&&p.LayoutTrigger)&&arr.push([uiObj,p])})),1==ns.length)fragment=ns[0];else for(fragment=document.createDocumentFragment(),i=0;o=ns[i];i++)fragment.appendChild(o);for(fun.call(one,fragment),i=0;o=arr[i];i++){for(j=0;v=o[0][j];j++)v.call(o[1]);o[1].onLayout&&o[1].boxing().onLayout(o[1])}arr.length=0,one=o=fragment=null}return this},prepend:function(target,reversed){return this.$add((function(node){this.previousSibling!=node&&(this.firstChild?this.insertBefore(node,this.firstChild):this.appendChild(node))}),target,reversed)},append:function(target,reversed,force){return this.$add((function(node){(force||this!=node.parentNode)&&this.appendChild(node)}),target,reversed)},addPrev:function(target,reversed){return this.$add((function(node){this.firstChild!=node&&this.parentNode.insertBefore(node,this)}),target,reversed)},addNext:function(target,reversed){return this.$add((function(node){this.nextSibling!=node&&(this.nextSibling?this.parentNode.insertBefore(node,this.nextSibling):this.parentNode.appendChild(node))}),target,reversed)},replace:function(target,triggerGC){(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target=xui(target);var v,i,c=this.get(0),ns=target.get(),l=ns.length;if(l>0&&(v=ns[l-1])){for(c.parentNode.replaceChild(v,c),i=0;i<l-1;i++)v.parentNode.insertBefore(ns[i],v);triggerGC&&this.remove()}return c=v=null,target},swap:function(target){var t=xui.Dom.getEmptyDiv().html("*",!1);return(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target=xui(target),this.replace(t,!1),target.replace(this,!1),t.replace(target,!1),t.get(0).innerHTML="",document.body.insertBefore(t.get(0),document.body.firstChild),this},remove:function(triggerGC,purgeNow,callback){if(!1===triggerGC)this.each((function(o,i){o.raphael&&o.remove?o.remove():o.parentNode&&o.parentNode.removeChild(o)}));else{var c=xui.$getGhostDiv();this.each((function(o){c.appendChild(o)}),!0);var f=function(){xui.$purgeChildren(c),callback&&(xui.tryF(callback),callback=null),c=null};purgeNow?f():xui.asyRun(f)}return this},empty:function(triggerGC,purgeNow){return this.each((function(o){xui([o]).html("",triggerGC,null,purgeNow)}))},html:function(content,triggerGC,loadScripts,purgeNow,callback){var i,s="",o=this.get(0);if(triggerGC=!1!==triggerGC,content!==undefined){if(o){if(3==o.nodeType)o.nodeValue=content;else{if(!o.firstChild&&""===content)return this;if(triggerGC){var c=xui.$getGhostDiv();for(i=o.childNodes.length-1;i>=0;i--)c.appendChild(o.childNodes[i]);var f=function(){xui.$purgeChildren(c),callback&&(xui.tryF(callback),callback=null),c=null};purgeNow?f():xui.asyRun(f)}var scripts;if(loadScripts){var matched,attr,src,reg1=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/gi,reg3=/\ssrc=(['"])(.*?)\1/i;for(scripts=[];matched=reg1.exec(content);)(src=!!(attr=matched[1])&&attr.match(reg3))&&src[2]?scripts.push([1,src[2]]):matched[2]&&matched[2].length>0&&scripts.push([2,matched[2]]);content=content.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,"")}o.innerHTML=content,scripts&&scripts.length>0&&xui.arr.each(scripts,(function(s){1==s[0]?xui.include(null,s[1]):xui.exec(s[1])}))}o=null}return this}return o&&(s=3==o.nodeType?o.nodeValue:o.innerHTML,o=null),s},loadHtml:function(options,onStart,onEnd){var ns=this;"string"==typeof options&&(options={url:options}),xui.tryF(onStart),xui.Ajax(options.url,options.query,(function(rsp){var n=xui.create("div");n.html(rsp,!1,!0),ns.append(n.children()),xui.tryF(onEnd)}),(function(err){ns.append("<div>"+err+"</div>"),xui.tryF(onEnd)}),null,options.options).start()},loadIframe:function(options,domId){"string"==typeof options&&(options={url:options});var t,id=domId||"aiframe_"+xui.stamp();(t=xui.Dom.byId(domId))&&xui(t).remove();var e=xui.browser.ie&&xui.browser.ver<9,ifr=document.createElement(e?"<iframe name='"+id+"'>":"iframe");ifr.id=ifr.name=id,ifr.src=options.url,ifr.frameBorder="0",ifr.marginWidth="0",ifr.marginHeight="0",ifr.vspace="0",ifr.hspace="0",ifr.allowTransparency="true",ifr.width="100%",ifr.height="100%",this.append(ifr),xui.Dom.submit(options.url,options.query,options.method,ifr.name,options.enctype)},outerHTML:function(content,triggerGC){var s="",o=this.get(0);if(o.id,content!==undefined){var n=this.replace(xui.str.toDom(content),!1);return this._nodes[0]=n._nodes[0],xui([o]).remove(triggerGC),this}if(xui.browser.gek){var m=xui.$getGhostDiv();m.appendChild(this.get(0).cloneNode(!0)),s=m.innerHTML,m.innerHTML="",m=null}else s=o.outerHTML;return o=null,s},text:function(content){return content!==undefined?(this.each((function(o){for(var t,i=o.childNodes.length-1;i>=0;i--)(t=o.childNodes[i])&&3==t.nodeType&&(t.nodeValue="");o.appendChild(document.createTextNode(content))})),this):(o=this.get(0))?o.textContent||o.innerText:"";var o},attr:function(name,value){var self=this,me=arguments.callee,map1=me.map1||(me.map1={class:"className",readonly:"readOnly",tabindex:"tabIndex",for:"htmlFor",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",value:"value"}),map2=me.map2||(me.map2={href:1,src:1,style:1});if("object"==typeof name){for(var i in name)me.call(self,i,name[i]);return self}var iestyle=xui.browser.ie&&"style"==name,normal=!map2[name=map1[name]||name];if(value!==undefined)return self.each((function(o){if(null===value){if(iestyle)o.style.cssText="";else if(normal)try{o[name]=null,1==o.nodeType&&o.removeAttribute(name)}catch(e){}}else value="style"==name?(value+"").replace(/[;]+/g,";").replace(/^;/,""):value,iestyle?o.style.cssText=""+value:normal?(o[name]=value,1==o.nodeType&&"value"!=name&&"string"==typeof value&&o.setAttribute(name,value)):o.setAttribute(name,value)}));var r,o=self.get(0);return iestyle?o.style.cssText:"selected"==name&&xui.browser.kde?o.parentNode.selectedIndex:(r=name in o&&normal?o[name]:o.getAttribute(name,xui.browser.ie&&!normal?2:undefined),o=null,"style"==name?(r||"").replace(/[;]+/g,";").replace(/^;/,""):r)},$touchscroll:function(type){if(xui.browser.fakeTouch||xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){var hash={x:1,y:1,xy:1},nodes=this._nodes,getD=function(t){var o=xui.getNodeData(t,"_wheelscroll");return o||xui.setNodeData(t,"_wheelscroll",o={}),o},doSwipe=function(t){var wheel=getD(t);if((wheel._speedx||wheel._speedy)&&(new Date).getTime()-wheel._lastTime<50){var m,params={},sl=t.scrollLeft,st=t.scrollTop;if(wheel._speedx&&(m=[Math.max(0,sl),Math.max(0,sl+Math.sign(wheel._speedx)*Math.min(50,Math.abs(wheel._speedx))*40)])[0]!==m[1]&&(params.scrollLeft=m),wheel._speedy&&(m=[Math.max(0,st),Math.max(0,st+Math.sign(wheel._speedy)*Math.min(50,Math.abs(wheel._speedy))*40)])[0]!==m[1]&&(params.scrollTop=m),!xui.isEmpty(params)){var tid=xui.getNodeData(t,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(t,"_inthread"),xui.setData(["!document","$fakescroll"])),xui(t).animate(params,null,null,2e3,null,"expoOut").start()}}wheel._opx=wheel._opy=wheel._ox=wheel._oy=wheel._lastTime=wheel._speedx=wheel._speedy=null};hash[type]||(type=null),xui(nodes)[xui.browser.fakeTouch?"onMousedown":"onTouchstart"](hash[type]?function(p,e,src){if(xui.DragDrop._profile.isWorking)return!0;if(!xui(src).scrollable("x")&&!xui(src).scrollable("y"))return!0;var s,t=xui(src).get(0),tid=xui.getNodeData(t,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(t,"_inthread"));var wheel=getD(t);if(xui.browser.fakeTouch){if("left"!==xui.Event.getBtn(e))return!0;s=e}else{if(e.touches.length>1)return!0;s=e.touches[0]}return t&&("xy"!=type&&"x"!=type||(wheel._ox=t.scrollLeft,wheel._opx=s.pageX),"xy"!=type&&"y"!=type||(wheel._oy=t.scrollTop,wheel._opy=s.pageY)),!xui.browser.fakeTouch||(xui.setData(["!document","$fakescroll"],src),xui.doc.onMouseup((function(p,e,src){xui.setData(["!document","$fakescroll"]),xui.asyRun((function(){xui.setData(["!document","$fakescrolling"])})),xui.doc.onMouseup(null,"touchscroll"),doSwipe(t)}),"touchscroll"),!0)}:null,"touchscroll"),xui(nodes)[xui.browser.fakeTouch?"onMousemove":"onTouchmove"](hash[type]?function(p,e,src){if(xui.DragDrop._profile.isWorking)return!0;if(xui.browser.fakeTouch&&xui.getData(["!document","$fakescroll"])!=src)return!0;var s,x1,y1,t=xui(src).get(0);if(xui.browser.fakeTouch){if("left"!==xui.Event.getBtn(e))return!0;s=e}else{if(e.touches.length>1)return!0;s=e.touches[0]}if(t){var wheel=getD(t);return wheel._lastTime=(new Date).getTime(),x1=t.scrollLeft,y1=t.scrollTop,"xy"!=type&&"x"!=type||(t.scrollLeft=wheel._ox+wheel._opx-s.pageX,x1==t.scrollLeft?(wheel._ox=t.scrollLeft,wheel._opx=s.pageX):wheel._speedx=t.scrollLeft-x1),"xy"!=type&&"y"!=type||(null===wheel._oy&&(wheel._oy=t.scrollTop+wheel._opy),t.scrollTop=wheel._oy+wheel._opy-s.pageY,y1==t.scrollTop?(wheel._oy=t.scrollTop,wheel._opy=s.pageY):wheel._speedy=t.scrollTop-y1),xui.browser.fakeTouch&&(x1===t.scrollLeft&&y1===t.scrollTop||xui.setData(["!document","$fakescrolling"],1)),x1==t.scrollLeft&&y1==t.scrollTop}}:null,"touchscroll"),xui(nodes).onTouchend(hash[type]?function(p,e,src){return!!xui.DragDrop._profile.isWorking||e.touches.length>1||void doSwipe(xui(src).get(0))}:null,"touchscroll")}return this},isScrollBarShowed:function(type){var n=this.get(0);if(n)return"y"==type?(n.offsetWidth||0)>(n.clientWidth||0):(n.offsetHeight||0)>(n.clientHeight||0)},scrollable:function(type){return 0!==this[type="x"==type?"scrollLeft":"scrollTop"]()||(this[type](1),0!==this[type]()&&(this[type](0),!0))},scrollIntoView:function(){return this.each((function(o){o.scrollIntoView()}))},css:function(name,value,force){return"object"==typeof name||value!==undefined?(this.each((function(o){xui.Dom.setStyle(o,name,value)})),(xui.browser.fakeTouch||xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB))&&("overflow"!=name&&"overflow-x"!=name&&"overflow-y"!=name||("auto"==value||"scroll"==value?this.$touchscroll("overflow"==name?"xy":"overflow-x"==name?"x":"y"):this.$touchscroll(null))),this):xui.Dom.getStyle(this.get(0),name,force)},_getEmSize:function(rate){return this.get(0)?(parseFloat(xui.Dom.getStyle(this.get(0),"fontSize",!0))||xui.CSS._getDftEmSize())*(rate||1):null},rotate:function(v){if(xui.isSet(v))return v=parseFloat(v)||0,(v%=360)<0&&(v+=360),this.each((function(o){if(o.raphael&&o.id){var prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&o.transform("r"+v)}else{v+="deg";var transform=o.style.transform||"";/rotate\([^)]*\)/i.test(transform)?transform=transform.replace(/(rotate\()([^)]+)/i,"$1"+v):transform+=" rotate("+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){var prf=xui.Event._getProfile(o.id);if((prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))){o=o.transform(),o=xui.isArr(o)?o.length?o.join():"":o?window.Raphael.parseTransformString(o).join():"";var arr=/r,([-\d.]+)/i.exec(o);return v=arr?parseFloat(arr[1]||0):0,(v%=360)<0&&(v+=360),v}return 0}return(arr=/rotate\(([-\d.]+)/i.exec(o.style.transform))?parseFloat(arr[1]||0):0},scaleX:function(v){if(xui.isSet(v))return this.each((function(o){if(v=parseFloat(v),o.raphael&&o.id){v=v||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t[0]&&"s"==t[0][0]?t[0][1]=v:(t=t||[]).unshift(["s",v,1]),o.transform(t))}else{xui.isNaN(v)&&(v=1);var transform=o.style.transform||"";/(scale\()([^,]+),([^)]+)/i.test(transform)?transform=transform.replace(/(scale\()([^,]+),([^)]+)/i,"$1"+v+",$3"):/scale\([-\d.]*\)/i.test(transform)?transform=transform.replace(/scale\([-\d.]*\)/i,"scale("+v+",1)"):transform+=" scale("+v+",1)",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=1;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"s"==t[0]&&(v*=t[1])})),v}var arr=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[2]||1):(arr=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform))?arr[1]:1},scaleY:function(v){if(xui.isSet(v))return this.each((function(o){if(v=parseFloat(v),o.raphael&&o.id){v=v||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t[0]&&"s"==t[0][0]?t[0][2]=v:(t=t||[]).unshift(["s",1,v]),o.transform(t))}else{xui.isNaN(v)&&(v=1);var transform=o.style.transform||"";/(scale\()([^,]+),([^)]+)/i.test(transform)?transform=transform.replace(/(scale\()([^,]+),([^)]+)/i,"$1$2,"+v):/scale\([-\d.]*\)/i.test(transform)?transform=transform.replace(/scale\([-\d.]*\)/i,"scale(1,"+v+")"):transform+=" scale(1,"+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=1;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"s"==t[0]&&(v*=t[2])})),v}var arr=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[3]||1):(arr=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform))?arr[1]:1},translateX:function(v){if(xui.isSet(v))return this.each((function(o){if(o.raphael&&o.id){v=parseFloat(v)||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t.length&&t[t.length-1]&&"t"==t[t.length-1][0]?t[t.length-1][1]=v:(t=t||[]).push(["t",v,0]),o.transform(t))}else{v=xui.CSS.$addu(v);var transform=o.style.transform||"";/translate\([^)]*\)/i.test(transform)?transform=transform.replace(/(translate\()([^,]+),([^)]+)/i,"$1"+v+",$3"):transform+=" translate("+v+",0)",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=0;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"t"==t[0]&&(v+=t[1])})),v}var arr=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?(arr[2]||"").replace(/\s/g,""):""},translateY:function(v){if(xui.isSet(v))return this.each((function(o){if(o.raphael&&o.id){v=parseFloat(v)||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t.length&&t[t.length-1]&&"t"==t[t.length-1][0]?t[t.length-1][2]=v:(t=t||[]).push(["t",0,v]),o.transform(t))}else{v=xui.CSS.$addu(v);var transform=o.style.transform||"";/translate\([^)]*\)/i.test(transform)?transform=transform.replace(/(translate\()([^,]+),([^)]+)/i,"$1$2,"+v):transform+=" translate(0,"+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=0;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"t"==t[0]&&(v+=t[2])})),v}var arr=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?(arr[3]||"").replace(/\s/g,""):""},skewX:function(v){if(xui.isSet(v))return xui.isFinite(v)&&(v+="deg"),this.each((function(o){var transform=o.style.transform||"";/skew\([^)]*\)/i.test(transform)?transform=transform.replace(/(skew\()([^,]+),([^)]+)/i,"$1"+(v||0)+",$3"):transform+=" skew("+v+",0deg)",xui.Dom.setStyle(o,"transform",transform)}));var arr=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[2]||0):0},skewY:function(v){if(xui.isSet(v))return xui.isFinite(v)&&(v+="deg"),this.each((function(o){var transform=o.style.transform||"";/skew\([^)]*\)/i.test(transform)?transform=transform.replace(/(skew\()([^,]+),([^)]+)/i,"$1$2,"+(v||0)):transform+=" skew(0deg,"+v+")",xui.Dom.setStyle(o,"transform",transform)}));var arr=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[3]||0):0},caret:function(begin,end){var input=this.get(0),tn=input.nodeName.toLowerCase(),type=typeof begin,ie=xui.browser.ie;if(/^(input|textarea)$/i.test(tn)&&("input"!=tn||"text"==input.type.toLowerCase()||"password"==input.type.toLowerCase())){if(input.focus(),"number"==type)return ie?((r=input.createTextRange()).collapse(!0),r.moveEnd("character",end),r.moveStart("character",begin),r.select()):(input.focus(),input.setSelectionRange(begin,end)),this;if("string"==type){var ret,r=this.caret(),l=0,m=0,v=input.value,reg1=/\r/g;return ie&&(l=(l=v.substr(0,r[0]).match(reg1))&&l.length||0,m=(m=begin.match(reg1))&&m.length||0),xui.browser.opr&&(m=(l=(l=begin.match(/\n/g))&&l.length||0)-(m=(m=begin.match(/\r\n/g))&&m.length||0),l=0),input.value=v.substr(0,r[0])+begin+v.substr(r[1],v.length),ret=r[0]-l+m+begin.length,this.caret(ret,ret),ret}if(ie&&document.selection){var e;if(l=(r=document.selection.createRange()).text.length,"input"==tn.toLowerCase())return r.moveStart("character",-input.value.length),[(e=r.text.length)-l,e];var rb=r.duplicate();return rb.moveToElementText(input),rb.setEndPoint("EndToEnd",r),[(e=rb.text.length)-l,e]}return[input.selectionStart,input.selectionEnd]}},show:function(left,top,callback,showEffects,ignoreEffects){var style,t,vv;return this.each((function(o){if(1==o.nodeType){var tid=xui.getNodeData(o,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(o,"_inthread")),style=o.style,(vv=xui.getNodeData(o))._xuihide&&("_left"in vv&&style.left!=(t=vv._left)&&(style.left=t),"_top"in vv&&style.top!=(t=vv._top)&&(style.top=t),"_position"in vv&&style.position!=(t=vv._position)&&(style.position=t),"visible"!=style.visibility&&(style.visibility="visible"),xui(o).removeClass("xui-ui-hidden"),vv._xuihide=0),xui.isSet(left)&&(style.left=left),xui.isSet(top)&&(style.top=top),(showEffects=ignoreEffects?null:showEffects||xui.get(xui.UIProfile.getFromDom(o),["properties","showEffects"]))&&(showEffects=xui.Dom._getEffects(showEffects,1)),showEffects?xui.Dom._vAnimate(o,showEffects,callback):callback&&callback()}}))},hide:function(callback,hideEffects,ignoreEffects){var style,vv;return this.each((function(o){if(1==o.nodeType){var tid=xui.getNodeData(o,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(o,"_inthread")),style=o.style,vv=xui.getNodeData(o);var fun=function(){1!==vv._xuihide&&(vv._position=style.position,vv._visibility=style.visibility,vv._top=style.top,vv._left=style.left,vv._xuihide=1),"absolute"!=style.position&&(style.position="absolute"),style.visibility="hidden",xui(o).addClass("xui-ui-hidden"),callback&&callback()};(hideEffects=ignoreEffects?null:hideEffects||xui.get(xui.UIProfile.getFromDom(o),["properties","hideEffects"]))&&(hideEffects=xui.Dom._getEffects(hideEffects,0)),hideEffects?xui.Dom._vAnimate(o,hideEffects,fun):fun()}}))},cssRegion:function(region,triggerEvent){if("object"==typeof region){for(var i,node=this.get(0),dom=xui.Dom,f=dom._setUnitStyle,m={},j=0,c=dom._boxArr;i=c[j++];)m[i]=i in region&&null!==region[i]&&f(node,i,region[i]);return triggerEvent&&((f=dom.$hasEventHandler)(node,"onsize")&&(m.width||m.height)&&this.onSize(!0,{width:m.width,height:m.height}),f(node,"onmove")&&(m.left||m.top)&&this.onMove(!0,{left:m.left,top:m.top})),this}var parent=triggerEvent,pos=region?this.offset(null,parent):this.cssPos(),size=this.cssSize();return{left:pos.left,top:pos.top,width:size.width,height:size.height}},cssSize:function(size,triggerEvent){var r,b1,b2,node=this.get(0),dom=xui.Dom,f=dom._setUnitStyle;return node?(size?(b1=null!==size.width&&f(node,"width",size.width),b2=null!==size.height&&f(node,"height",size.height),triggerEvent&&(b1||b2)&&dom.$hasEventHandler(node,"onsize")&&this.onSize(!0,{width:b1,height:b2}),r=this):r={width:this._W(node,1)||0,height:this._H(node,1)},r):size?this:{}},cssPos:function(pos,triggerEvent){var b1,b2,r,node=this.get(0),dom=xui.Dom,css=xui.CSS,f=dom._setUnitStyle;return pos?(b1=null!=pos.left&&f(node,"left",pos.left),b2=null!==pos.top&&f(node,"top",pos.top),triggerEvent&&(b1||b2)&&dom.$hasEventHandler(node,"onmove")&&this.onMove(!0,{left:b1,top:b2}),r=this):(f=dom.getStyle,r={left:css.$px(f(node,"left"),node),top:css.$px(f(node,"top"),node)}),node=null,r},offset:function(pos,boundary,original){var r,t,browser=xui.browser,ns=this,node=ns.get(0),keepNode=node,parent=node.parentNode,op=node.offsetParent,doc=node.ownerDocument,dd=doc.documentElement,db=doc.body,_d=/^inline|table.*$/i,getStyle=xui.Dom.getStyle,fixed="fixed"==getStyle(node,"position"),me=arguments.callee,add=me.add||(me.add=function(pos,l,t){pos.left+=parseFloat(l)||0,pos.top+=parseFloat(t)||0}),border=me.border||(me.border=function(node,pos){add(pos,getStyle(node,"borderLeftWidth"),getStyle(node,"borderTopWidth"))}),TTAG=me.TTAG||(me.TTAG={TABLE:1,TD:1,TH:1}),HTAG=me.HTAG||(me.HTAG={BODY:1,HTML:1}),posDiff=me.posDiff||(me.posDiff=function(o,target){var cssPos=o.cssPos(),absPos=o.offset(null,target);return{left:absPos.left-cssPos.left,top:absPos.top-cssPos.top}});if(boundary=boundary?xui(boundary).get(0):doc,pos){if(null===pos.left&&null===pos.top)return ns;var d=posDiff(ns,boundary);ns.cssPos({left:null===pos.left?null:pos.left-d.left,top:null===pos.top?null:pos.top-d.top}),r=ns}else{if(xui.browser.gek&&node===document.body||!node.getBoundingClientRect){for(add(pos={left:0,top:0},node.offsetLeft,node.offsetTop);op&&op!=boundary&&op!=boundary.offsetParent;)add(pos,op.offsetLeft,op.offsetTop),(browser.kde||browser.gek&&!TTAG[op.nodeName])&&border(op,pos),fixed||"fixed"!=getStyle(op,"position")||(fixed=!0),"BODY"!=op.nodeName&&(keepNode="BODY"==op.nodeName?keepNode:op),op=op.offsetParent;for(;parent&&parent.nodeName&&parent!=boundary&&!HTAG[parent.nodeName];)_d.test(getStyle(parent,"display"))||add(pos,-parent.scrollLeft,-parent.scrollTop),browser.gek&&"visible"!=getStyle(parent,"overflow")&&border(parent,pos),parent=parent.parentNode;browser.gek&&"absolute"!=getStyle(keepNode,"position")&&add(pos,-db.offsetLeft,-db.offsetTop),fixed&&add(pos,dd.scrollLeft||db.scrollLeft||0,dd.scrollTop||db.scrollTop||0)}else if(pos={left:(t=xui.Dom.$getBoundingClientRect(node,original)).left,top:t.top},1==boundary.nodeType&&boundary!==document.body)add(pos,-(t=xui.Dom.$getBoundingClientRect(boundary,original)).left+boundary.scrollLeft,-t.top+boundary.scrollTop);else{var base=xui.Dom.getEmptyDiv();base.css({left:0,top:0,position:"absolute"});var basRect=xui.Dom.$getBoundingClientRect(base.get(0),original);base.css({left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}),add(pos,-basRect.left,-basRect.top)}r=pos}return r},hasClass:function(name){var i,l,isReg=xui.isReg(name),arr=xui.Dom._getClass(this.get(0)).split(/\s+/);if(!isReg)return-1!=xui.arr.indexOf(arr,name+"");for(i=0,l=arr.length;i<l;i++)if(name.test(arr[i]))return!0;return!1},addClass:function(name){if(!name)return this;var arr,i,l,t,ok,me=arguments.callee,reg=me.reg||(me.reg=/\s+/),arr2=(name+"").split(reg);return arr2.length?this.each((function(o){for(ok=0,arr=xui.Dom._getClass(o).split(reg),t=[],i=0,l=arr.length;i<l;i++)arr[i]&&t.push(arr[i]);for(i=0,l=arr2.length;i<l;i++)arr2[i]&&-1==xui.arr.indexOf(arr,arr2[i])&&(ok=1,t.push(arr2[i]));ok&&xui.Dom._setClass(o,t.join(" "))})):this},removeClass:function(name){var arr,i,l,ok,arr2,isReg=xui.isReg(name),me=arguments.callee,reg=me.reg||(me.reg=/\s+/);return isReg||(arr2=(name+"").split(reg)).length?this.each((function(o){if(ok=0,arr=xui.Dom._getClass(o).split(reg),isReg)xui.filter(arr,(function(o,i){if(name.test(o))return ok=1,!1}));else for(i=0,l=arr2.length;i<l;i++)-1!=xui.arr.indexOf(arr,arr2[i])&&(ok=1,xui.arr.removeValue(arr,arr2[i]));ok&&xui.Dom._setClass(o,arr.join(" "))})):this},replaceClass:function(regexp,replace){var n,r;return this.each((function(o){r=(n=xui.Dom._getClass(o)).replace(regexp,replace),n!=r&&xui.Dom._setClass(o,r)}))},tagClass:function(tag,isAdd){var self=this,me=arguments.callee,r1=me["_r1_"+tag]||(me["_r1_"+tag]=new RegExp("([-\\w]+"+tag+"[-\\w]*)")),r2=me._r2||(me._r2=/([-\w]+)/g);self.removeClass(r1);var r=(isAdd=!1!==isAdd)?self.replaceClass(r2,"$1 $1"+tag):self;return!xui.__iefix2||"-checked"!=tag&&"-fold"!=tag&&"-expand"!=tag||this.each((function(n){var arr=xui.Dom._getClass(n).split(/\s+/);-1==xui.arr.indexOf(arr,"xuifont")&&-1==xui.arr.indexOf(arr,"xuicon")||xui.arr.each(arr,(function(s){if(xui.__iefix2[s+(isAdd?"":tag)]&&xui.__iefix2[isAdd?s.replace(new RegExp(tag+"$"),""):s])return xui(n).html(xui.__iefix2[s.replace(new RegExp(tag+"$"),"")+(isAdd?tag:"")]),!1}))})),r},$addEventHandler:function(name){var type,event=xui.Event,handler=event.$eventhandler;return this.each((function(o){3!=o.nodeType&&(xui.setNodeData(o,["eHandlers","on"+event._eventMap[name]],handler),(type=event._eventHandler[name])&&(xui.setNodeData(o,["eHandlers",type],handler),event._addEventListener(o,event._eventMap[name],handler),xui.browser.isTouch&&"onmousedown"==type&&(xui.setNodeData(o,["eHandlers","onxuitouchdown"],handler),event._addEventListener(o,"xuitouchdown",handler))))}))},$removeEventHandler:function(name){var type,event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3;return this.each((function(o){(type=event._eventHandler[name])&&(event._removeEventListener(o,type,handler),event._removeEventListener(o,type,handler3),xui.browser.isTouch&&"onmousedown"==type&&event._removeEventListener(o,"xuitouchdown",handler)),(o=xui.getNodeData(o,"eHandlers"))&&(delete o[type="on"+event._eventMap[name]],xui.browser.isTouch&&"onmousedown"==type&&delete o.onxuitouchdown)}))},$addEvent:function(name,fun,label,index){var id,c,t,k,m,event=xui.Event,arv=xui.arr.removeValue,ari=xui.arr.insertAny;return index||0===index||(index=-1),label="string"==typeof label?"$"+label:undefined,this.$addEventHandler(name).each((function(o){3!=o.nodeType&&((id=event.getId(o))||o===window||o===document||(id=o.id=xui.Dom._pickDomId()),(c=xui.$cache.profileMap[id])||(c=new xui.DomProfile(id)),t=c.events||(c.events={}),m=t[name]||(t[name]=[]),label===undefined&&(m.length=0,m=t[name]=[],index=-1,label="_"),m[label]=fun,arv(m,label),-1==index?m[m.length]=label:ari(m,label,index),xui.Event&&(c=xui.Event._getProfile(id))&&(t=c.$_egetter)&&(k=t[id+"+"+name])&&(k.length=0,delete t[id+"+"+name]))})),this},$removeEvent:function(name,label,bAll){var c,t,k,id,event=xui.Event,dom=xui.$cache.profileMap,type=event._eventMap[name];return this.each((function(o){(id=event.getId(o))&&(c=dom[id])&&(t=c.events)&&(bAll?xui.arr.each(event._getEventName(type),(function(o){delete t[o]})):"string"==typeof label?(label="$"+label,(k=t[name])&&(delete k[label],-1!=xui.arr.indexOf(k,label)&&xui.arr.removeValue(k,label))):delete t[name],xui.Event&&(c=xui.Event._getProfile(id))&&(t=c.$_egetter)&&(k=t[id+"+"+name])&&(k.length=0,delete t[id+"+"+name]))})),this},$getEvent:function(name,label){var id;if(id=xui.Event.getId(this.get(0))){if(label)return xui.get(xui.$cache.profileMap,[id,"events",name,"$"+label]);var r=[],arr=xui.get(xui.$cache.profileMap,[id,"events",name]);return xui.arr.each(arr,(function(o,i){r[r.length]={o:arr[o]}})),r}},$clearEvent:function(){return this.each((function(o,i){var type,event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3;(i=event.getId(o))&&(i=xui.$cache.profileMap[i])&&(i.events&&(xui.each(i.events,(function(f,name){(type=xui.Event._eventMap[name])&&(event._removeEventListener(o,type,handler),event._removeEventListener(o,type,handler3))})),xui.breakO(i.events,2),delete i.events),xui.set(xui.$cache.domPurgeData,[o.$xid,"eHandlers"],{}))}))},$fireEvent:function(name,args){var handler,hash,type=xui.Event._eventMap[name],s="on"+type,me=arguments.callee,f1=(xui.Event.$eventhandler,me.f1||(me.f1=function(){this.returnValue=!1})),f2=me.f2||(me.f2=function(){this.cancelBubble=!0});return this.each((function(o){if(handler=xui.getNodeData(o,["eHandlers",s]))if("blur"==type||"focus"==type)try{o[type]()}catch(e){}else hash=xui.copy(args),xui.merge(hash,{type:type,target:o,button:1,$xuievent:!0,$xuitype:name,preventDefault:f1,stopPropagation:f2},"all"),handler.call(o,hash)}))},nativeEvent:function(name){return this.each((function(o){if(3!==o.nodeType&&8!==o.nodeType)try{o[name]()}catch(e){}}))},$canFocus:function(){var t,node,me=arguments.callee,getStyle=xui.Dom.getStyle,map=me.map||(me.map={a:1,input:1,select:1,textarea:1,button:1,object:1});return!!((node=this.get(0))&&node.focus&&((t=map[node.nodeName.toLowerCase()])&&!(parseInt(node.tabIndex,10)<=-1)||!t&&parseInt(node.tabIndex,10)>=(xui.browser.ie?1:0))&&"none"!=getStyle(node,"display")&&"hidden"!=getStyle(node,"visibility")&&node.offsetWidth>0&&node.offsetHeight>0)},focus:function(force){if(force||this.$canFocus())try{this.get(0).focus()}catch(e){}return this},blur:function(){var n=this.get(0);n&&(n.blur(),document.activeElement===n&&xui.asyRun((function(){xui("body").append(n=xui.create("<button style='position:absolute;width:1px;height:1px;left:-1000px;'></button>")),n.focus(),n.remove()})))},setSelectable:function(value){return this.removeClass("xui-ui-selectable").removeClass("xui-ui-unselectable"),this.addClass(value?"xui-ui-selectable":"xui-ui-unselectable"),this.each((function(o){xui.browser.ie&&xui.browser.ver<10&&xui.setNodeData(o,"_onxuisel",value?"true":"false")}))},contentBox:function(d){return xui.browser.ie||xui.browser.opr?!/BackCompat|QuirksMode/.test((d||document).compatMode):"content-box"==(this.css("box-sizing")||this.css("-moz-box-sizing"))},setInlineBlock:function(){var ns=this;return xui.browser.gek?xui.browser.ver<3?ns.css("display","-moz-inline-block").css("display","-moz-inline-box").css("display","inline-block"):ns.css("display","inline-block"):xui.browser.ie&&xui.browser.ver<=6?ns.css("display","inline-block").css({display:"inline",zoom:"1"}):ns.css("display","inline-block"),ns},topZindex:function(flag){var k,t,o,style,i=1e3,j=0,node=this.get(0),p=node.offsetParent||node.parentNode;if(!xui.browser.ie||p&&"HTML"!=(p.nodeName+"").toUpperCase()||(p=xui("body").get(0)),1!=node.nodeType||!p)return 1;for(t=p.childNodes,k=0;o=t[k];k++)style=o.style,o==node||1!=o.nodeType||!o.$xid||style&&"none"==style.display||style&&"hidden"==style.visibility||o.zIndexIgnore||xui.getNodeData(o,"zIndexIgnore")||(i=i>(j=parseInt(style&&style.zIndex,10)||0)?i:j);return++i>=xui.Dom.TOP_ZINDEX&&(xui.Dom.TOP_ZINDEX=i+1),flag?(node.style.zIndex=i,this):i>(j=parseInt(node.style.zIndex,10)||0)?i:j},nextFocus:function(downwards,includeChild,setFocus,pattern){downwards=!xui.isBool(downwards)||downwards;var self=this.get(0),node=this.$iterator("",downwards,includeChild,(function(node){return node!==self&&(!pattern||node.id&&pattern.test(node.id))&&xui([node]).$canFocus()}));return node.isEmpty()||!1===setFocus||node.focus(),self=null,node},fullScreen:function(full){var e=this.get(0),d=document;if(e){e===d&&(e=d.documentElement);var requestMethod=!1!==full?e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen:d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.webkitExitFullscreen;if(requestMethod)requestMethod.call(!1!==full?e:d);else if("undefined"!=typeof window.ActiveXObject){var wscript=new ActiveXObject("WScript.Shell");null!==wscript&&wscript.SendKeys("{F11}")}}},animate:function(endpoints,onStart,onEnd,duration,step,type,threadid,unit,restore,times,_goback){var self=this,map={left:1,top:1,right:1,bottom:1,width:1,height:1},prf=xui.$cache.profileMap[self.id()],ctrl=prf?prf["xui.DomProfile"]?xui(prf):prf.boxing():null,css=xui.CSS,tween=xui.Dom.$AnimateEffects,_get=function(node,ctrl,key,t){return map[key]&&ctrl&&xui.isFun(ctrl[t="get"+xui.str.initial(key)])?ctrl[t](key):node[key]?node[key]():node.css(key)};if(endpoints){xui.each(endpoints,(function(o,i){xui.isFun(o)||(xui.isArr(o)&&1!==o.length||(o=[_get(self,ctrl,i),o]),endpoints[i]=o)}));var parmsBak=endpoints;endpoints=xui.clone(endpoints),duration=(step||0)>0?16*step:duration||200,times=times||1,-1!=(type||"").indexOf("-")&&(type=type.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()}))),type=type in tween?type:"circIn";var starttime,node=self.get(0),fun=function(tid){var curvalue,u,eu,su,s,e,offtime=xui.stamp()-starttime;if(offtime>=duration&&(offtime=duration),xui.each(endpoints,(function(o,i){curvalue=tween[type](duration,offtime),"function"==typeof o?o.call(self,curvalue):(s=o[0],e=o[1],u=o[2],xui.str.endWith(i.toLowerCase(),"color")?curvalue=function(from,to,curvalue){return"string"!=typeof from||"string"!=typeof to?"#fff":curvalue<0?from:curvalue>1?to:(from=(f=function(str){return"#"!=str.charAt(0)?"#"+str:str})(from),to=f(to),f1=function(str,i,j){return parseInt(str.slice(i,j),16)||0},"#"+(f3=function(from,to,value,c){var r=from[c]+Math.round(parseFloat(value*(to[c]-from[c]))||0);return(r<16?"0":"")+r.toString(16)})(from=(f2=function(o){return{red:f1(o,1,3),green:f1(o,3,5),blue:f1(o,5,7)}})(from),to=f2(to),curvalue,"red")+f3(from,to,curvalue,"green")+f3(from,to,curvalue,"blue"));var f,f1,f2,f3}(s,e,curvalue):(xui.isFinite(e)||(u=e.replace(/[-\d.]*/,""),eu=u||"px",xui.isFinite(s)||(su=s.replace(/[-\d.]*/,"")||"px")!=eu&&("em"==su&&"px"==eu?s=css.$em2px(s,node):"px"==su&&"em"==eu&&(s=css.$px2em(s,node)))),s=parseFloat(s)||0,e=parseFloat(e)||0,curvalue=xui.toFixedNumber(s+(e-s)*curvalue,6)),function(node,ctrl,key,value,t){map[key]&&ctrl&&xui.isFun(ctrl[t="set"+xui.str.initial(key)])?ctrl[t](value):node[key]?node[key](value):node.css(key,value)}(self,ctrl,i,curvalue+=u||unit||""))})),offtime==duration)return restore&&!_goback?(starttime=xui.stamp(),_goback=1,xui.each(endpoints,(function(v,k){xui.isFun(v)||(k=v[0],v[0]=v[1],v[1]=k)}))):(-1==times||times>0)&&(starttime=xui.stamp(),times>0&&(times-=1),_goback&&(_goback=0,xui.each(endpoints,(function(v,k){xui.isFun(v)||(k=v[0],v[0]=v[1],v[1]=k)})))),times||xui.Thread.abort(tid,"normal"),!1},funs=[fun],tid=xui.getNodeData(node,"_inthread");tid&&xui.Thread.isAlive(tid)&&(xui.Thread.abort(tid,"force"),xui.setNodeData(node,"_inthread",null));var reset=xui.getNodeData(node,"_animationreset");return"function"==typeof reset&&(reset(),xui.setNodeData(node,"_animationreset",null)),xui.Thread(!threadid||xui.Thread.get(threadid)?xui.id():threadid,funs,0,null,(function(tid){return xui.setNodeData(node,"_inthread",tid),starttime=xui.stamp(),xui.setNodeData(node,"_animationreset",(function(){xui.merge(endpoints,parmsBak,"all"),starttime=xui.stamp(),fun()})),xui.tryF(onStart,arguments,this)}),(function(tid,flag){node&&node.$xid&&(xui.setNodeData(node,"_inthread",null),xui.setNodeData(node,"_animationreset",null)),"force"!=flag&&xui.tryF(onEnd,arguments,this)}),!0)}onEnd&&xui.tryF(onEnd)},pop:function(pos,type,parent,trigger,group){var ns=this,id=xui.stamp()+":"+ns.xid();return ns.popToTop(pos,type||"outer",parent).setBlurTrigger(id,(function(){"function"==typeof trigger?xui.tryF(trigger):ns.hide()})),id},popUp:function(pos,type,parent,trigger,group){return this.pop.apply(this,arguments)},popToTop:function(pos,type,parent,callback,showEffects,ignoreEffects){return(parent=xui(parent)).isEmpty()&&(parent=xui("body")),this.css({position:"absolute",display:"block",zIndex:xui.Dom.TOP_ZINDEX++,visibility:"hidden"}),parent.append(this),pos&&this.cssPos(xui.Dom.getPopPos(pos,type,this,parent)),this.css({visibility:"visible"}),this.removeClass("xui-ui-hidden"),(showEffects=ignoreEffects?null:showEffects||xui.get(xui.UIProfile.getFromDom(this),["properties","showEffects"]))&&(showEffects=xui.Dom._getEffects(showEffects,1)),showEffects?xui.Dom._vAnimate(this,showEffects,callback):callback&&callback(),this},hoverPop:function(node,type,beforePop,beforeHide,parent,groupid,showEffects,hideEffects){node=xui(node),showEffects&&(showEffects=xui.Dom._getEffects(showEffects,1)),hideEffects&&(hideEffects=xui.Dom._getEffects(hideEffects,0)),xui.isDefined(type)||(type="outer");var aysid=groupid||this.xid()+":"+node.xid(),self=this;return this.onMouseover(null===type?null:function(prf,e,src){e.$force||(xui.resetRun(aysid,null),xui.getData([aysid,"$ui.hover.pop"])&&xui.getNodeData(node.get(0)||"empty","$ui.hover.parent")==src||(xui.setData([aysid,"$ui.hover.pop"],1),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",src),beforePop&&!1===beforePop(prf,node,e,src)||(node.popToTop(src,type,parent,showEffects),node.onMouseover((function(){self.onMouseover(!0)}),"hoverPop").onMouseout((function(){self.onMouseout(!0)}),"hoverPop"))))},aysid).onMouseout(null===type?null:function(prf,e,src){e.$force||xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0),beforeHide&&!1===beforeHide(prf,node,e,src,"host")||(node.hide(null,hideEffects),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))}))},aysid),node&&node.onMouseover(null===type?null:function(e){e.$force||xui.resetRun(aysid,null)},aysid).onMouseout(null===type?null:function(prf,e,src){e.$force||xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0),beforeHide&&!1===beforeHide(prf,node,e,src,"pop")||(node.hide(null,hideEffects),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))}))},aysid),node.css("display","none"),this},setBlurTrigger:function(id,trigger,group,checkChild,triggerNext){var target,doc=document,fun=xui.Dom._blurTrigger||(xui.Dom._blurTrigger=function(prf,e){var b,pos,w,h,v,p=xui.Event.getPos(e),arr=arguments.callee.arr,srcN=xui.Event.getSrc(e),a=xui.copy(arr);xui.arr.each(a,(function(i){b=!0,(v=arr[i].target)?v.each((function(o){if(o!==window&&o!==document&&!xui.Dom.byId(o.id))return b=!1})):b=!1,b||(delete arr[i],xui.arr.removeValue(arr,i))})),a=xui.copy(arr),xui.arr.each(a,(function(i){if(v=arr[i]){b=!0;var isChild=function(){for(var nds=v.target.get();srcN&&srcN.nodeName&&"BODY"!=srcN.nodeName&&"HTML"!=srcN.nodeName;){if(-1!=xui.arr.indexOf(nds,srcN))return!0;srcN=srcN.parentNode}};if(v.checkChild&&!isChild()||v.target.each((function(o){if(o.parentNode&&(w=o.offsetWidth)&&(h=o.offsetHeight)&&(pos=xui([o]).offset(),p.left>=pos.left&&p.top>=pos.top&&p.left<=pos.left+w&&p.top<=pos.top+h))return b=!1})),isChild=null,!b&&!xui.isFun(v.trigger))return!1;if(b)delete arr[i],xui.arr.removeValue(arr,i),xui.tryF(v.trigger,[p,e],v.target),v=null;else if(v.stopNext)return!1}}),null,!0),srcN=null,a.length=0}),arr=fun.arr||(fun.arr=[]);return arr[id]&&(!0===trigger&&(xui.tryF(arr[id].trigger),trigger=!1),delete arr[id],xui.arr.removeValue(arr,id)),trigger&&(group?(group["xui.Dom"]?target=group:xui.isArr(group)&&((target=xui())._nodes=group),target.merge(this)):target=this,target.each((function(o){o.id||o===window||o===document||(o.id=xui.Dom._pickDomId())})),arr[id]={trigger:trigger,target:target,checkChild:!!checkChild,stopNext:!triggerNext},arr.push(id),doc.onmousedown||(doc.onmousedown=xui.Event.$eventhandler),doc=fun=null),this},$firfox2:function(){if(!xui.browser.gek2)return this;var ns=this;return ns.css("overflow","hidden"),xui.asyRun((function(){ns.css("overflow","auto")})),ns},ieRemedy:function(){if(xui.browser.ie&&xui.browser.ver<=6){for(var style,a1=this.get(),a2=[],a3=[],l=a1.length,i=0;i<l;i++)style=a1[i].style,xui.isSet(a1[i].$ieRemedy)||xui.isSet(style.width)&&(a1[i].$ieRemedy=style.width,style.width=(xui.CSS.$px(a1[i].$ieRemedy,a1[i])||0)+1+"px");xui.asyRun((function(){for(var i=0;i<l;i++)xui.isSet(a1[i].$ieRemedy)&&(a1[i].style.width=a1[i].$ieRemedy,a1[i].removeAttribute("$ieRemedy"));a1.length=a2.length=a3.length=0}))}return this}},Static:{HIDE_VALUE:"-10000px",TOP_ZINDEX:1e4,_boxArr:xui.toArr("width,height,left,top,right,bottom"),_cursor:{},_pickDomId:function(){var id;do{id="xui_"+xui.id()}while(document.getElementById(id));return id},_map:{html:1,head:1,body:1},fixPng:function(n){if(xui.browser.ie&&xui.browser.ver<=6){if("IMG"==n.nodeName&&-1!=n.src.toLowerCase().search(/\.png$/)){var style=n.style;style.height=n.height,style.width=n.width,style.backgroundImage="none";var t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+n.src+"', sizingMethod='image')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", ");xui.browser.ie8&&(style.msfilter=t),style.filter=t,n.src=xui.ini.img_bg}var bgmatch=(n.currentStyle.backgroundImage||style.backgroundImage||"").toLowerCase().match(/^url[("']+(.*\.png[^\)"']*)[\)"']+[^\)]*$/i);bgmatch&&(style.backgroundImage="none",t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+bgmatch[1]+"', sizingMethod='crop')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", "),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}},_getTag:function(n){return n?n.$xid?n.$xid:1==n.nodeType?xui.$registerNode(n).$xid:0:0},_ensureValues:function(obj){var t,i,map=this._map,a=[],arr=obj===window?["!window"]:obj===document?["!document"]:xui.isArr(obj)?obj:"[object NodeList]"==obj||"[object HTMLCollection]"==obj?xui.toArr(obj):obj["xui.Dom"]?obj._nodes:obj._toDomElems?obj._toDomElems():"function"==typeof obj?obj():[obj];for(i=0;i<arr.length;i++)(t=(t=arr[i])?t===window?"!window":t===document?"!document":"string"==typeof t||t["xui.DomProfile"]&&(t=t.domId)?"!"==t.charAt(0)?t:this._getTag(map[t]?document.getElementsByTagName(t)[0]:document.getElementById(t)):(t=arr[i])["xui.UIProfile"]||t["xui.Template"]?(t.renderId||t.boxing().render())&&t.renderId:this._getTag(t):0)&&(a[a.length]=t);return a.length<=1?a:this._unique(a)},_getClass:function(o){return"string"==typeof o.className&&o.className||"string"==typeof o.className.baseVal&&o.className.baseVal||"undefined"!=typeof o.getAttribute&&o.getAttribute("class")||""},_setClass:function(o,v){"string"==typeof o.className?o.className=v:"string"==typeof o.className.baseVal?o.className.baseVal=v:"undefined"!=typeof o.getAttribute&&o.setAttribute(v)},getPopPos:function(pos,type,target,parent){var result={left:0,top:0};if(pos){if(xui.isEvent(pos))return xui.Event.getPos(pos);var region,node,abspos,t,box;if((parent=xui(parent)).isEmpty()&&(parent=xui("body")),pos["xui.UI"]||pos["xui.UIProfile"]||pos["xui.Dom"]||1==pos.nodeType||"string"==typeof pos?("function"!=typeof type&&(type=(type||12)+""),abspos=(node=xui(pos)).offset(null,parent),region={left:abspos.left,top:abspos.top,width:node.offsetWidth(),height:node.offsetHeight()}):("function"!=typeof type&&(type=type?"3":"0"),t="0"==type?0:8,region=pos.region||{left:pos.left-t,top:pos.top-t,width:2*t,height:2*t}),t=parent.get(0)===document.body||parent.get(0)===document||parent.get(0)===window?xui.win:parent,(box={}).left=t.scrollLeft(),box.top=t.scrollTop(),box.width=t.width()+box.left,box.height=t.height()+box.top,t==xui.win&&xui.ini.$zoomScale)for(var i in box)box[i]/=xui.ini.$zoomScale;if("function"==typeof type)result=type(region,box,target,t);else{var a=type.split(":"),w=target?target.offsetWidth():0,h=target?target.offsetHeight():0,arr=a[0].split(/-/g),border=parseInt(a[1])||0;if(type=a[0],2==arr.length){var hp=arr[0];switch(arr[1]){case"outertop":result.top=region.top-h;break;case"top":result.top=region.top;break;case"middle":result.top=region.top+region.height/2-h/2;break;case"bottom":result.top=region.top+region.height-h;break;default:result.top=region.top+region.height}switch(hp){case"outerleft":result.left=region.left-w;break;case"left":result.left=region.left;break;case"center":result.left=region.left+region.width/2-w/2;break;case"right":result.left=region.left+region.width-w;break;default:result.left=region.left+region.width}}else{var adjust=function(type){var hi,wi;switch(type){case"2":hi=!0,wi=!1;break;case"3":hi=wi=!1;break;case"4":hi=wi=!0;break;default:hi=!1,wi=!0}hi?region.top+h<box.height?result.top=region.top:result.top=region.top+region.height-h:region.top+region.height+h<box.height?result.top=region.top+region.height:result.top=region.top-h,wi?region.left+w<box.width?result.left=region.left:result.left=region.left+region.width-w:region.left+region.width+w<box.width?result.left=region.left+region.width:result.left=region.left-w,result.left+w>box.width&&(result.left=box.width-w),result.left<box.left&&(result.left=box.left),result.top+h>box.height&&(result.top=box.height-h),result.top<box.top&&(result.top=box.top)};"12"==(type="inner"==type?"4":"outer_tb"==type?"1":"outer_lr"==type?"2":"outer"==type?"12":type)?(adjust("1"),result.top<region.top+region.height&&result.top+h>region.top&&adjust("2")):"21"==type?(adjust("2"),result.left<region.left+region.width&&result.left+w>region.left&&adjust("1")):adjust(type)}border&&(result.left+=border,result.top+=border,result.width-=2*border,result.height-=2*border)}return result}return result},_scrollBarSize:0,getScrollBarSize:function(force){var div;return!force&&this._scrollBarSize||(xui("body").append(div=xui.create('<div style="width:50px;height:50px;visibility:hidden;position:absolute;margin:0;padding:0;left:-100%;top:-100%;overflow:scroll;"></div>')),this._scrollBarSize=div.get(0).offsetWidth-div.get(0).clientWidth,div.remove()),this._scrollBarSize},_dpi:0,getDPI:function(force){var div;return!force&&this._dpi||(xui("body").append(div=xui.create('<div style="width:1in;height:1in;visibility:hidden;position:absolute;margin:0;padding:0;left:-100%;top:-100%;overflow:scroll;"></div>')),this._dpi=div.get(0).offsetHeight,div.remove()),this._dpi},getStyle:function(node,name,force){if(!node||1!=node.nodeType)return"";if("rotate"==name)return xui(node).rotate();var value,b,ns=xui.Dom,css3prop=xui.Dom._css3prop,style=node.style;if("opacity"==name&&!ns.css3Support("opacity")&&xui.browser.ie&&(b=name="filter"),value=style[name],force||!value||"initial"===value){var t,name3,name4,me=xui.Dom.getStyle,brs=xui.browser,map=me.map||(me.map={float:1,cssFloat:1,styleFloat:1}),c1=me._c1||(me._c1={}),c2=me._c2||(me._c2={}),name1=(me._c3||(me._c3={}),c1[name]||(c1[name]=name.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})))),name2=c2[name1]||(c2[name1]=name1.replace(/([A-Z])/g,"-$1").toLowerCase()),n1=name1;if(0===n1.indexOf("border")&&(n1=n1.replace(/[-]?(left|top|right|bottom)/gi,"")),-1!=xui.arr.indexOf(css3prop,n1)){if(!ns.css3Support(name1))return"";"textShadow"!=name1&&(name3=brs.cssTag2+name2.charAt(0).toUpperCase()+name2.substr(1),name4=brs.cssTag1+name2)}map[name1]&&(name1=xui.browser.ie?"styleFloat":"cssFloat"),value=(t=document.defaultView)&&t.getComputedStyle?(t=t.getComputedStyle(node,null))?t.getPropertyValue(name2)||name4&&t.getPropertyValue(name4):"":node.currentStyle?node.currentStyle[name1]||node.currentStyle[name2]||name3&&(node.currentStyle[name3]||node.currentStyle[name4]):style&&(style[name1]||name3&&style[name3])||""}return!b&&xui.browser.ie678&&(("fontSize"==name||"font-size"==name2)&&/%/.test(value)&&node.parentNode?value=(node.parentNode.currentStyle[name]||node.parentNode.currentStyle[name2])*(parseFloat(value)||0):xui.CSS.$isEm(value)&&(value=xui.CSS.$px(value,node))),b?value?(parseFloat(value.match(/alpha\(opacity=(.*)\)/)[1])||0)/100:1:value||""},$getBoundingClientRect:function(node,original){var t,rect=node.getBoundingClientRect();if(!original&&(t=xui.ini.$transformScale))for(var i in rect)rect[i]/=t;return rect},$transformIE:function(node,value){var style=node.style,t=(style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Matrix\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "));if(xui.browser.ie8&&(style.msfilter=t),style.filter=t,style.marginTop=style.marginLeft="",value){var tmatrix=function(){var current,degRat=Math.PI/180,matrix=function(m11,m12,m21,m22,dx,dy){var m={};return m.m11=xui.isSet(m11)?parseFloat(m11):1,m.m12=xui.isSet(m12)?parseFloat(m12):0,m.m21=xui.isSet(m21)?parseFloat(m21):0,m.m22=xui.isSet(m22)?parseFloat(m22):1,m.dx=xui.isSet(dx)?parseFloat(dx):0,m.dy=xui.isSet(dy)?parseFloat(dy):0,m},multiply=function(newMatrix,currentMatrix){var m={};return m.m11=roundNumber(newMatrix.m11*currentMatrix.m11+newMatrix.m21*currentMatrix.m12,10),m.m12=roundNumber(newMatrix.m12*currentMatrix.m11+newMatrix.m22*currentMatrix.m12,10),m.m21=roundNumber(newMatrix.m11*currentMatrix.m21+newMatrix.m21*currentMatrix.m22,10),m.m22=roundNumber(newMatrix.m12*currentMatrix.m21+newMatrix.m22*currentMatrix.m22,10),m.dx=roundNumber(currentMatrix.dx+newMatrix.dx,10),m.dy=roundNumber(currentMatrix.dy+newMatrix.dy,10),m},deg2rad=function(deg){return degRat*deg},roundNumber=function(num,dec){return Math.round(num*Math.pow(10,dec))/Math.pow(10,dec)};this.rotate=function(deg){var rad=xui.isSet(deg)?parseFloat(deg2rad(parseFloat(deg))):0,m=matrix(Math.cos(rad),-Math.sin(rad),Math.sin(rad),Math.cos(rad),0,0);current=multiply(m,current)},this.translate=function(x,y){var m=matrix(1,0,0,1,parseFloat(x),parseFloat(y));current=multiply(m,current)},this.translateX=function(x){this.translate(x,0)},this.translateY=function(y){this.translate(0,y)},this.scale=function(x,y){var m=matrix(xui.isSet(x)?parseFloat(x):1,0,0,xui.isSet(y)?parseFloat(y):1,0,0);current=multiply(m,current)},this.scaleX=function(x){this.scale(x,1)},this.scaleY=function(y){this.scale(1,y)},this.skew=function(xAng,yAng){xAng=xui.isSet(xAng)?parseFloat(deg2rad(parseFloat(xAng))):0,yAng=xui.isSet(yAng)?parseFloat(deg2rad(parseFloat(yAng))):0;var m=matrix(1,Math.tan(xAng),Math.tan(yAng),1,0,0);current=multiply(m,current)},this.skewX=function(xAng){this.skew(xAng,0)},this.skewY=function(yAng){this.skew(0,yAng)},this.matrix=function(m11,m12,m21,m22,dx,dy){current=multiply(matrix(m11,m12,m21,m22,dx,dy),current)},this.getMatrix=function(){return current},this.getFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+current.m11+", M12="+current.m12+", M21="+current.m21+", M22="+current.m22+", Dx="+current.dx+", Dy="+current.dy+", SizingMethod='auto expand')"},this.getX=function(){return current.dx},this.getY=function(){return current.dy},this.reset=function(){current=matrix(1,0,0,1,0,0)},this.reset()},matrix=function(transform){for(var m=new tmatrix,functions=transform.match(/[A-z]+\([^\)]+/g)||[],k=0;k<functions.length;k++){var values,arr=functions[k].split("("),func=arr[0],value=arr[1];switch(func){case"rotate":m.rotate(value);break;case"scale":values=value.split(","),m.scale(values[0],values[1]);break;case"scaleX":m.scaleX(value);break;case"scaleY":m.scaleY(value);break;case"skew":values=value.split(","),m.skew(values[0],values[1]);break;case"skewX":m.skewX(value);break;case"skewY":m.skewY(value);break;case"translate":values=value.split(","),m.translate(values[0],values[1]);break;case"translateX":m.translateX(value);break;case"translateY":m.translateY(value)}}return m}(value),ow=node.offsetWidth,oh=node.offsetHeight,filter=matrix.getFilter();if(t=((style.filter?style.filter+",":"")+filter).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t,node.getBoundingClientRect){var transX=matrix.getX(),transY=matrix.getY(),rect=xui.Dom.$getBoundingClientRect(node),w=rect.right-rect.left,h=rect.bottom-rect.top;style.marginLeft=Math.round(parseFloat((ow-w)/2+10+transX))+"px",style.marginTop=Math.round(parseFloat((oh-h)/2+10+transY))+"px"}style.transform=value}},$textShadowIE:function(node,value,box){var style=node.style;if(value){f=function(x,y,r,c){return(box?"":"progid:DXImageTransform.Microsoft.Chroma(Color=#cccccc) ")+"progid:DXImageTransform.Microsoft.DropShadow(Color="+c+", OffX="+x+", OffY="+y+") "+(parseFloat(r)>0?"progid:DXImageTransform.Microsoft.Glow(Strength="+r+", Color="+c+")":"")};var r=value.match(/([\d\.-]+)px\s+([\d\.-]+)px(\s+([\d\.-]+)px)?(\s+([#\w]+))?/);if(r){var t=((style.filter?style.filter+",":"")+f(r[1],r[2],r[4],r[6]||"#000000")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "));xui.browser.ie8&&(style.msfilter=t),style.filter=t,box||(style.backgroundColor="#C5C5C5")}}else{var f=function(s){return(s||"").replace(/progid:DXImageTransform\.Microsoft\.(Chroma|DropShadow|Glow)\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "))},s1=style.filter;s1&&(xui.browser.ie8&&(style.msfilter=f(s1)),style.filter=f(s1)),box||(style.backgroundColor="")}},$setGradients:function(node,value,xb){xb=xb||xui.browser;var ns=this,ver=xb.ver,c16="0123456789ABCDEF",_toFF=function(n,b){return n=parseInt(n*b,10)||0,c16.charAt(((n=n>255||n<0?0:n)-n%16)/16)+c16.charAt(n%16)},_to255=function(s){return s=s.split(""),16*c16.indexOf(s[0].toUpperCase())+c16.indexOf(s[1].toUpperCase())};window.btoa=window.btoa||function(text){if(!/([^\u0000-\u00ff])/.test(text)){for(var cur,prev,byteNum,table="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,result=[];i<text.length;){switch(cur=text.charCodeAt(i),byteNum=(i+1)%3){case 1:result.push(table.charAt(cur>>2));break;case 2:result.push(table.charAt((3&prev)<<4|cur>>4));break;case 0:result.push(table.charAt((15&prev)<<2|cur>>6)),result.push(table.charAt(63&cur))}prev=cur,i++}return 1==byteNum?(result.push(table.charAt((3&prev)<<4)),result.push("==")):2==byteNum&&(result.push(table.charAt((15&prev)<<2)),result.push("=")),result.join("")}};var svgcracker1=function(node,orient,stops,shape,size,rate){if(orient){rate=rate||1;var id="svg:"+xui.id(),cx="0%",cy="0%",r=100*rate+"%";if(xui.isObj(orient))cx=orient.left||cx,cy=orient.left||cy;else switch(orient){case"T":cx="50%",cy="0%";break;case"B":cx="50%",cy="100%";break;case"L":cx="0%",cy="50%";break;case"R":cx="100%",cy="50%";break;case"LT":cx="0%",cy="0%";break;case"RT":cx="100%",cy="0%";break;case"RB":cx="100%",cy="100%";break;case"LB":cx="0%",cy="100%";break;case"C":cx="50%",cy="50%"}for(var svg='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><radialGradient id="'+id+'" gradientUnits="userSpaceOnUse" cx="'+cx+'" cy="'+cy+'" r="'+r+'">',i=0,l=stops.length;i<l;i++)svg+='<stop stop-color="'+stops[i].clr+'" offset="'+stops[i].pos+'" '+(xui.isSet(stops[i].opacity)?' stop-opacity="'+stops[i].opacity+'"':"")+" />";svg+='</radialGradient><rect x="-50" y="-50" width="101" height="101" fill="url(#'+id+')" /></svg>',node.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(svg)+'")'}else node.style.backgroundImage=""},type=value?(value.type||value||"linear").toLowerCase():null,rate=value?value.rate||1:null,shape=value?(value.shape||"circle").toLowerCase():null,size=value?(value.size||"farthest-corner").toLowerCase():null,orient=value?value.orient:null,stops=value?value.stops:null;if("linear"!=type&&(type="radial"),stops){if(!(stops.length>1))return;xui.arr.stableSort(stops,(function(x,y){return(x=parseFloat(x.pos)||0)>(y=parseFloat(y.pos)||0)?1:x==y?0:-1}))}xb.ie678&&("linear"==type?function(node,orient,stops){var t;if(node&&1==node.nodeType&&node.style){var style=node.style;if(orient){var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ori=1;switch(stops[0].opacity&&(innerColor=innerColor.replace("#","#"+_toFF(stops[0].opacity,255))),stops[stops.length-1].opacity&&(outerColor=outerColor.replace("#","#"+_toFF(stops[stops.length-1].opacity,255))),orient){case"LT":case"RT":case"LB":case"RB":return void function(node,orient,stops){var t,id="xui.s-ie8gdfix";if(node&&1==node.nodeType&&node.style){var style=node.style,tmp1=ns.getStyle(node,"overflow"),tmp2=ns.getStyle(node,"display");if("hidden"!=tmp1&&ns.setStyle(node,"overflow","hidden"),"block"!=tmp2&&"relative"!=tmp2&&ns.setStyle(node,"display","relative"),orient){var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ew=node.offsetWidth||0,eh=node.offsetHeight||0,size=Math.min(ew,eh),xs=0,xe=size,ys=0,ye=size;switch(orient){case"LT":xs=0,ys=0,xe=size,ye=size;break;case"RT":xs=size,ys=0,xe=0,ye=size;break;case"LB":xs=0,ys=size,xe=size,ye=0;break;case"RB":xs=size,ys=size,xe=0,ye=0}var at=document.createElement("div"),s=at.style;at.id=id,s.position="absolute",s.zIndex="0",s.top=0,s.left=0,s.width=ew,s.height=eh,s.backgroundColor=innerColor;var starto=stops[0].opacity?100*parseFloat(stops[0].opacity):100;t=((s.filter?s.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(style=1, opacity="+starto+", finishopacity=0, startX="+xs+",finishX="+xe+",startY="+ys+",finishY="+ye+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(s.msfilter=t),s.filter=t,node.firstChild?node.insertBefore(at,node.firstChild):node.appendChild(at),style.backgroundColor=outerColor,stops[stops.length-1].opacity&&(t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+100*parseFloat(stops[stops.length-1].opacity)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}else{var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&a[i].id==id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops);case"L":ori=1;break;case"R":ori=1,t=innerColor,innerColor=outerColor,outerColor=t;break;case"T":ori=0;break;case"B":ori=0,t=innerColor,innerColor=outerColor,outerColor=t}t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Gradient(StartColorstr='"+innerColor+"',EndColorstr='"+outerColor+"',GradientType="+ori+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}else{t=(style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Gradient\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t;var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&"xui.s-ie8gdfix"==a[i].id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops):function(node,orient,stops,shape,size,rate){var t,id="xui.s-ie8gdfix";if(node&&1==node.nodeType&&node.style){var style=node.style,tmp1=ns.getStyle(node,"overflow"),tmp2=ns.getStyle(node,"display");if("hidden"==tmp1&&("block"==tmp2||"relative"==tmp2))if(orient){rate=rate||1;var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ew=node.offsetWidth||0,eh=node.offsetHeight||0,aw=ew*rate*2,ah=eh*rate*2;"circle"==shape&&(aw=ah=Math.min(aw,ah)),l=-aw/2;var w=aw,h=ah;if(t=-ah/2,xui.isObj(orient))l=orient.left||Math.round(parseFloat(l)||0)+"px",t=orient.top||Math.round(parseFloat(t)||0)+"px";else{switch(orient){case"LT":l=-aw/2,t=-ah/2;break;case"T":l=(ew-aw)/2,t=-ah/2;break;case"RT":l=ew-aw/2,t=-ah/2;break;case"L":l=-aw/2,t=(eh-ah)/2;break;case"C":l=(ew-aw)/2,t=(eh-ah)/2;break;case"R":l=ew-aw/2,t=(eh-ah)/2;break;case"LB":l=-aw/2,t=eh-ah/2;break;case"B":l=(ew-aw)/2,t=eh-ah/2;break;case"RB":l=ew-aw/2,t=eh-ah/2}l+="px",t+="px"}var at=document.createElement("div"),s=at.style;at.id=id,s.position="absolute",s.zIndex="0",s.top=t,s.left=l,s.width=Math.round(parseFloat(w)||0)+"px",s.height=Math.round(parseFloat(h)||0)+"px",s.backgroundColor=innerColor;var starto=stops[0].opacity?100*parseFloat(stops[0].opacity):100;t=((s.filter?s.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+starto+", finishopacity=0, style=2)").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(s.msfilter=t),s.filter=t,node.firstChild?node.insertBefore(at,node.firstChild):node.appendChild(at),style.backgroundColor=outerColor,stops[stops.length-1].opacity&&(t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+100*parseFloat(stops[stops.length-1].opacity)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}else{var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&a[i].id==id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops,shape,0,rate)),(xb.ie9||xb.opr&&ver<11.1)&&("linear"==type?function(node,orient,stops){if(orient){var id="svg"+xui.id(),x1="0%",y1="0%",x2="0%",y2="100%";switch(orient){case"T":x1="50%",y1="0%",x2="50%",y2="100%";break;case"B":x1="50%",y1="100%",x2="50%",y2="0%";break;case"L":x1="0%",y1="50%",x2="100%",y2="50%";break;case"R":x1="100%",y1="50%",x2="0%",y2="50%";break;case"LT":x1="0%",y1="0%",x2="100%",y2="100%";break;case"RT":x1="100%",y1="0%",x2="0%",y2="100%";break;case"RB":x2="0%",y2="0%",x1="100%",y1="100%";break;case"LB":x1="0%",y1="100%",x2="100%",y2="0%"}for(var svg='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><linearGradient id="'+id+'" gradientUnits="userSpaceOnUse" x1="'+x1+'" y1="'+y1+'" x2="'+x2+'" y2="'+y2+'">',i=0,l=stops.length;i<l;i++)svg+='<stop stop-color="'+stops[i].clr+'" offset="'+stops[i].pos+'" '+(xui.isSet(stops[i].opacity)?' stop-opacity="'+stops[i].opacity+'"':"")+"/>";svg+='</linearGradient><rect x="0" y="0" width="1" height="1" fill="url(#'+id+')" /></svg>',node.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(svg)+'")'}else node.style.backgroundImage=""}(node,orient,stops):svgcracker1(node,orient,stops,0,0,rate)),(xb.gek&&ver>=3.6||xb.isChrome&&ver>=10||xb.isSafari&&ver>=5.1||xb.ie&&ver>=10||xb.opr&&ver>=11.1)&&("linear"==type?function(node,orient,stops){var arr1=[],arr2=[],style=node.style;if(xui.arr.each(stops,(function(o){var clr=o.clr;xui.isSet(o.opacity)&&"#"==clr.charAt(0)&&(clr=clr.slice(1),clr="rgba("+_to255(clr.substr(0,2))+","+_to255(clr.substr(2,2))+","+_to255(clr.substr(4,2))+","+(parseFloat(o.opacity)||1)+")"),arr1.push(clr+" "+o.pos),xb.isWebKit&&arr2.push("color-stop("+o.pos+","+clr+")")})),orient){var direction="to bottom",directionmoz="top",directionwebkit="left top, left bottom";switch(orient){case"LT":direction="135deg",directionmoz="-45deg",directionwebkit="left top, right bottom";break;case"T":direction="to bottom",directionmoz="top",directionwebkit="left top, left bottom";break;case"RT":direction=directionmoz="-135deg",directionwebkit="right top, left bottom";break;case"L":direction="to right",directionmoz="left",directionwebkit="left top, right top";break;case"R":direction="to left",directionmoz="right",directionwebkit="right top, left top";break;case"LB":direction=directionmoz="45deg",directionwebkit="left bottom, right top";break;case"B":direction="to top",directionmoz="bottom",directionwebkit="left bottom, left top";break;case"RB":direction="-45deg",directionmoz="135deg",directionwebkit="right bottom, left top";break;default:direction=orient,directionmoz=orient,directionwebkit="left top, right bottom"}xb.isWebKit&&(style.backgroundImage="-webkit-gradient(linear,"+directionwebkit+", "+arr2.join(",")+")");var v1="linear-gradient({#},"+arr1.join(",")+")";xb.cssTag1&&(style.backgroundImage=xb.cssTag1+v1.replace("{#}",directionmoz)),style.backgroundImage=v1.replace("{#}",direction)}else style.backgroundImage=""}(node,orient,stops):xb.opr&&ver<12?svgcracker1(node,orient,stops,0,0,rate):function(node,orient,stops,shape,size,rate){var arr1=[],arr2=[],style=node.style;if(xui.arr.each(stops,(function(o){var clr=o.clr;xui.isSet(o.opacity)&&"#"==clr.charAt(0)&&(clr=clr.slice(1),clr="rgba("+_to255(clr.substr(0,2))+","+_to255(clr.substr(2,2))+","+_to255(clr.substr(4,2))+","+(parseFloat(o.opacity)||1)+")"),arr1.push(clr+" "+o.pos),xb.isWebKit&&arr2.push("color-stop("+o.pos+","+clr+")")})),orient){var position;if(xui.isObj(orient))position=orient.left+" "+orient.top;else switch(orient){case"LT":position="left top";break;case"T":position="center top";break;case"RT":position="right top";break;case"L":position="left center";break;case"C":position="center center";break;case"R":position="right center";break;case"LB":position="left bottom";break;case"B":position="center bottom";break;case"RB":position="right bottom";break;default:position="left top"}xb.isWebKit&&(style.backgroundImage="-webkit-gradient(radial,"+position+", 0px, "+position+", 100%,"+arr2.join(",")+")");var v1="radial-gradient("+position+","+shape+" "+size+","+arr1.join(",")+")";xb.cssTag1&&(style.backgroundImage=xb.cssTag1+v1),style.backgroundImage="radial-gradient("+size+" "+shape+" at "+position+","+arr1.join(",")+")"}else style.backgroundImage=""}(node,orient,stops,shape,size))},$setZoom:function(node,scale,transx,transy,origin){scale=parseFloat(scale),(xui.isNaN(scale)||scale<=0)&&(scale="");var b=xui.browser,h={};h[b.cssTag1+"transform"]=h.transform=""===scale?"":(xui.isNumb(transx)&&xui.isNumb(transy)?"translate("+transx+"px,"+transy+"px) ":"")+"scale("+scale+","+scale+")",h[b.cssTag1+"transform-origin"]=h["transform-origin"]=""===scale?"":origin||"0 0 0",xui(node).css(h)},_vAnimate:function(node,setting,callback){if(setting&&setting.endpoints&&!xui.isEmpty(setting.endpoints)){var endpoints=setting.endpoints,begin={},end={};return node=xui(node),xui.each(endpoints,(function(o,i){xui.isFun(o)||(begin[i]=o[0],end[i]=o[1])})),node.animate(endpoints,(function(threadid){node.css(begin)}),(function(threadid){node.css(end),callback&&xui.tryF(callback)}),setting.duration,0,setting.type).start()}callback&&xui.tryF(callback)},$adjustCss:function(hash,returnStr){var fack={nodeType:1,style:{}},style=fack.style;if(xui.Dom.setStyle(fack,hash),returnStr){var arr=[];return xui.browser.ie&&8==xui.browser.ver&&(style.filter&&(style["-ms-filter"]=style.filter),"none"==style["background-image"]&&(style["background-image"]="url(about:blank)")),xui.each(style,(function(o,i){arr.push(i.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+o)})),arr.join(";").replace(/[;]+/g,";")}return style},_cssfake:{rotate:1,scaleX:1,scaleY:1,translateX:1,translateY:1,skewX:1,skewY:1},setStyle:function(node,name,value){if("rotate"==name)return xui(node).rotate(value),this;var ns=xui.Dom,css3prop=xui.Dom._css3prop,xb=xui.browser,fake=ns._cssfake,style=node.style;if(1==node.nodeType)if("string"==typeof name)if(fake[name])xui(node)[name](value);else{var name2,name3,name4,me=this.getStyle,c1=me._c1||(me._c1={}),r1=me._r1||(me._r1=/alpha\([^\)]*\)/gi),map=me.map||(me.map={float:1,cssFloat:1,styleFloat:1}),n1=name=c1[name]||(c1[name]=name.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})));if(0===n1.indexOf("border")&&(n1=n1.replace(/[-]?(left|top|right|bottom)/gi,"")),"$gradient"==name)return ns.$setGradients(node,value);if("$zoom"==name)return ns.$setZoom(node,value);if("opacity"==name){if(value=(value=xui.isFinite(value)?parseFloat(value)>1?1:parseFloat(value)<=0?0:parseFloat(value):1)>.9999?"":value,!ns.css3Support("opacity")&&xb.ie){""===value&&(value=1),style.opacity=value,style.zoom=1,value="alpha(opacity="+100*value+")";var ov=(style.filter||"").replace(r1,"");value=(ov?ov+",":"")+value,name="filter",8==xb.ver&&(name2="msfilter")}}else if(-1!=xui.arr.indexOf(css3prop,n1)){if(!ns.css3Support(name)){if(xb.ie&&xb.ver<9)switch(name){case"transform":xui.Dom.$transformIE(node,value);break;case"boxShadow":xui.Dom.$textShadowIE(node,value,!0)}return"textShadow"==name&&xb.ie&&xb.ver<10&&xui.Dom.$textShadowIE(node,value),this}xb.cssTag2&&"textShadow"!=name&&(name2=xb.cssTag2+name.charAt(0).toUpperCase()+name.substr(1))}else map[name]&&(name=xb.ie?"styleFloat":"cssFloat");"filter"==name&&(value=value.replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "))),style[name]=value,name2&&(style[name2]=value),name3&&(style[name3]=value),name4&&(style[name4]=value)}else for(var i in name)arguments.callee.call(this,node,i,name[i])},_css3prop:"opacity,textShadow,animationName,columnCount,flexWrap,boxDirection,backgroundSize,perspective,boxShadow,borderImage,borderRadius,boxReflect,transform,transition".split(","),css3Support:function(key){var self=arguments.callee,_c=self._c||(self._c={});if((key=key.replace("$","").replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})))in _c)return _c[key];var n=document.createElement("div"),s=n.style,rt=!1,xb=xui.browser,f=function(k){return k=k.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})),s[k]!==undefined||!(!xui.browser.cssTag2||(k=xui.browser.cssTag2+k.charAt(0).toUpperCase()+k.substr(1),s[k]===undefined))};switch(n.id="xui_css3_"+xui.stamp(),0===key.indexOf("border")&&(key=key.replace(/[-]?(left|top|right|bottom)/gi,"")),key){case"opacity":case"textShadow":rt=""===s[key];break;case"generatedContent":var id="tmp_css3_test"+xui.id(),css="#"+n.id+"{line-height:auto;margin:0;padding:0;border:0;font:0/0 a}#"+n.id+":after{content:'a';visibility:hidden;line-height:auto;margin:0;padding:0;border:0;font:3px/1 a}";xui.CSS.addStyleSheet(css,id),xui("body").append(n);var v=n.offsetHeight;xui.CSS.remove("id",id),xui(n.id).remove(n),rt=v>=3;break;case"fontFace":if(xb.ie&&xb.ver>=6)rt=!0;else{id="tmp_css3_test"+xui.id(),css='@font-face{font-family:"font";src:url("https://")}';var style=xui.CSS.addStyleSheet(css,id),sh=style.sheet||style.styleSheet,ctxt=sh?sh.cssRules&&sh.cssRules[0]?sh.cssRules[0].cssText:sh.cssText||"":"";rt=/src/i.test(ctxt)&&0===ctxt.indexOf("@font-face"),xui.CSS.remove("id",id)}break;case"rgba":s.cssText="background-color:rgba(0,0,0,0.1)",rt=-1!=s.backgroundColor.indexOf("rgba");break;case"hsla":s.cssText="background-color:hsla(120,40%,100%,.5)",rt=-1!=s.backgroundColor.indexOf("hsla")||-1!=s.backgroundColor.indexOf("rgba");break;case"multiplebgs":s.cssText="background:url(//:),url(//:),red url(//:)",rt=/(url\s*\(.*?){3}/.test(s.background);break;case"gradient":var k="background-image:",v1="-webkit-gradient(linear,left top,right bottom,from(#000),to(#fff));",arr=[k,v2="linear-gradient(left top,#000,#fff);"];xui.browser.cssTag1&&(arr.push(k),arr.push(xui.browser.cssTag1+v2)),xui.browser.isWebKit&&(arr.push(k),arr.push(v1)),s.cssText=arr.join(""),rt=!!s.backgroundImage;break;case"transform3d":var r=f("perspective");if(r&&"webkitPerspective"in document.documentElement.style){id="tmp_css3_test"+xui.id(),css="@media (transform-3d),(-webkit-transform-3d){#"+n.id+"{font:0/0;line-height:0;margin:0;padding:0;border:0;left:9px;position:absolute;height:3px;}}",xui.CSS.addStyleSheet(css,id),xui("body").append(n),v1=n.offsetLeft;var v2=n.offsetHeight;xui.CSS.remove("id",id),xui(n.id).remove(n),rt=9===v1&&3===v2}rt=r;break;default:rt=f(key)}return _c[key]=rt},supportPromise:function(){var dom=xui.Dom;if("$supportPromise"in dom)return dom.$supportPromise;try{return new Promise((function(x,y){})),dom.$supportPromise=!0}catch(e){}return dom.$supportPromise=!1},supportDropzone:function(){if("$supportDropzone"in xui.Dom)return xui.Dom.$supportDropzone;var div=document.createElement("div");return xui.Dom.$supportDropzone=("draggable"in div||"ondragstart"in div&&"ondrop"in div)&&"FileReader"in window},$AnimateEffects:{linear:function(s,c){return 1/s*c},sineIn:function(s,c){return-1*Math.cos(c/s*(Math.PI/2))+1},sineOut:function(s,c){return Math.sin(c/s*(Math.PI/2))},sineInOut:function(s,c){return-.5*(Math.cos(Math.PI*c/s)-1)},quadIn:function(s,c){return(c/=s)*c},quadOut:function(s,c){return-1*(c/=s)*(c-2)},quadInOut:function(s,c){return(c/=s/2)<1?.5*c*c:-.5*(--c*(c-2)-1)},cubicIn:function(s,c){return(c/=s)*c*c},cubicOut:function(s,c){return(c=c/s-1)*c*c+1},cubicInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c:.5*((c-=2)*c*c+2)},quartIn:function(s,c){return(c/=s)*c*c*c},quartOut:function(s,c){return-1*((c=c/s-1)*c*c*c-1)},quartInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c*c:-.5*((c-=2)*c*c*c-2)},quintIn:function(s,c){return(c/=s)*c*c*c*c},quintOut:function(s,c){return(c=c/s-1)*c*c*c*c+1},quintInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c*c*c:.5*((c-=2)*c*c*c*c+2)},expoIn:function(s,c){return 0==c?0:Math.pow(2,10*(c/s-1))},expoOut:function(s,c){return c==s?1:1-Math.pow(2,-10*c/s)},expoInOut:function(s,c){return 0==c?0:c==s?1:(c/=s/2)<1?.5*Math.pow(2,10*(c-1)):.5*(2-Math.pow(2,-10*--c))},circIn:function(s,c){return-1*(Math.sqrt(1-(c/=s)*c)-1)},circOut:function(s,c){return Math.sqrt(1-(c=c/s-1)*c)},circInOut:function(s,c){return(c/=s/2)<1?-.5*(Math.sqrt(1-c*c)-1):.5*(Math.sqrt(1-(c-=2)*c)+1)},bounceIn:function(s,c){return 1-xui.Dom.$AnimateEffects.bounceOut(s,s-c)},bounceOut:function(s,c){var k=7.5625;return(c/=s)<1/2.75?k*c*c:c<2/2.75?k*(c-=1.5/2.75)*c+.75:c<2.5/2.75?k*(c-=2.25/2.75)*c+.9375:k*(c-=2.625/2.75)*c+.984375},bounceInOut:function(s,c){return c<s/2?.5*xui.Dom.$AnimateEffects.bounceIn(s,2*c):.5*xui.Dom.$AnimateEffects.bounceOut(s,2*c-s)+.5},backIn:function(s,c){var k=1.70158;return(c/=s)*c*((k+1)*c-k)},backOut:function(s,c){var k=1.70158;return(c=c/s-1)*c*((k+1)*c+k)+1},backInOut:function(s,c){var k=1.70158;return(c/=s/2)<1?c*c*((1+(k*=1.525))*c-k)*.5:.5*((c-=2)*c*((1+(k*=1.525))*c+k)+2)},elasticIn:function(s,c,p,a,z){if(0==c)return 0;if(1==(c/=s))return 1;if(z||(z=.3*s),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return-a*Math.pow(2,10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)},elasticOut:function(s,c,p,a,z){if(0==c)return 0;if(1==(c/=s))return 1;if(z||(z=.3*s),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*c)*Math.sin((c*s-k)*(2*Math.PI)/z)+1},elasticInOut:function(s,c,p,a,z){if(0==c)return 0;if(2==(c/=s/2))return 1;if(z||(z=s*(.3*1.5)),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return c<1?a*Math.pow(2,10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)*-.5:a*Math.pow(2,-10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)*.5+1}},$preDefinedAnims:{blinkAlert:{endpoints:{opacity:[1,0]},duration:200,restore:!0,times:3},blinkAlertLoop:{endpoints:{opacity:[1,0]},duration:500,restore:!0,times:-1},rotateAlert:{endpoints:{rotate:[0,360]},duration:400,restore:!1},rotateAlertLoop1:{endpoints:{rotate:[0,360]},duration:2e3,restore:!1,times:-1},rotateAlertLoop2:{endpoints:{rotate:[0,-360]},duration:2e3,returned:!1,times:-1},zoomAlert:{endpoints:{scaleX:[1,1.1],scaleY:[1,1.1]},duration:100,restore:!0,times:3},translateXAlert:{endpoints:{translateX:[0,5]},duration:100,restore:!0,times:3},translateYAlert:{endpoints:{translateY:[0,5]},duration:100,restore:!0,times:3}},$preDefinedEffects:{Classic:[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[.75,1],scaleY:[.75,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,.75],scaleY:[1,.75]}}],Blur:[{type:"circOut",duration:200,endpoints:{opacity:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0]}}],Drop:[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateY:["-25%","0%"],scaleY:[.5,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateY:["0%","-25%"],scaleY:[1,.5]}}],"From Below":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,0],scaleY:[1,0]}}],"From Above":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[2,1],scaleY:[2,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,2],scaleY:[1,2]}}],"Slide In LR":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateX:["-150%","0%"]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateX:["0%","150%"]}}],"Slide In TB":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateY:["-150%","0%"]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateY:["0%","150%"]}}],"Flip V":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleY:[1,0]}}],"Flip H":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,0]}}]},_getEffects:function(key,isIn){return key&&"string"==typeof key&&(key=(key=this.$preDefinedEffects[key])?isIn?key[0]:key[1]:null),key&&xui.browser.ie&&xui.browser.ver<=8&&xui.filter(key,(function(o,i){return!!xui.Dom._cssfake[i]})),key},_setUnitStyle:function(node,key,value){if(!node||1!=node.nodeType)return!1;var style=node.style;return!(!value&&0!==value||(!(value=xui.CSS.$addu(value))||"width"!=key&&"height"!=key||"-"!=value.charAt(0)||(value="0"),style[key]==value)||(style[key]=value,0))},_emptyDivId:"xui.empty:",getEmptyDiv:function(pid,sequence){var id,rt,o,i=1,count=0,doc=document,body=pid&&(pid=xui(pid)).get(0)||doc.body,ini=function(o){o.id=id,xui([o]).attr("style","position:absolute;visibility:hidden;overflow:visible;left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";")};for(sequence=sequence||1,pid=body==doc.body?"":pid.n0.replace("!","");;){if(id=this._emptyDivId+pid+":"+i,!(o=xui.Dom.byId(id)))return ini(o=doc.createElement("div")),body.firstChild?body.insertBefore(o,body.firstChild):body.appendChild(o),rt=xui([o]),body=o=null,rt;if((!o.firstChild||3==o.firstChild.nodeType&&!o.firstChild.nodeValue)&&++count==sequence)return xui([o]);i++}body=o=null},setCover:function(visible,label,busyIcon,cursor,bgStyle){var o1,o2,me=arguments.callee,id="xui.temp:cover:",id2="xui.temp:message:",content="string"==typeof visible||"function"==typeof visible?visible:"";if((o1=xui(id)).isEmpty()&&(xui("body").prepend(o1=xui.create('<button id="'+id+'" class="xui-node xui-node-div xui-cover xui-cover-global xui-custom" style="position:absolute;display:none;text-align:center;left:0;top:0;border:0;padding:0;margin:0;padding-top:2em;"><div id="'+id2+'" class="xui-node xui-node-div xui-coverlabel xui-custom"></div></button>')),o1.setSelectable(!1),xui.setNodeData(o1.get(0),"zIndexIgnore",1)),xui.Dom.byId(id2)&&(o2=xui(id2)),visible){"string"==typeof label&&(me._label=label);var t=xui.win;me._showed||(o1.css({zIndex:10*xui.Dom.TOP_ZINDEX,display:"",width:t.scrollWidth()+"px",height:t.scrollHeight()+"px",cursor:cursor||"progress"}),busyIcon?o1.addClass("xuicon xui-icon-loading"):o1.removeClass("xuicon xui-icon-loading"),me._showed=!0),o1.query("style").remove(!1),bgStyle&&xui.CSS._appendSS(o1.get(0),".xui-cover-global{"+bgStyle+"}","",!0),content&&("function"==typeof content?content(o1,o2):o2&&o2.html(content+"",!1))}else{if("string"==typeof me._label&&me._label!==label)return;me._showed&&(o2&&o2.empty(!1),o1.css({zIndex:0,cursor:"",display:"none"}),o1.query("style").remove(!1),me._showed=!1),delete me._label}},byId:function(id){return document.getElementById(id||"")},$hasEventHandler:function(node,name){return xui.getNodeData(node,["eHandlers",name])},submit:function(action,data,method,target,enctype){data=xui.isHash(data)?data:{},data=xui.clone(data,(function(o){return o!==undefined})),action=action||"",target=target||("mailto"==action.substring(0,6).toLowerCase()?"_self":"_blank");var _t=[];if(xui.isEmpty(data))window.open(action,target);else{var file,files=[];xui.each(data,(function(o,i){o&&o["xui.UIProfile"]&&o.$xuiFileCtrl&&(file=o.boxing().getUploadObj())&&(files.push({id:o.$xid,file:file}),file.id=file.name=i,data[i]=file)})),"get"==(method=method||(file?"post":"get")).toLowerCase()?window.open(action+"?"+xui.urlEncode(data),target):(xui.each(data,(function(o,i){xui.isDefined(o)&&!xui.isElem(o)&&_t.push('<textarea name="'+i+'">'+("object"==typeof o?xui.serialize(o):o)+"</textarea>")})),_t.push('<input type="hidden" name="rnd" value="'+xui.rand()+'">'),_t=xui.str.toDom('<form target="'+target+'" action="'+action+'" method="'+method+(enctype?'" enctype="'+enctype:"")+'">'+_t.join("")+"</form>"),xui.Dom.getEmptyDiv().append(_t),files.length&&xui.arr.each(files,(function(o,i){_t.append(o.file)})),_t.get(0).submit(),_t.remove(),_t=null),files.length&&xui.arr.each(files,(function(o,i){(i=xui.getObject(o.id))&&i["xui.UIProfile"]&&i.boxing()&&i.boxing().setUploadObj&&i.boxing().setUploadObj(o.file)}))}},selectFile:function(callback,accept,multiple){var fileInput=document.createElement("input");if(fileInput.type="file",accept&&(fileInput.accept=accept),multiple&&(fileInput.multiple="multiple"),fileInput.onchange=function(e){var t=e.target||window.event.srcElement;xui.tryF(callback,[this,t.files[0],t.files],this)},window.ActiveXObject||"ActiveXObject"in window){var label=document.createElement("div");fileInput.appendChild(label),label.click(),fileInput.removeChild(label)}else fileInput.click()},busy:function(id,busyMsg,busyIcon,cursor,bgStyle){xui.Dom.setCover(busyMsg||!0,id,busyIcon,cursor,bgStyle)},free:function(id){xui.Dom.setCover(!1,id)},animate:function(css,endpoints,onStart,onEnd,duration,step,type,threadid,unit,restore,times){var node=document.createElement("div");return xui.merge(css,{position:"absolute",left:this.HIDE_VALUE,zIndex:this.TOP_ZINDEX++}),xui.Dom.setStyle(node,css),document.body.appendChild(node),xui([node]).animate(endpoints,onStart,(function(){xui.tryF(onEnd),node.parentNode&&node.parentNode.removeChild(node),node=null}),duration,step,type,threadid,unit,restore,times)},$enableEvents:function(name){xui.isArr(name)||(name=[name]);var f,self=this;xui.arr.each(name,(function(o){(f=function(fun,label,flag){if("function"==typeof fun)return this.$addEvent(o,fun,label,flag);if(null===fun)return this.$removeEvent(o,label,flag);var args=arguments[1]||{};return args.$xuiall=!0===arguments[0],this.$fireEvent(o,args)}).$event$=1,self.plugIn(o,f)}))}},After:function(d){var self=this;xui.each({parent:["y",!1],prev:["x",!1],next:["x",!0],first:["y",!0],last:["y",1]},(function(o,i){self.plugIn(i,(function(index){return this.$iterator(o[0],o[1],!0,index||1)}))})),xui.arr.each(xui.toArr("offsetLeft,offsetTop,scrollWidth,scrollHeight"),(function(o){self.plugIn(o,(function(){var t=this.get(0),d=document;if(t==window||t==d){if("scrollWidth"==o||"scrollHeight"==o){var a=d.documentElement,b=d.body;return Math.max(a[o],b[o])}t=xui.browser.contentBox?d.documentElement:d.body}return t[o]}))}));var p="padding",m="margin",b="border",c="inner",o="offset",r="outer",w="width",h="height",W="Width",H="Height",T="Top",L="Left",l="left",R="Right",B="Bottom";xui.arr.each([["_"+p+"H",p+T,p+B],["_"+p+"W",p+L,p+R],["_"+b+"H",b+T+W,b+B+W],["_"+b+"W",b+L+W,b+R+W],["_"+m+"W",m+L,m+R],["_"+m+"H",m+T,m+B]],(function(o){var node,fun=xui.Dom.getStyle;self.plugIn(o[0],(function(type){return type=type||"both",node=this.get(0),("both"==type||"left"==type||"top"==type?xui.CSS.$px(fun(node,o[1]),node):0)+("both"==type||"right"==type||"bottom"==type?xui.CSS.$px(fun(node,o[2]),node):0)||0}))})),xui.arr.each([["_W",w,"_"+p+"W","_"+b+"W","_"+m+"W",c+W,o+W],["_H",h,"_"+p+"H","_"+b+"H","_"+m+"H",c+H,o+H]],(function(o){var _size=function(node,index,value,_in){var n,r,t,style=node.style,contentBox=xui.browser.contentBox,getStyle=xui.Dom.getStyle,f=xui.Dom._setUnitStyle,type=typeof value;if("undefined"==type||"boolean"==type){if(!0===value&&(n="none"==getStyle(node,"display")||0===node.offsetHeight)){var b,p,d,temp=xui.Dom.getEmptyDiv().html("*",!1);xui([node]).swap(temp),b=style.visibility,p=(p=style.position)||"",b=b||"",d=(d=style.display)||"",style.visibility="hidden",style.position="absolute",style.display="block"}switch(t=xui([node]),index){case 1:r=getStyle(node,o[1]),!isNaN(parseFloat(r))&&!/%$/.test(r)||_in||(r=_size(node,2,undefined,!0)-(contentBox?t[o[2]]():0)),r=xui.CSS.$px(r,node)||0;break;case 2:node===document||node===window?r=xui(node)[o[1]]():(r=node[o[6]])?r-=t[o[3]]():_in||(r=_size(node,1,undefined,!0)+(contentBox?t[o[2]]():0));break;case 3:node===document||node===window?r=xui(node)[o[1]]():(r=node[o[6]])||(r=_size(node,1,value,!0)+(contentBox?t[o[2]]():0)+t[o[3]]());break;case 4:r=_size(node,3,value),r+=t[o[4]]()}return n&&(style.display=d,style.position=p,style.visibility=b,t.swap(temp),temp.empty(!1)),parseFloat(r)||0}switch(index){case 1:if(f(node,o[1],value)&&xui.Dom.$hasEventHandler(node,"onsize")){var args={};args[o[1]]=1,xui([node]).onSize(!0,args)}break;case 2:_size(node,1,value-(contentBox?xui([node])[o[2]]():0));break;case 3:_size(node,1,value-(t=xui([node]))[o[3]]()-(contentBox?t[o[2]]():0));break;case 4:_size(node,1,value-(t=xui([node]))[o[4]]()-t[o[3]]()-(contentBox?t[o[2]]():0))}};self.plugIn(o[0],_size)})),xui.arr.each([[c+W,"_W",2],[o+W,"_W",3],[r+W,"_W",4],[c+H,"_H",2],[o+H,"_H",3],[r+H,"_H",4]],(function(o){self.plugIn(o[0],(function(value){var type=typeof value;return"undefined"==type||"boolean"==type?this[o[1]](this.get(0),o[2],value):this.each((function(v){this[o[1]](v,o[2],value)}))}))})),xui.arr.each([[l+"By",l],["topBy","top"],[w+"By",w],[h+"By",h]],(function(o){self.plugIn(o[0],(function(offset,triggerEvent){if(0===offset)return this;var m,args,k=o[1];return this.each((function(node){if(m=xui.use(node.$xid)[k](),m=(parseFloat(m)||0)+offset,"width"!=k&&"height"!=k||(m=m>0?m:0),node.style[k]=xui.CSS.$forceu(m,null,node),triggerEvent){(args={})[k]=1;var f=xui.Dom.$hasEventHandler;"left"!=k&&"top"!=k||!f(node,"onmove")||xui([node]).onMove(!0,args),"width"!=k&&"height"!=k||!f(node,"onsize")||xui([node]).onSize(!0,args)}}),this)}))})),xui.arr.each(["scrollLeft","scrollTop"],(function(o){self.plugIn(o,(function(value){var v,a=document.documentElement,b=document.body;return value!==undefined?this.each((function(v){v===window||v===document?(a&&(a[o]=value),b&&(b[o]=value)):v&&(v[o]=value)})):(v=this.get(0))?v===window||v===document?window["scrollTop"==o?"pageYOffset":"pageXOffset"]||a[o]||b[o]||0:v[o]:0}))})),xui.arr.each("width,height,left,top".split(","),(function(o){self.plugIn(o,(function(value){var t,style,self=this,node=self.get(0),b=xui.browser,type=typeof value,doc=document;if(node&&3!=node.nodeType){if("undefined"==type||"boolean"==type){if("width"==o&&(t="Width")||"height"==o&&(t="Height")){if(doc===node)return Math.max(doc.body["scroll"+t],doc.body["offset"+t],doc.documentElement["scroll"+t],doc.documentElement["offset"+t]);if(window===node)return b.opr?Math.max(doc.body["client"+t],window["inner"+t]):b.kde?window["inner"+t]:xui.browser.contentBox&&doc.documentElement["client"+t]||doc.body["client"+t]}return style=node.style,"auto"==(value="width"==o?xui.CSS.$isPx(style.width)&&parseFloat(style.width)||self._W(node,1,value):"height"==o?xui.CSS.$isPx(style.height)&&parseFloat(style.height)||self._H(node,1,value):xui.Dom.getStyle(node,o,!0))||""===value?value:value||0}var a,f=xui.Dom._setUnitStyle,av=xui.CSS.$addu(value);return self.each((function(v){1==v.nodeType&&v.style[o]!==av&&("width"==o?self._W(v,1,value):"height"==o?self._H(v,1,value):f(v,o,value)&&("top"!=o&&"left"!=o||!xui.Dom.$hasEventHandler(node,"onmove")||((a={})[o]=1,xui([v]).onMove(!0,a))))}))}}))})),xui.arr.each(xui.Event._events,(function(o){xui.arr.each(xui.Event._getEventName(o),(function(o){self.$enableEvents(o)}))}))},Initialize:function(){var w=window,d=document;xui.browser.contentBox=xui(d.documentElement).contentBox(),xui.set(xui.$cache.domPurgeData,"!window",{$xid:"!window",element:w}),xui.set(xui.$cache.domPurgeData,"!document",{$xid:"!document",element:d}),xui.win=xui(["!window"],!1),xui.doc=xui(["!document"],!1),xui.frame=xui.win,xui.busy=xui.Dom.busy,xui.free=xui.Dom.free,xui.$inlineBlock=xui.browser.gek?xui.browser.ver<3?["-moz-inline-block","-moz-inline-box","inline-block"]:["inline-block"]:xui.browser.ie&&xui.browser.ver<=6?["inline-block","inline"]:["inline-block"];var fun=function(p,e,cache,keydown){var set,rtnf,rst,f,arr,event=xui.Event,remove={},ks=event.getKey(e);if(ks){if(1==ks[0].length&&(ks[0]=ks[0].toLowerCase()),(arr=cache[ks.join(":")])&&(xui.arr.each(arr,(function(key,i){if(set=arr[key]){if(set[3]&&("function"==typeof set[3]?!1===set[3]():!xui(set[3]).size()))return delete arr[key],void(remove[i]=1);if(!1===(rst=xui.tryF(set[0],set[1]||[arr,i,key],set[2])))return rtnf=1,!1;!0===rst&&(delete arr[key],remove[i]=1)}}),null,!0),xui.filter(arr,(function(key,i){return!remove[i]})),rtnf))return event.stopBubble(e),!1;xui.Module&&xui.arr.each(xui.Module._cache,(function(m){m._evsClsBuildIn&&"onHookKey"in m._evsClsBuildIn?(xui.isFun(f=m._evsClsBuildIn.onHookKey)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onHookKey",[m,ks,keydown,e]):m._evsPClsBuildIn&&"onHookKey"in m._evsPClsBuildIn&&(xui.isFun(f=m._evsPClsBuildIn.onHookKey)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onHookKey",[m,ks,keydown,e])}))}return!0};xui.doc.onKeydown((function(p,e){xui.Event.$keyboard=xui.Event.getKey(e),fun(0,e,xui.$cache.hookKey,!0)}),"document").onKeyup((function(p,e){delete xui.Event.$keyboard,fun(0,e,xui.$cache.hookKeyUp,!1)}),"document"),xui.doc.onClick((function(p,e,src){var b,href,o=xui.Event.getSrc(e),i=0;do{if("A"==o.nodeName){b=!0;break}if(++i>8)break}while(o=o.parentNode);if(b){if(href=xui.str.trim(o.href||"").toLowerCase(),xui.History){var s=location.href.split("#")[0];xui.Event.getKey(e).shiftKey||"left"!=xui.Event.getBtn(e)||0!=href.indexOf(s+"#")&&0!=href.indexOf("#")||xui.History.setFI(o.href.replace(s,""))}if(xui.browser.ie&&(0==href.indexOf("javascript:")||-1!==href.indexOf("#")))return!1}}),"hookA",0);var _ieselectstart=function(n,v){for(n=window.event.srcElement;n&&n.nodeName&&"BODY"!=n.nodeName&&"HTML"!=n.nodeName;){if(v=xui.getNodeData(n,"_onxuisel"))return"false"!=v;if("INPUT"==n.nodeName||"TEXTAREA"==n.nodeName)break;n=n.parentNode}return!0};xui.browser.ie&&xui.browser.ver<10&&d.body&&xui.Event._addEventListener(d.body,"selectstart",_ieselectstart),xui.win.afterUnload(xui._destroy=function(){var t,lowie=xui.browser.ie&&xui.browser.ver<=8,e=xui.Event,_cw=function(w,k){w[k]=undefined,lowie||delete w[k]};for(var i in xui.History&&xui.History._checker&&e._removeEventListener(w,"hashchange",xui.History._checker),e._removeEventListener(d.body,"selectstart",_ieselectstart),e._removeEventListener(w,"resize",e.$eventhandler),e._removeEventListener(w,"mousewheel",e.$eventhandler3),e._removeEventListener(d,"mousewheel",e.$eventhandler3),e._removeEventListener(w,"DOMMouseScroll",e.$eventhandler3),xui.browser.isTouch&&(e._removeEventListener(d,xui.browser.ie&&w.PointerEvent?"pointerdown":xui.browser.ie&&w.MSPointerEvent?"MSPointerDown":"touchstart",e._simulateMousedown),e._removeEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerup":xui.browser.ie&&xui.browser.ver>=10?"MSPointerUp":"touchend",e._simulateMouseup)),t=xui.$cache.domPurgeData)t[i].eHandlers&&xui(i).$clearEvent();for(var i in t=xui._pool)t[i]&&t[i].destroy&&t[i].destroy(1,1),t[i]&&t[i].Instace&&t[i].Instace.destroy&&t[i].Instace.destroy(1,1);if(_cw(w,xui.ini.rootModuleName),w.Raphael&&w.Raphael._in_xui&&_cw(w,"Raphael"),xui.SC.__gc(),xui.Thread.__gc(),xui.Class.__gc(),/xui\.Class\.apply/.test(w.Class)&&_cw(w,"Class"),t=xui.Namespace._all)for(var i in t)_cw(w,t[i]);xui.breakO(xui.$cache,2),xui.breakO([xui.Class,xui],3),_cw(w,"xui_ini"),_cw(w,"xui"),w=d=null},"window",-1)}}),xui.Class("xui.Template","xui.absProfile",{Constructor:function(template,properties,events,domId){var upper=arguments.callee.upper,args=xui.toArr(arguments);upper.apply(this,args),upper=null;var self=this;return self.$domId=self.KEY+":"+(self.serialId=self._pickSerialId())+":",self.domId="string"==typeof domId?domId:self.$domId,self._links={},self.template={root:[["<div></div>"],[]]},self.properties={},self.events={},self.$template={},self.link(self.constructor._cache,"self").link(xui._pool,"xui"),self.Class=self.constructor,self.box=self.constructor,self.boxing=function(){return this},template&&self.setTemplate("string"==typeof template?{root:template}:template),events&&self.setEvents(events),properties&&self.setProperties(properties),self},Instance:{renderId:null,__gc:function(){var t=xui.$cache.reclaimId;this.$noReclaim?delete this.$noReclaim:(t[this.KEY]||(t[this.KEY]=[])).push(this.serialId),delete xui.$cache.profileMap[this.domId],delete xui.$cache.profileMap[this.$domId],this.unLinkAll(),xui.breakO([this.properties,this.event,this],2)},_reg0:/^\w[\w_-]*$/,show:function(parent){return parent||(parent=xui("body")),(parent=xui(parent)).append(this),this},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){return xui([this.renderId],!1)},setDomId:function(id){var t=this,c=xui.$cache.profileMap,reg=t._reg0;return"string"==typeof id&&reg.test(id)&&!document.getElementById(id)&&(t.domId!=t.$domId&&delete c[t.domId],t.domId=id,t.renderId&&(t.getRootNode().id=id),c[t.$domId]&&(c[id]=t)),t},destroy:function(){if(this.renderId){var rn=this.getRootNode();xui.$purgeChildren(rn),rn.parentNode&&rn.parentNode.removeChild(rn),rn=null}else this.__gc()},setEvents:function(key,value){return"object"==typeof key?this.events=key:this.events[key]=value,this},setTemplate:function(key,value){var h,t=this.template,$t=this.$template;if("object"==typeof key){for(var i in this.template=key,h={},key)h[i||"root"]=this._buildTemplate(key[i]);this.$template=h}else"string"==typeof value?$t[key]=this._buildTemplate(t[key]=value):$t.root=this._buildTemplate(t.root=key);return this},setProperties:function(key,value){return"object"==typeof key?this.properties=key:this.properties[key]=value,this},getItem:function(src){var obj=xui.getNodeData(src);if(obj){var id=obj.tpl_evid,tpl_evkey=obj.tpl_evkey;if(id&&tpl_evkey){var me=arguments.callee,f=me.f||(me.f=function(data,tpl_evkey,id){var i,o,j,v;for(j in data)if(o=data[j],xui.isArr(o)&&(tpl_evkey==j||0===tpl_evkey.indexOf((data.tpl_evkey||j)+".")))for(i=0;v=o[i];i++){if(v.tpl_evkey==tpl_evkey&&v.id==id)return v;if(v=f(v,tpl_evkey,id))return v}});return f(this.properties,tpl_evkey,id)}}},_pickSerialId:function(){var arr=xui.$cache.reclaimId[this.KEY];return arr&&arr[0]?arr.shift():this.constructor._ctrlId.next()},render:function(){if(!this.renderId){var div=xui.$getGhostDiv();xui.$cache.profileMap[this.domId]=xui.$cache.profileMap[this.$domId]=this,div.innerHTML=this.toHtml();var i,l,j,k,o,key,id,t,v,ch=this.events,eh=xui.Event._eventHandler,children=div.getElementsByTagName("*"),f=(this.$domId,xui.Event.$eventhandler);if(l=children.length){for(i=0;i<l;i++)if(1==(o=children[i]).nodeType&&(key=o.getAttribute("tpl_evkey"),id=o.getAttribute("tpl_evid"),null!==key&&null!==id)){if((v=xui.$registerNode(o)).tpl_evkey=key,v.tpl_evid=id,t=ch[key])for(j in v=v.eHandlers||(v.eHandlers={}),t)v[j]=f,(k=eh[j])&&(v[k]=f,xui.Event._addEventListener(o,k,f));o.removeAttribute("tpl_evkey"),o.removeAttribute("tpl_evid")}div.firstChild.$xid||xui.$registerNode(div.firstChild),this.renderId=div.firstChild.$xid}o=div=null}return this},refresh:function(){var ns=this;if(ns.renderId){var proxy=document.createElement("span"),rn=ns.getRootNode(),cache=xui.$cache.profileMap;delete cache[ns.domId],delete cache[ns.$domId],rn.parentNode&&rn.parentNode.replaceChild(proxy,rn),ns.destroy(),delete ns.renderId,ns.render(),proxy.parentNode&&proxy.parentNode.replaceChild(ns.getRootNode(),proxy),proxy=rn=null}return ns},renderOnto:function(node){var id,domNode,t;"string"==typeof node&&(node=document.getElementById(node)),id=node.id||this.domId,this.renderId||this.render(),domNode=this.getRootNode(),node.parentNode.replaceChild(domNode,node),domNode.tabIndex!==node.tabIndex&&(domNode.tabIndex=node.tabIndex),node.className&&(domNode.className+=node.className),xui.browser.ie&&(t=node.style.cssText)?domNode.style.cssText+=t+"":(t=node.getAttribute("style"))&&domNode.setAttribute("style",(domNode.getAttribute("style")||"")+t),this.setDomId(id)},toHtml:function(properties){var p=xui.copy(properties||this.properties||{});return p.tpl_evkey="root",this._doTemplate(p)},_reg1:/([^{}]*)\{([\w]+)\}([^{}]*)/g,_reg2:/\[event\]/g,_buildTemplate:function(str){if("string"==typeof str){var obj=[[],[]],a0=obj[0],a1=obj[1];return(str=str.replace(this._reg2,' tpl_evid="{id}" tpl_evkey="{tpl_evkey}" ')).replace(this._reg1,(function(a,b,c,d){return b&&(a0[a0.length]=b),a1[a0.length]=a0[a0.length]=c,d&&(a0[a0.length]=d),""})),obj}return str},_getEV:function(funs,id,name,xid){var obj=xui.getNodeData(xid);if(obj){var evs=this.events,tpl_evkey=obj.tpl_evkey,evg=tpl_evkey&&evs&&evs[tpl_evkey]||evs,ev=evg&&evg[name];ev&&funs.push(ev)}},_reg3:/(^\s*<\w+)(\s|>)(.*)/,_doTemplate:function(properties,tag,result){if(!properties)return"";var s,t,n,self=this,me=arguments.callee,isA=xui.isArr(properties),template=self.$template,temp=template[tag||"root"],r=!result;if(result=result||[],isA){"function"!=typeof temp&&(temp=me);for(var i=0;t=properties[i++];)t.tpl_evkey=tag,temp.call(self,t,tag,result)}else if("function"==typeof temp)temp.call(self,properties,tag,result);else{tag=tag?tag+".":"";for(var a0=temp[0],a1=temp[1],l=(i=0,a0.length);i<l;i++)(n=a1[i])?n in properties&&(t="function"==typeof properties[n]?properties[n].call(self,n,properties):properties[n],template[s=tag+n]?me.call(self,t,s,result):result[result.length]=t):result[result.length]=a0[i]}return r?result.join("").replace(self._reg3,'$1 id="'+self.$domId+'" $2$3'):void 0},serialize:function(){var s=xui.serialize,t=xui.absObj.$specialChars,properties=xui.isEmpty(this.properties)?null:xui.clone(this.properties,(function(o,i){return!t[(i+"").charAt(0)]}));return"new xui.Template("+s(this.template||null)+","+s(properties)+","+s(xui.isEmpty(this.events)?null:this.events)+","+s(this.$domId!=this.domId?this.domId:null)+")"}},Static:{getFromDom:function(id){if((id="string"==typeof id?id:id&&id.id)&&(id=xui.$cache.profileMap[id])&&id["xui.Template"])return id.boxing()},_cache:[],_ctrlId:new xui.id}}),xui.Class("xui.DragDrop",null,{Static:{_eh:"_dd",_id:"xui.dd:proxy:",_idi:"xui.dd:td:",_type:{blank:1,move:1,shape:1,deep_copy:1,copy:1,icon:1,none:1},_Icons:{none:"0 0",move:"0 -16px",link:"0 -32px",add:"0 -48px"},_profile:{},_left:function(value){var proxySize=this.$proxySize,prf=this._profile;if(prf.magneticDistance>0&&prf.xMagneticLines.length)for(var l=prf.xMagneticLines.length;l--;)if(Math.abs(value+proxySize-prf.xMagneticLines[l])<=prf.magneticDistance)return prf.xMagneticLines[l]-proxySize;return prf.widthIncrement>1?Math.floor((value+proxySize)/prf.widthIncrement)*prf.widthIncrement-proxySize:value},_top:function(value){var proxySize=this.$proxySize,prf=this._profile;if(prf.magneticDistance>0&&prf.yMagneticLines.length)for(var l=prf.yMagneticLines.length;l--;)if(Math.abs(value+proxySize-prf.yMagneticLines[l])<=prf.magneticDistance)return prf.yMagneticLines[l]-proxySize;return prf.heightIncrement>1?Math.floor((value+proxySize)/prf.heightIncrement)*prf.heightIncrement-proxySize:value},_ini:function(o){var d=this,p=d._profile,_t=xui.win;d._box={width:_t.width()+_t.scrollLeft(),height:_t.height()+_t.scrollTop()},p.ox=p.x,p.oy=p.y,(d._proxy=o)&&(d._proxystyle=o.get(0).style,d._profile.curPos=d._cssPos=d._proxy.cssPos(),d._cssPos_x=p.x-d._cssPos.left,d._cssPos_y=p.y-d._cssPos.top,p.restrictedLeft=p.x-(p.maxLeftOffset||0),p.restrictedRight=p.x+(p.maxRightOffset||0),p.restrictedTop=p.y-(p.maxTopOffset||0),p.restrictedBottom=p.y+(p.maxBottomOffset||0),d._proxyLeft=d._pre.left=d._cssPos.left,d._proxyTop=d._pre.top=d._cssPos.top,"move"!==p.dragType&&(d._proxy.css("zIndex",10*xui.Dom.TOP_ZINDEX),xui.setNodeData(d._proxy.get(0),"zIndexIgnore",1)))},_reset:function(){var d=this;return xui.tryF(d.$reset),d.setDropFace(),d._resetProxy(),d.$proxySize=50,d.$mousemove=d.$mouseup=d.$onselectstart=d.$ondragstart="*",d._cursor="",d._pre={},d._proxyLeft=d._proxyTop=d._cssPos_x=d._cssPos_y=0,d._stop=!1,d._onDrag&&d._onDrag.tasks&&(d._onDrag.tasks.length=0,delete d._onDrag.tasks),d._onDragover&&d._onDragover.tasks&&(d._onDragover.tasks.length=0,delete d._onDragover.tasks),d._c_droppable&&(d._c_droppable.length=0),d._c_droppable=d._c_dropactive=d._cssPos=d._box=d._dropElement=d._source=d._proxy=d._proxystyle=d._onDrag=d._onDragover=null,d._profile={$id:xui.rand(),dragType:"shape",dragCursor:"move",targetReposition:!0,dragIcon:xui.ini.img_dd,magneticDistance:0,xMagneticLines:[],yMagneticLines:[],widthIncrement:0,heightIncrement:0,dragDefer:0,horizontalOnly:!1,verticalOnly:!1,maxBottomOffset:null,maxLeftOffset:null,maxRightOffset:null,maxTopOffset:null,targetNode:null,targetCSS:null,dragKey:null,dragData:null,targetLeft:null,targetTop:null,targetWidth:null,targetHeight:null,targetOffsetParent:null,targetCallback:null,tagVar:null,shadowFrom:null,proxyNode:null,x:0,y:0,ox:0,oy:0,curPos:{},offset:{},isWorking:!1,restrictedLeft:null,restrictedRight:null,restrictedTop:null,restrictedBottom:null,dropElement:null},d.__touchingfordd=0,d},abort:function(){this._stop=!0},_end:function(){var mm2,mu2,d=this,win=window,doc=document,body=doc.body;return xui.browser.isTouch&&(mm2=xui.browser.ie&&win.PointerEvent?"onpointermove":xui.browser.ie&&win.MSPointerEvent?"onmspointermove":"ontouchmove",mu2=xui.browser.ie&&win.PointerEvent?"onpointerup":xui.browser.ie&&win.MSPointerEvent?"onmspointerup":"ontouchend"),d._proxy&&d._unpack(),"*"!=d.$onselectstart&&(body.onselectstart=d.$onselectstart),"*"!=d.$ondragstart&&(doc.ondragstart=d.$ondragstart),"*"!=d.$mousemove&&(doc.onmousemove=d.$mousemove),"*"!=d.$mouseup&&(doc.onmouseup=d.$mouseup),xui.browser.isTouch&&("*"!=d.$touchmove&&(doc[mm2]=d.$touchmove),"*"!=d.$touchend&&(doc[mu2]=d.$touchend)),d},startDrag:function(e,targetNode,profile,dragKey,dragData){var t,d=this,win=window;if(d._profile.isWorking)return!1;if(d._end()._reset(),d._profile.isWorking=!0,d.__touchingfordd="xuitouchdown"==e.type,profile=xui.isHash(profile)?profile:{},e=e||win.event,"left"!==xui.Event.getBtn(e))return!0;d._source=profile.targetNode=xui(targetNode),d._cursor=d._source.css("cursor"),(t=profile.targetNode.get(0))&&!t.id&&(t.id=xui.Dom._pickDomId(),t=null),d._defer=profile.dragDefer=xui.isNumb(profile.dragDefer)?profile.dragDefer:0,!0===profile.dragCursor&&(profile.dragCursor=d._cursor),"string"==typeof profile.dragIcon&&(profile.dragType="icon");var mm2,mu2,doc=document,body=doc.body,_pos=xui.Event.getPos(e),mm="onmousemove",mu="onmouseup";xui.browser.isTouch&&(mm2=xui.browser.ie&&win.PointerEvent?"onpointermove":xui.browser.ie&&win.MSPointerEvent?"onmspointermove":"ontouchmove",mu2=xui.browser.ie&&win.PointerEvent?"onpointerup":xui.browser.ie&&win.MSPointerEvent?"onmspointerup":"ontouchend"),profile.x=_pos.left,profile.y=_pos.top,profile.dragKey=dragKey||profile.dragKey||null,profile.dragData=dragData||profile.dragData||null;var fromN=xui.Event.getSrc(e);if(d._start=function(e){var p=d._profile;if(xui.merge(p,profile,"with"),d._source.beforeDragbegin(),d._stop)return d._end()._reset(),!1;if(xui.Event&&(t=d._source.get(0))&&(xui.Event._preDroppable=t.id,t=null),"icon"==p.dragType&&(p.targetReposition=!1),d._ini("none"==p.dragType?null:d._pack(_pos,p.targetNode)),profile.x>=d._box.width||profile.y>=d._box.height)return d._end()._reset(),!0;if(d._source.onDragbegin(),p.dragDefer<1&&(d.$mousemove=doc[mm],d.$mouseup=doc[mu],xui.browser.isTouch&&(d.$touchmove=doc[mm2],d.$touchend=doc[mu2])),xui.browser.ie&&xui.setTimeout((function(){fromN.releaseCapture&&fromN.releaseCapture()})),doc[mm]=d.$onDrag,doc[mu]=d.$onDrop,xui.browser.isTouch&&(doc[mm2]=d.$onDrag,doc[mu2]=d.$onDrop),d._source.afterDragbegin(),p.dragDefer>0&&d.$onDrag.call(d,e),xui.browser.isTouch&&d.__touchingfordd){d._c_droppable=[];var cdata=xui.$cache.droppable[p.dragKey],purge=[];xui.arr.each(cdata,(function(i){if(xui.use(i).get(0)){var hash,ni=xui.use(i),h=ni.offsetHeight(),w=ni.offsetWidth(),v=ni.css("visibility");w&&h&&"hidden"!=v&&((hash=ni.offset()).width=w,hash.height=h,hash.id=i,d._c_droppable.unshift(hash))}else purge.push(i)})),purge.length&&xui.arr.each(purge,(function(key){xui.arr.removeValue(cdata,key)}))}},xui.browser.ie&&(d.$ondragstart=doc.ondragstart,d.$onselectstart=body.onselectstart,doc.ondragstart=body.onselectstart=null,doc.selection&&doc.selection.empty))try{doc.selection.empty()}catch(e$15){}if(xui.Event.stopBubble(e),profile.targetNode.get(0)!==doc&&xui(doc).onMousedown(!0,xui.Event.getEventPara(e,_pos)),profile.dragDefer<1)return xui.tryF(d._start,[e],d),!1;d.$mouseup=doc[mu],doc[mu]=function(e){return xui.DragDrop._end()._reset(),xui.tryF(document.onmouseup,[e],null,!0)},xui.browser.isTouch&&(d.$touchend=doc[mu2],doc[mu2]=doc[mu]);var pbak={};d.$mousemove=doc[mm],doc[mm]=function(e){var p=xui.Event.getPos(e);if(p.left!==pbak.left||p.top!==pbak.top)return pbak=p,--d._defer<=0&&xui.DragDrop._start(e),!1},xui.browser.isTouch&&(d.$touchmove=doc[mm2],doc[mm2]=doc[mm])},$onDrag:function(e){var d=xui.DragDrop,p=d._profile;if(d.$SimulateMousemoveInMobileDevice)return!1;if(e=e||window.event,!p.isWorking||d._stop)return d.$onDrop(e),!0;var _pos=xui.Event.getPos(e);if(p.x=_pos.left,p.y=_pos.top,!p.isWorking)return!1;if(d._proxy?(p.verticalOnly||(d._proxyLeft=Math.floor(d._left((null!==p.maxLeftOffset&&p.x<=p.restrictedLeft?p.restrictedLeft:null!==p.maxRightOffset&&p.x>=p.restrictedRight?p.restrictedRight:p.x)-d._cssPos_x)),d._proxyLeft-d._pre.left&&(d._proxystyle.left=Math.round(parseFloat(d._proxyLeft))+"px"),d._pre.left=d._proxyLeft,p.curPos.left=d._proxyLeft+d.$proxySize),p.horizontalOnly||(d._proxyTop=Math.floor(d._top((null!==p.maxTopOffset&&p.y<=p.restrictedTop?p.restrictedTop:null!==p.maxBottomOffset&&p.y>=p.restrictedBottom?p.restrictedBottom:p.y)-d._cssPos_y)),d._proxyTop-d._pre.top&&(d._proxystyle.top=Math.round(parseFloat(d._proxyTop))+"px"),d._pre.top=d._proxyTop,p.curPos.top=d._proxyTop+d.$proxySize)):(p.curPos.left=p.x,p.curPos.top=p.y),1!=d._onDrag&&(d._onDrag?d._onDrag(e,d._source._get(0)):(d._onDrag=1,d._source.onDrag(!0,xui.Event.getEventPara(e,_pos)))),xui.browser.isTouch&&d.__touchingfordd&&d._c_droppable)for(var i=0,l=d._c_droppable.length;i<l;i++){var o=d._c_droppable[i],target=xui.use(o.id).get(0),oactive=d._c_dropactive,otarget=xui.use(oactive).get(0);if(p.x>=o.left&&p.y>=o.top&&p.x<=o.left+o.width&&p.y<=o.top+o.height){if(oactive==o.id){var first=e.changedTouches[0];d.$SimulateMousemoveInMobileDevice=1,xui.Event.simulateEvent(target,"mousemove",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),delete d.$SimulateMousemoveInMobileDevice}else xui.Event.simulateEvent(target,"mouseover",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top}),d._c_dropactive=o.id,oactive&&otarget&&xui.Event.simulateEvent(otarget,"mouseout",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top});break}if(oactive==o.id){otarget&&xui.Event.simulateEvent(otarget,"mouseout",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top}),d._c_dropactive=null;break}}return!1},$onDrop:function(e){var d=xui.DragDrop,p=d._profile,evt=xui.Event;if(e=e||window.event,d._end(),p.isWorking){d.setDropFace();var r=d._source.onDragstop(!0,evt.getEventPara(e));d._dropElement&&xui.use(d._dropElement).onDrop(!0,evt.getEventPara(e))}return d._reset(),evt.stopBubble(e),xui.tryF(document.onmouseup,[e]),!!r},setDropElement:function(id){return this._profile.dropElement=this._dropElement=id,this},getProfile:function(){var d=this,p=d._profile;return p.offset=d._proxy?{x:d._proxyLeft-p.ox+d._cssPos_x,y:d._proxyTop-p.oy+d._cssPos_y}:{x:p.x-p.ox,y:p.y-p.oy},p},setDropFace:function(target,dragIcon){var st,sl,d=this,s1='<div style="position:absolute;z-index:'+xui.Dom.TOP_ZINDEX+";font-size:0;line-height:0;border-",s2=":dashed 1px #ff6600;",region=d._Region,rh=d._rh,bg="backgroundColor";return region&&region.parent()&&region.remove(!1),d._R&&(d._R.css(bg,d._RB),delete d._R,delete d._RB),target?(region&&region.get(0)||(region=d._Region=xui.create(s1+'top:solid 2px #ff6600;left:0;top:0;width:100%;height:0;"></div>'+s1+"right"+s2+'right:0;top:0;height:100%;width:0;"></div>'+s1+"bottom"+s2+'bottom:0;left:0;width:100%;height:0;"></div>'+s1+"left"+s2+'width:0;left:0;top:0;height:100%;"></div>'),rh=d._rh=xui([region.get(1),region.get(3)])),target=xui(target),xui.browser.ie6&&rh.height("100%"),"block"==target.css("display")?(xui.setNodeData(region.get(0),"zIndexIgnore",1),target.append(region),region.top(st=target.scrollTop()).left(sl=target.scrollLeft()),region.get(2).style.top="auto",region.get(1).style.left="auto",region.get(2).style.bottom="-"+st+"px",region.get(1).style.right="-"+sl+"px",xui.browser.ie6&&!rh.get(0).offsetHeight&&rh.height(target.get(0).offsetHeight)):(d._RB=target.get(0).style[bg],d._R=target,target.css(bg,"#FA8072")),d.setDragIcon(dragIcon||"move")):d.setDragIcon("none"),d},setDragIcon:function(key){xui.resetRun("setDropFace",null);var d=this,p=d._profile,i=p.proxyNode,ic=d._Icons;return i&&"icon"==p.dragType&&i.first(4).css("object"==typeof key?key:{backgroundPosition:ic[key]||key}),d},_setProxy:function(child,pos){var t,temp,d=this,p=d._profile,dom=xui.Dom;return dom.byId(d._id)||xui("body").prepend(xui.create('<div id="'+d._id+'" style="left:0;top:0;border:0;font-size:0;line-height:0;padding:'+d.$proxySize+"px;position:absolute;background:url("+xui.ini.img_bg+') repeat;"><div style="font-size:0;line-height:0;" id="'+d._idi+'">'+(xui.browser.ie6?"&nbsp;":"")+"</div></div>")),t=xui(d._id),p.dragKey?(d.$proxySize=0,t.css("padding",0)):(pos.left-=d.$proxySize,pos.top-=d.$proxySize,p.targetOffsetParent||dom.setCover(!0,null,!1,p.dragCursor)),(temp=p.targetOffsetParent)&&xui(temp).append(t),child?(xui(d._idi).empty(!1).append(child),p.proxyNode=child):p.proxyNode=xui(d._idi),t.css({display:"",zIndex:10*dom.TOP_ZINDEX,cursor:p.dragCursor}).offset(pos,temp),xui.setNodeData(t.get(0),"zIndexIgnore",1),t},_resetProxy:function(){var d=this,p=d._profile,dom=xui.Dom,id1=d._id,id2=d._idi;if(dom.byId(id1)){var o=xui(id2),t=xui(id1);xui.browser.ie6?o.html("&nbsp;"):o.empty(),o.attr("style","font-size:0;line-height:0;"),xui("body").prepend(t.css({zIndex:0,cursor:"",display:"none",padding:Math.round(parseFloat(d.$proxySize))+"px"})),p.proxyNode=d._proxystyle=null,dom.setCover(!1)}},_pack:function(mousePos,targetNode){var target,t,pos={},size={},d=this,p=d._profile;switch(null!==p.targetLeft&&null!==p.targetTop||(t=targetNode.offset(null,p.targetOffsetParent)),pos.left=null!==p.targetLeft?p.targetLeft:t.left,pos.top=null!==p.targetTop?p.targetTop:t.top,p.dragType){case"deep_copy":case"copy":size.width=xui.isNumb(p.targetWidth)?p.targetWidth:targetNode.cssSize().width||0,size.height=xui.isNumb(p.targetHeight)?p.targetHeight:targetNode.cssSize().height||0;var n=targetNode.clone("deep_copy"==p.dragType).css({position:"relative",margin:"0",left:"0",top:"0",right:"",bottom:"",cursor:p.dragCursor,cssFloat:"none"}).cssSize(size).id("",!0).css("opacity",.8);p.targetCallback&&p.targetCallback(n),n.query("*").id("",!0),p.targetCSS&&n.css(p.targetCSS),target=d._setProxy(n,pos);break;case"shape":size.width=null!==p.targetWidth?p.targetWidth:targetNode.offsetWidth(),size.height=null!==p.targetHeight?p.targetHeight:targetNode.offsetHeight(),size.width-=2,size.height-=2,target=d._setProxy(xui.create("div").css({border:"dashed 1px",fontSize:"0",lineHeight:"0"}).cssSize(size),pos);break;case"blank":target=d._setProxy(null,pos);break;case"icon":pos.left=xui.isNumb(p.targetLeft)?p.targetLeft:mousePos.left+16,pos.top=xui.isNumb(p.targetTop)?p.targetTop:mousePos.top+16,t='<table border="0" class="xui-node xui-node-table"><tr><td valign="top"><span class="xui-node xui-node-span" style="background:url('+p.dragIcon+") no-repeat left top;width:"+(xui.isNumb(p.targetWidth)?p.targetWidth:16)+"px;height:"+(xui.isNumb(p.targetHeight)?p.targetHeight:16)+'px;" ></span></td><td id="xui:dd:shadow" '+(p.shadowFrom?'style="border:solid 1px #e5e5e5;background:#fff;font-size:12px;line-height:14px;"':"")+">"+(p.shadowFrom?xui(p.shadowFrom).clone(!0).css({left:"auto",top:"auto",position:"relative"}).outerHTML().replace(/\s*id=[^\s>]*/g,""):"")+"</td></tr></table>",target=d._setProxy(xui.create(t).css("opacity",.8),pos);break;case"move":d.$proxySize=0,"absolute"!=(target=targetNode).css("position")&&target.css("position","absolute").offset(pos),target.css("cursor",p.dragCursor)}return target},_unpack:function(){var t,d=this,p=d._profile;p.targetReposition&&"move"!=p.dragType&&(t=xui(d._source))&&(t.isEmpty()||("absolute"!=t.css("position")&&t.css("position","absolute").cssPos(t.offset(null,t.get(0).offsetParent)),xui.browser.ie&&t.cssRegion({right:"",bottom:""}),t.offset(p.curPos,p.targetOffsetParent||document.body))),"move"==p.dragType&&d._source.css("cursor",d._cursor)},_unRegister:function(node,key){var eh=this._eh;xui([node]).$removeEvent("beforeMouseover",eh).$removeEvent("beforeMouseout",eh).$removeEvent("beforeMousemove",eh);var o=xui.getNodeData(node.$xid,["_dropKeys"]),c=xui.$cache.droppable;if(o)for(var i in o)c[i]&&xui.arr.removeValue(c[i],node.$xid);xui.setNodeData(node.$xid,["_dropKeys"])},_register:function(node,key){var eh=this._eh;xui(node).beforeMouseover((function(p,e,i){var t=xui.DragDrop;(p=t._profile).dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(t.setDropElement(i),t._onDragover=null,xui.use(i).onDragenter(!0),t._dropElement&&xui.resetRun("setDropFace",t.setDropFace,0,[i],t))}),eh).beforeMouseout((function(p,e,i){var t=xui.DragDrop;(p=t._profile).dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(xui.use(i).onDragleave(!0),t._dropElement==i&&(t.setDropElement(t._onDragover=null),xui.resetRun("setDropFace",t.setDropFace,0,[null],t)))}),eh).beforeMousemove((function(a,e,i){var t=xui.DragDrop,h=t._onDragover,p=t._profile;1!=h&&t._dropElement==i&&p.dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(h?h(e,i):(t._onDragover=1,xui.use(i).onDragover(!0,xui.Event.getEventPara(e))))}),eh);var o=xui.getNodeData(node.$xid,["_dropKeys"]),c=xui.$cache.droppable;if(o)for(var i in o)c[i]&&xui.arr.removeValue(c[i],node.$xid);for(var h={},a=key.split(/[^\w-]+/),l=(i=0,a.length);i<l;i++)h[a[i]]=1,c[a[i]]=c[a[i]]||[],c[a[i]].push(node.$xid);xui.setNodeData(node.$xid,["_dropKeys"],h)}},After:function(){this._reset(),xui.each({startDrag:function(e,profile,dragKey,dragData){return xui.DragDrop.startDrag(e,this.get(0),profile,dragKey||"",dragData||null),this},draggable:function(flag,profile,dragKey,dragData,target){var dd=xui.DragDrop;return(target=target?"function"==typeof target?xui.tryF(this.getTarget,[],this):xui(target):null)&&target.get(0)||(target=this),this.removeClass("xui-ui-selectable").addClass("xui-ui-unselectable"),flag===undefined?flag=!0:"object"==typeof flag&&(profile=flag,flag=!0),flag?this.$addEvent("beforeMousedown",(function(p,e,src){if(xui.getId(xui.Event.getSrc(e))!=src)return!0;target.startDrag(e,profile,dragKey,dragData)}),dd._eh,-1):this.$removeEvent("beforeMousedown",dd._eh),this},droppable:function(flag,key){flag===undefined&&(flag=!0),key=key||"default";var d=xui.DragDrop;return this.each((function(o){flag?d._register(o,key):d._unRegister(o,key)}))}},(function(o,i){xui.Dom.plugIn(i,o)}))}}),xui.Class("xui.Cookies",null,{Static:{set:function(name,value,days,path,domain,isSecure){if(xui.isHash(name))for(var i in name)this.set(i,name[i],days,path,domain,isSecure);else"string"!=typeof value&&(value=xui.serialize(value)),document.cookie=escape(name+"")+"="+escape(value)+(days?"; expires="+new Date((new Date).getTime()+864e5*days).toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(isSecure?"; secure":"");return this},get:function(name){var i,a,s,v,ca=document.cookie.split("; "),hash={};for(i=0;i<ca.length;i++)if(s=(a=ca[i].split("="))[1]?unescape(a[1]):"",hash[a[0]]=(/^\s*\{[\s\S]*\}$/.test(v=s)||/^\s*\[[\s\S]*\]$/.test(v)?xui.unserialize(v):v)||s,name&&a[0]==escape(name))return hash[a[0]];return name?null:hash},remove:function(name){return this.set(name,"",-1).set(name,"/",-1)},clear:function(){xui.arr.each(document.cookie.split(";"),(function(o){xui.Cookies.remove(xui.str.trim(o.split("=")[0]))}))}}}),xui.Class("xui.History",null,{Static:{activate:function(){if(!this._activited)switch(this._activited=1,this._lastFI=decodeURIComponent(location.hash),this._type){case"event":xui.Event._addEventListener(window,"hashchange",this._checker);break;case"iframe":document.body.appendChild(document.createElement('<iframe id="'+this._fid+'" src="about:blank" style="display: none;"></iframe>'));var doc=document.getElementById(this._fid).contentWindow.document;doc.open("javascript:'<html></html>'"),doc.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+location.hash+"');<\/script></head><body></body></html>"),doc.close();case"timer":this._itimer&&clearInterval(this._itimer),this._itimer=setInterval(this._checker,200)}},_fid:"xui:history",_type:xui.browser.ie&&xui.browser.ver<8?"iframe":"onhashchange"in window?"event":"timer",_callbackTag:null,_callbackArr:null,_inner_callback:null,_callback:function(fragment,init,newAdd){var arr,f,ns=this;if(xui.arr.each(xui.Module._cache,(function(m){m._evsClsBuildIn&&"onFragmentChanged"in m._evsClsBuildIn?(xui.isFun(f=m._evsClsBuildIn.onFragmentChanged)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onFragmentChanged",[m,fragment,init,newAdd]):m._evsPClsBuildIn&&"onFragmentChanged"in m._evsPClsBuildIn&&(xui.isFun(f=m._evsPClsBuildIn.onFragmentChanged)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onFragmentChanged",[m,fragment,init,newAdd])})),!xui.isFun(ns._callbackTag)||!1!==ns._callbackTag(fragment,init,newAdd)){if((arr=ns._callbackArr)&&xui.isArr(arr))for(var i=0,l=arr.length;i<l;i++)if(xui.isFun(arr[i])&&!1===arr[i](fragment,init,newAdd))return;xui.isFun(ns._inner_callback)&&ns._inner_callback(fragment,init,newAdd)}},setCallback:function(callback){var hash=location.hash;return hash=hash?"#"+encodeURIComponent((""+decodeURIComponent(hash)).replace(/^#!?/,"")):"#",this._inner_callback=callback,this._lastFI=decodeURIComponent(hash),this._callback(decodeURIComponent(this._lastFI.replace(/^#!?/,"")),!0,callback),this},_checker:function(hash){var self=xui.History;switch(self._type){case"iframe":xui.isSet(hash)&&(location.hash=hash);case"event":case"timer":decodeURIComponent(location.hash)!=decodeURIComponent(self._lastFI)&&(self._lastFI=decodeURIComponent(location.hash),self._callback(decodeURIComponent(location.hash.replace(/^#(!)?/,""))))}},getFI:function(){return this._lastFI},setFI:function(fi,triggerCallback,mergeParams,replace){var params,path=xui.getUrlPath(this.getFI());if(this.activate(),fi?(xui.isHash(fi)?params=fi:(path=xui.getUrlPath(fi+""),params=xui.getUrlParams(fi+"")),mergeParams&&(params=xui.merge(params||{},xui.getUrlParams(),"without")),fi="#"+path+(xui.isEmpty(params)?"":"?"+xui.urlEncode(params))):fi="#",this._lastFI==decodeURIComponent(fi))return!1;switch(this._type){case"iframe":var doc=document.getElementById(this._fid).contentWindow.document;doc.open("javascript:'<html></html>'"),doc.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+fi+"');<\/script></head><body></body></html>"),doc.close();break;case"event":case"timer":replace?location.replace(location.href.split("#")[0]+(this._lastFI=decodeURIComponent(fi))):location.hash=this._lastFI=decodeURIComponent(fi),!1!==triggerCallback&&this._callback(decodeURIComponent(fi.replace(/^#!?/,"")))}},getParams:function(key){var hash=xui.getUrlParams(this.getFI());return key?hash[key]:hash},setParams:function(key,value,triggerCallback,mergeParams){var params;xui.isHash(key)?params=key:(params={})[key]=xui.isHash(value)||xui.isArr(value)?xui.stringify(value):value,this.setFI(params,triggerCallback,!1!==mergeParams)},getRouter:function(returnArr){var path=xui.getUrlPath(this.getFI());return returnArr?path.replace(/^\//,"").split("/"):path},getRouterArray:function(){return this.getRouter(!0)},setRouter:function(path,force,replace,triggerCallback,mergeParams){path=xui.isArr(path)?path.join("/"):path.replace(/^\//,"").replace(/\/$/,"");var arr=this.getRouterArray();!force&&xui.str.startWith(arr.join("/")+"/",path+"/")||this.setFI("#/"+path,triggerCallback,mergeParams,!!replace)}}}),xui.Class("xui.Tips",null,{Constructor:function(){return null},Initialize:function(){if(!xui.ini.disableTips){var dd=xui.DragDrop,tips=this;dd&&(dd.$reset=function(){tips._pos={left:dd._profile.x,top:dd._profile.y}}),xui.browser.fakeTouch&&(tips.HTMLTips=!1),tips.HTMLTips?xui.CSS.addStyleSheet(".xui-tips{position:absolute;overflow:visible;visibility:hidden;left:-10000px;border-radius:1px;} .xui-tips-i{overflow:hidden;position:relative;}.xui-tips-i span{display:inline;}.xui-tips-c{padding:.125em .25em .25em .25em;}.xui-tips-c *{line-height:1.22em;}.xui-tips .xui-tips-c{border-radius:1px;}",this.KEY):tips.MOVABLE=!1,xui.doc.afterMousedown((function(){tips._cancel()}),"$Tips",-1).afterMousemove((function(obj,e){if(!dd.isWorking){var p,n,event=xui.Event;(p=xui.resetRun.$cache)&&p.$Tips&&(tips._pos=event.getPos(e)),tips._from?(tips._pos=event.getPos(e),tips._showF(),xui.resetRun("$Tips3")):tips.MOVABLE&&tips._showed&&tips._Node&&(p=event.getPos(e),(n=tips._Node.style).left=Math.min(tips._tpl._ww-tips._tpl._w,Math.max(0,Math.round((parseFloat(n.left)||0)+(p.left-tips._pos.left),10)))+"px",n.top=Math.min(tips._tpl._hh-tips._tpl._h,Math.max(0,Math.round((parseFloat(n.top)||0)+(p.top-tips._pos.top),10)))+"px",tips._pos=p)}}),"$Tips",-1).afterMouseover((function(obj,e){var id,_from,tempid,event=xui.Event,rt=event.$FALSE,node=event.getSrc(e),index=0,rtn=function(rt){return tips._markId&&tips._cancel(),rt};if(!node)return rtn(rt);try{for(;(!node.id||node.id==xui.$localeDomId)&&node.parentNode!==document&&index++<10;)node=node.parentNode;if(!(id="string"==typeof node.id?node.id:null))return node=null,rtn(rt)}catch(e$16){}if((_from=event._getProfile(id))&&_from.box&&"xui.UIProfile"==_from.KEY){if(_from.properties.disableTips||_from.behavior.disableTips)return node=null,rtn(!1);var nt=_from.behavior.NoTips;if(nt)for(var i=0,l=nt.length;i<l;i++)if(0===id.indexOf(_from.keys[nt[i]]))return rtn(!1);if(nt=_from.behavior.PanelKeys)for(i=0,l=nt.length;i<l;i++)if(0===id.indexOf(_from.keys[nt[i]]))return rtn(!1);if(nt=_from.behavior.HoverEffected,tempid=_from.onShowTips?id:id.replace(tips._reg,(function(a,b){return nt&&b in nt?a:":"})),tips._markId&&tempid==tips._markId)return rt;tips._markId=tempid,tips._pos=event.getPos(e),tips._activeNode=xui(node),tips._activePrf=_from,tips._showed?(tips._from=_from,tips._enode=id,tips._showF()):tips.HTMLTips?xui.resetRun("$Tips",(function(){tips._from=_from,tips._enode=id,xui.resetRun("$Tips3",(function(){tips._from&&tips._showF()}))}),tips.DELAYTIME):(tips._from=_from,tips._enode=id,tips._from&&tips._showF())}else tips._cancel();return node=null,rt}),"$Tips",-1).afterMouseout((function(obj,e){if(tips._markId){var clear,event=xui.Event,index=0,node=e.toElement||e.relatedTarget;if(node)try{for(;(!node.id||node.id==xui.$localeDomId)&&node.parentNode!==document&&index++<10;)node=node.parentNode;"string"==typeof node.id&&node.id||(node=null,clear=1)}catch(e$17){clear=1}else clear=1;return clear&&tips._cancel(),event.$FALSE}}),"$Tips",-1).afterMouseup((function(obj,e){tips._cancel()}),"$Tips",-1),this._Types={default:new function(){this.show=function(item,pos,key){if(pos){var t,node,_ruler,w,h,s="object"==typeof item?item[key||xui.Tips.TIPSKEY]:item;if("function"==typeof s&&(s=s()),xui.Tips.HTMLTips)if((node=this.node)&&node.get(0)||(node=this.node=xui.create('<div class="xui-node xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-wrapper xui-node-div xui-tips-i xui-custom"></div></div>'),_ruler=this._ruler=xui.create('<div class="xui-node xui-wrapper xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-node-div xui-tips-i xui-custom"></div></div>'),this.n=node.first(),this._n=_ruler.first(),xui("body").append(_ruler)),_ruler=this._ruler,document.body.lastChild!=node.get(0)&&xui("body").append(node,!1,!0),s+=""){var html=/^\s*</.test(s);s=xui.adjustRes(s),xui.Tips._curTips=s,item.transTips&&html||(s='<div class="xui-ui-ctrl xui-node xui-node-div  xui-uiborder-flat xui-uicell-alt xui-node-tips xui-tips-c /*xui-cls-wordwrap */xui-custom">'+s+"</div>"),this._n.get(0).innerHTML=s,this._ww=xui.frame.width(),this._hh=xui.frame.height(),w=Math.min(html?this._ww:tips.MAXWIDTH,_ruler.get(0).offsetWidth+2);var style=node.get(0).style,t1=this.n.get(0),styleI=t1.style;style.visibility="hidden",t1.innerHTML=s,xui.browser.ie?(style.width=styleI.width=(this._w=Math.round(w+w%2))+"px",h=t1.offsetHeight,style.height=(this._h=Math.round(h-h%2))+"px"):(styleI.width=(this._w=Math.round(w))+"px",this._h=this.n.height()),node.removeClass("xui-ui-hidden"),!0===pos?style.visibility="visible":node.popToTop(pos instanceof window.Event||pos["xui.UI"]||pos["xui.UIProfile"]||pos["xui.Dom"]||1==pos.nodeType||"string"==typeof pos?pos:{left:pos.left,top:pos.top,region:{left:pos.left,top:pos.top-12,width:24,height:32}},1),style=styleI=t1=null}else node.css("zIndex",0).hide();else s+="",xui.Tips._curTips=xui.adjustRes(s),s=s.replace(/<[^>]*>/g,""),(t=xui.Tips._activePrf)&&(t.box["xui.svg"]?t.boxing().setAttr("KEY",{title:s},!1):xui.Tips._activeNode.attr("title",s))}},this.hide=function(){if(xui.Tips.HTMLTips)this.node.css("zIndex",0).hide();else{var t=xui.Tips._activePrf;t&&(t.box["xui.svg"]?t.boxing().setAttr("KEY",{title:null},!1):xui.Tips._activeNode.attr("title",null))}}}}}},Static:{_reg:/-([\w]+):/,TIPSKEY:"tips",MAXWIDTH:600,HTMLTips:!0,MOVABLE:!0,DELAYTIME:400,AUTOHIDETIME:5e3,_showF:function(){if(!xui.ini.disableTips){var o,t,_from=this._from,node=xui.Dom.byId(this._enode),pos=this._pos,b=!0;this._from=this._enode=null,node&&_from&&pos&&(o=_from.box)&&(0!=(b=!1!==((t=_from.CF)&&(t=t.showTips)&&t(_from,node,pos)))&&(b=!1!==(_from._showTips&&_from._showTips(_from,node,pos))),!1!==b&&(b=!1!==(o._showTips&&o._showTips(_from,node,pos))),!1!==b&&((t=_from)&&t.tips||t&&(t=t.properties)&&t.tips?(this.show(pos,t),b=!1):(t=_from)&&(t=t.properties)&&t.autoTips&&"caption"in t&&""===t.tips&&(t.caption||t.labelCaption)&&(this.show(pos,{tips:t.caption||t.labelCaption}),b=!1)),!1!==b?this.hide():this.HTMLTips&&!this.MOVABLE&&xui.resetRun("$Tips2",this.hide,this.AUTOHIDETIME,null,this),node=pos=_from=null)}},getTips:function(){return this._curTips},setTips:function(s){this._curTips&&this._tpl&&this._tpl.show(s,!0)},setPos:function(left,top){var n=this;n.HTMLTips&&(n=n._Node)&&(n=n.style)&&((left||0===left)&&(n.left=Math.round(parseFloat(left))+"px"),(top||0===top)&&(n.top=Math.round(parseFloat(top))+"px"))},show:function(pos,item,key){var t;this._pos=pos,this._item!==item&&("string"==typeof item||item&&item[key||xui.Tips.TIPSKEY]?((t=this._tpl=this._Types[item.tipsTemplate]||this._Types.default).show(item,pos,key),this._Node=t.node&&t.node.get(0),this._item=item,this._showed=!0):this._cancel())},hide:function(){this._showed&&(this._tpl&&this._tpl.hide(),this._clear())},_cancel:function(){this._markId&&(this._showed?this.hide():(xui.resetRun("$Tips"),xui.resetRun("$Tips3"),this._clear()))},_clear:function(){this._Node=this._curTips=this._markId=this._activeNode=this._activePrf=this._from=this._tpl=this._item=this._showed=null}}}),"Class"in window||(window.Class=function(){return xui.Class.apply(xui.Class,arguments)}),xui},"function"==typeof define&&define.amd?define((function(){return factory.call(root)})):"object"==typeof module&&module.exports?module.exports=factory.call(root):root.xui=factory.call(root);